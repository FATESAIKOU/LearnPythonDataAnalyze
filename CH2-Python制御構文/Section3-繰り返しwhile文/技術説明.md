# Section3: 繰り返し（while文）

## 🎯 このセクションの目標

**条件が満たされる間、処理を繰り返せるようになる！**

for 文とは異なり、繰り返し回数が事前にわからない場合に便利な while 文を学びます。

---

## 🔄 while 文とは？

while 文は「条件が True の間」繰り返します。

### for 文との違い

| for 文 | while 文 |
|--------|----------|
| 繰り返し回数が決まっている | 条件が満たされるまで繰り返す |
| リストや範囲を順に処理 | 条件で制御 |
| 例：5回繰り返す | 例：正しい入力があるまで繰り返す |

---

## 📝 while 文の基本

### 構文

```python
while 条件:
    条件が True の間、繰り返す処理
```

### 例：1から5まで表示

```python
count = 1

while count <= 5:
    print(count)
    count = count + 1
```

**実行結果：**
```
1
2
3
4
5
```

### 処理の流れ

1. `count = 1` で変数を初期化
2. `count <= 5` が True（1 <= 5）なので処理を実行
3. `print(count)` で 1 を表示
4. `count = count + 1` で count を 2 に更新
5. 再び条件をチェック... を繰り返す
6. `count = 6` になると `6 <= 5` は False なのでループ終了

---

## 📊 フローチャート

### while 文のフローチャート

```
    ┌─────────────┐
    │   開始      │
    └──────┬──────┘
           ↓
    ┌──────────────┐
    │ 変数を初期化  │
    └──────┬───────┘
           ↓
    ┌──────┴──────┐
    │  条件をチェック│
    └──────┬──────┘
      True↓    ↓False
    ┌─────────┐  │
    │ 処理実行 │  │
    └────┬────┘  │
         ↓       │
    ┌─────────┐  │
    │変数を更新│  │
    └────┬────┘  │
         └───────┘
              ↓
    ┌─────────────┐
    │    終了     │
    └─────────────┘
```

---

## ⚠️ 無限ループに注意！

条件が永遠に True のままだと、プログラムが終わりません。

### ❌ 無限ループの例

```python
count = 1

while count <= 5:
    print(count)
    # count を更新し忘れている！
```

このコードは永遠に `1` を表示し続けます。

### ✅ 正しい例

```python
count = 1

while count <= 5:
    print(count)
    count = count + 1  # 必ず更新する！
```

**無限ループを止めるには**: Jupyter Notebook の「■」停止ボタンを押す

---

## 🛑 break 文

ループを途中で抜けたいときは `break` を使います。

```python
count = 1

while True:  # 無限ループ
    print(count)
    if count >= 5:
        break  # ループを抜ける
    count = count + 1

print("ループ終了")
```

**実行結果：**
```
1
2
3
4
5
ループ終了
```

---

## ⏭️ continue 文

現在の反復をスキップして次の反復に進むには `continue` を使います。

```python
count = 0

while count < 10:
    count = count + 1
    if count % 2 == 0:  # 偶数ならスキップ
        continue
    print(count)

print("ループ終了")
```

**実行結果：**
```
1
3
5
7
9
ループ終了
```

偶数（2, 4, 6, 8, 10）はスキップされ、奇数だけが表示されます。

---

## 📊 break と continue の違い

| 文 | 動作 |
|----|------|
| `break` | ループを完全に終了 |
| `continue` | 今の反復をスキップして次へ |

### break の図

```
while 条件:
    処理A
    if 条件2:
        break  ──────→ ループ外へ
    処理B
次の処理  ←────────────┘
```

### continue の図

```
while 条件:
    処理A
    if 条件2:
        continue  ──→ ループの先頭へ
    処理B      ↑
               └────┘
```

---

## 🔄 while-else 構文

while 文にも else が使えます。ループが正常に終了したとき（break しなかったとき）に実行されます。

```python
count = 1

while count <= 5:
    print(count)
    count = count + 1
else:
    print("正常終了しました")
```

**実行結果：**
```
1
2
3
4
5
正常終了しました
```

### break した場合

```python
count = 1

while count <= 5:
    print(count)
    if count == 3:
        break
    count = count + 1
else:
    print("正常終了しました")  # 実行されない

print("プログラム終了")
```

**実行結果：**
```
1
2
3
プログラム終了
```

break でループを抜けたので、else は実行されません。

---

## 🎮 実践例：ユーザー入力の検証

while 文は、正しい入力があるまで繰り返す処理に最適です。

### パスワード入力

```python
password = ""

while password != "secret":
    password = input("パスワードを入力: ")
    if password != "secret":
        print("パスワードが違います。もう一度入力してください。")

print("ログイン成功！")
```

### 数値の範囲チェック

```python
while True:
    age = input("年齢を入力（1〜120）: ")
    age = int(age)
    
    if 1 <= age <= 120:
        break
    else:
        print("1〜120の範囲で入力してください")

print("あなたの年齢は " + str(age) + " 歳です")
```

---

## 🎲 実践例：数当てゲーム

```python
import random

answer = random.randint(1, 100)
attempts = 0

print("1〜100の数字を当ててください！")

while True:
    guess = int(input("予想: "))
    attempts = attempts + 1
    
    if guess == answer:
        print("正解！ " + str(attempts) + "回で当たりました！")
        break
    elif guess < answer:
        print("もっと大きい数です")
    else:
        print("もっと小さい数です")
```

---

## 🔢 実践例：合計が100を超えるまで

```python
total = 0
count = 0

while total <= 100:
    num = int(input("数字を入力: "))
    total = total + num
    count = count + 1
    print("現在の合計: " + str(total))

print("---")
print(str(count) + "個の数字で合計が100を超えました")
print("最終合計: " + str(total))
```

---

## 🔄 for と while の使い分け

| シチュエーション | 推奨 |
|------------------|------|
| リストの全要素を処理 | for |
| 決まった回数繰り返す | for + range() |
| 条件が満たされるまで繰り返す | while |
| 正しい入力があるまで繰り返す | while |
| 回数が事前にわからない | while |

### for で書ける例は for で書く

```python
# ✅ for が適切
for i in range(5):
    print(i)

# ❌ while で書くと冗長
i = 0
while i < 5:
    print(i)
    i = i + 1
```

### while が適切な例

```python
# ユーザーが "quit" と入力するまで繰り返す
while True:
    command = input("コマンドを入力 (quit で終了): ")
    if command == "quit":
        break
    print("実行: " + command)
```

---

## ⚠️ よくあるエラー

### エラー例 1: 変数の更新忘れ

```python
# ❌ 無限ループ
x = 0
while x < 5:
    print(x)
    # x を更新し忘れ

# ✅ 正しい
x = 0
while x < 5:
    print(x)
    x = x + 1
```

### エラー例 2: 条件の間違い

```python
# ❌ 一度も実行されない
x = 10
while x < 5:  # 最初から False
    print(x)
    x = x + 1

# ✅ 条件を確認
x = 0
while x < 5:
    print(x)
    x = x + 1
```

### エラー例 3: break の位置

```python
# ❌ 条件チェック前に break
while True:
    break  # すぐに抜けてしまう
    x = input("入力: ")

# ✅ 適切な位置で break
while True:
    x = input("入力 (quit で終了): ")
    if x == "quit":
        break
```

---

## 🎯 このセクションのまとめ

| 学んだこと | 内容 |
|------------|------|
| while 文 | 条件が True の間繰り返す |
| break | ループを途中で抜ける |
| continue | 今の反復をスキップ |
| while-else | 正常終了時に else を実行 |
| 無限ループ | while True + break パターン |

---

## ➡️ 次のステップ

「演習.md」で while 文を実践しましょう！
