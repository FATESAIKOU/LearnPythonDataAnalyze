# Section2: DataFrame（2次元データ）

## 🎯 このセクションの目標

Pandas の2次元データ構造「DataFrame」を理解し、作成・確認ができるようになる。

---

## DataFrame とは

DataFrame は「行と列を持つ表形式のデータ構造」です。
Excel のスプレッドシートのようなものと考えてください。

```
┌─────────────────────────────────────────────────────────────┐
│                DataFrame の全体像                           │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│        index    columns（列名）                             │
│          ↓     ↓     ↓     ↓                            │
│       ┌──────┬──────┬──────┬────────┐                       │
│       │      │ 名前 │ 年齢 │ 都市   │                       │
│       ├──────┼──────┼──────┼────────┤                       │
│       │  0   │ 田中 │  25  │ 東京   │ ← 1行目              │
│       │  1   │ 鈴木 │  30  │ 大阪   │ ← 2行目              │
│       │  2   │ 佐藤 │  28  │ 名古屋 │ ← 3行目              │
│       └──────┴──────┴──────┴────────┘                       │
│                  │      │      │                            │
│                  ↓     ↓     ↓                           │
│              Series  Series  Series                         │
│              (名前)  (年齢)  (都市)                         │
│                                                             │
│   【ポイント】                                              │
│   ・各列は Series                                           │
│   ・行には index（行ラベル）がある                          │
│   ・列には columns（列名）がある                            │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### Series と DataFrame の関係

```
┌─────────────────────────────────────────────────────────────┐
│              Series と DataFrame の関係                     │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   Series（1次元）           DataFrame（2次元）              │
│   ┌────────┬───────┐       ┌──────┬──────┬──────┐           │
│   │ index  │ value │       │ col1 │ col2 │ col3 │           │
│   ├────────┼───────┤       ├──────┼──────┼──────┤           │
│   │   0    │  100  │       │ 100  │  A   │ True │           │
│   │   1    │  200  │  ──► │ 200  │  B   │ False│           │
│   │   2    │  300  │       │ 300  │  C   │ True │           │
│   └────────┴───────┘       └──────┴──────┴──────┘           │
│        1列                     複数列                       │
│                                                             │
│   DataFrame = 複数の Series を横に並べたもの                │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## DataFrame の作成

### 辞書から作成

最もよく使う方法です。キーが列名、値がデータになります。

```
┌─────────────────────────────────────────────────────────────┐
│                辞書から DataFrame を作成                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│    Python 辞書                                              │
│    ┌────────────────────────────────────┐                   │
│    │  "名前": ["田中", "鈴木", "佐藤"]  │                   │
│    │  "年齢": [25, 30, 28]              │                   │
│    │  "都市": ["東京", "大阪", "名古屋"]│                   │
│    └────────────────────────────────────┘                   │
│              │                                              │
│              ▼  pd.DataFrame()                             │
│                                                             │
│    ┌──────┬──────┬──────┬────────┐                          │
│    │      │ 名前 │ 年齢 │ 都市   │ ◄── キーが列名に        │
│    ├──────┼──────┼──────┼────────┤                          │
│    │  0   │ 田中 │  25  │ 東京   │                          │
│    │  1   │ 鈴木 │  30  │ 大阪   │ ◄── 値がデータに        │
│    │  2   │ 佐藤 │  28  │ 名古屋 │                          │
│    └──────┴──────┴──────┴────────┘                          │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

```python
import pandas as pd

# 辞書から DataFrame を作成
data = {
    "名前": ["田中", "鈴木", "佐藤"],
    "年齢": [25, 30, 28],
    "都市": ["東京", "大阪", "名古屋"]
}
df = pd.DataFrame(data)
print(df)
```

出力:
```
   名前  年齢   都市
0  田中   25   東京
1  鈴木   30   大阪
2  佐藤   28  名古屋
```

### リストのリストから作成

行単位でデータを作成する場合に使います。

```
┌──────────────────────────────────────────────────────────────┐
│            リストのリストから DataFrame を作成               │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│    リストのリスト（行単位のデータ）                          │
│    ┌───────────────────────────────────┐                     │
│    │  ["田中", 25, "東京"]  ◄── 1行目 │                     │
│    │  ["鈴木", 30, "大阪"]  ◄── 2行目 │                     │
│    │  ["佐藤", 28, "名古屋"] ◄── 3行目│                     │
│    └───────────────────────────────────┘                     │
│              │                                               │
│              ▼  pd.DataFrame(columns=["名前","年齢","都市"])│
│                                                              │
│    ┌──────┬──────┬──────┬────────┐                           │
│    │      │ 名前 │ 年齢 │ 都市   │ ◄── columns で列名指定   │
│    ├──────┼──────┼──────┼────────┤                           │
│    │  0   │ 田中 │  25  │ 東京   │                           │
│    │  1   │ 鈴木 │  30  │ 大阪   │                           │
│    │  2   │ 佐藤 │  28  │ 名古屋 │                           │
│    └──────┴──────┴──────┴────────┘                           │
│                                                              │
└──────────────────────────────────────────────────────────────┘
```

```python
import pandas as pd

# リストのリストから作成（列名を指定）
data = [
    ["田中", 25, "東京"],
    ["鈴木", 30, "大阪"],
    ["佐藤", 28, "名古屋"]
]
df = pd.DataFrame(data, columns=["名前", "年齢", "都市"])
print(df)
```

### NumPy 配列から作成

```
┌─────────────────────────────────────────────────────────────┐
│              NumPy 配列から DataFrame を作成                │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│    NumPy 配列                                               │
│    ┌─────────────────┐                                      │
│    │  [[1, 2, 3],    │                                      │
│    │   [4, 5, 6],    │                                      │
│    │   [7, 8, 9]]    │                                      │
│    └─────────────────┘                                      │
│              │                                              │
│              ▼  pd.DataFrame(columns=["A","B","C"])        │
│                                                             │
│    ┌──────┬─────┬─────┬─────┐                               │
│    │      │  A  │  B  │  C  │                               │
│    ├──────┼─────┼─────┼─────┤                               │
│    │  0   │  1  │  2  │  3  │                               │
│    │  1   │  4  │  5  │  6  │                               │
│    │  2   │  7  │  8  │  9  │                               │
│    └──────┴─────┴─────┴─────┘                               │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

```python
import pandas as pd
import numpy as np

# NumPy 配列から作成
arr = np.array([[1, 2, 3],
                [4, 5, 6],
                [7, 8, 9]])
df = pd.DataFrame(arr, columns=["A", "B", "C"])
print(df)
```

---

## 行インデックスの指定

デフォルトでは 0, 1, 2... となりますが、カスタムインデックスも設定できます。

```
┌─────────────────────────────────────────────────────────────┐
│                カスタムインデックスの設定                   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│    デフォルト index           カスタム index                │
│    ┌──────┬──────┬──────┐   ┌──────┬──────┬──────┐          │
│    │      │ 名前 │ 年齢 │   │      │ 名前 │ 年齢 │          │
│    ├──────┼──────┼──────┤   ├──────┼──────┼──────┤          │
│    │  0   │ 田中 │  25  │   │ ID1  │ 田中 │  25  │          │
│    │  1   │ 鈴木 │  30  │   │ ID2  │ 鈴木 │  30  │          │
│    │  2   │ 佐藤 │  28  │   │ ID3  │ 佐藤 │  28  │          │
│    └──────┴──────┴──────┘   └──────┴──────┴──────┘          │
│        ↑                         ↑                        │
│    自動生成                   index=["ID1","ID2","ID3"]     │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

```python
import pandas as pd

data = {
    "名前": ["田中", "鈴木", "佐藤"],
    "年齢": [25, 30, 28]
}

# カスタムインデックスを指定
df = pd.DataFrame(data, index=["ID1", "ID2", "ID3"])
print(df)
```

出力:
```
     名前  年齢
ID1  田中   25
ID2  鈴木   30
ID3  佐藤   28
```

---

## DataFrame の基本属性

DataFrame には様々な情報を取得する属性があります。

```
┌─────────────────────────────────────────────────────────────┐
│                DataFrame の主要な属性                       │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│       df = pd.DataFrame(...)                                │
│       ┌──────┬──────┬──────┬────────┐                       │
│       │      │ 名前 │ 年齢 │ 都市   │                       │
│       ├──────┼──────┼──────┼────────┤                       │
│       │  0   │ 田中 │  25  │ 東京   │                       │
│       │  1   │ 鈴木 │  30  │ 大阪   │                       │
│       │  2   │ 佐藤 │  28  │ 名古屋 │                       │
│       └──────┴──────┴──────┴────────┘                       │
│                                                             │
│   ┌──────────────────────────────────────────────────┐      │
│   │                                                  │      │
│   │  df.shape   = (3, 3)      ← (行数, 列数)        │      │
│   │              ↑                                  │      │
│   │         3行 × 3列                                │      │
│   │                                                  │      │
│   │  df.columns = ["名前", "年齢", "都市"]  ← 列名  │      │
│   │                                                  │      │
│   │  df.index   = [0, 1, 2]    ← 行インデックス     │      │
│   │                                                  │      │
│   │  df.dtypes  = 名前    object   ← 各列のデータ型 │      │
│   │              年齢    int64                       │      │
│   │              都市    object                      │      │
│   │                                                  │      │
│   └──────────────────────────────────────────────────┘      │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

```python
import pandas as pd

data = {
    "名前": ["田中", "鈴木", "佐藤"],
    "年齢": [25, 30, 28],
    "都市": ["東京", "大阪", "名古屋"]
}
df = pd.DataFrame(data)

print("shape:", df.shape)      # (行数, 列数)
print("columns:", df.columns)  # 列名
print("index:", df.index)      # 行インデックス
print("\ndtypes:")
print(df.dtypes)               # 各列のデータ型
```

出力:
```
shape: (3, 3)
columns: Index(['名前', '年齢', '都市'], dtype='object')
index: RangeIndex(start=0, stop=3, step=1)

dtypes:
名前    object
年齢     int64
都市    object
dtype: object
```

---

## head() と tail()

大きなデータの先頭・末尾だけを確認する便利なメソッドです。

```
┌─────────────────────────────────────────────────────────────┐
│                head() と tail() の動作                      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│    大きな DataFrame（例: 1000行）                           │
│    ┌──────┬──────┬──────┐                                   │
│    │  0   │ ...  │ ...  │ ─┐                                │
│    │  1   │ ...  │ ...  │  │                                │
│    │  2   │ ...  │ ...  │  ├── df.head(3) で取得            │
│    ├──────┼──────┼──────┤ ─┘                                │
│    │  3   │ ...  │ ...  │                                   │
│    │  :   │  :   │  :   │    ← 途中省略                    │
│    │  :   │  :   │  :   │                                   │
│    ├──────┼──────┼──────┤ ─┐                                │
│    │ 997  │ ...  │ ...  │  │                                │
│    │ 998  │ ...  │ ...  │  ├── df.tail(3) で取得            │
│    │ 999  │ ...  │ ...  │  │                                │
│    └──────┴──────┴──────┘ ─┘                                │
│                                                             │
│    head(n): 先頭 n 行を表示（デフォルト n=5）               │
│    tail(n): 末尾 n 行を表示（デフォルト n=5）               │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

```python
import pandas as pd

# 10行のデータを作成
data = {
    "ID": list(range(1, 11)),
    "値": [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000]
}
df = pd.DataFrame(data)

print("先頭3行:")
print(df.head(3))

print("\n末尾3行:")
print(df.tail(3))
```

出力:
```
先頭3行:
   ID   値
0   1  100
1   2  200
2   3  300

末尾3行:
   ID    値
7   8   800
8   9   900
9  10  1000
```

---

## info() でデータ構造を確認

データ型、欠損値の有無、メモリ使用量を一度に確認できます。

```
┌─────────────────────────────────────────────────────────────┐
│                info() の出力内容                            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│    df.info() の出力:                                        │
│    ┌──────────────────────────────────────────────────┐     │
│    │  <class 'pandas.core.frame.DataFrame'>           │     │
│    │  RangeIndex: 3 entries, 0 to 2   ← 行数と範囲   │     │
│    │  Data columns (total 3 columns): ← 列数         │     │
│    │   #   Column  Non-Null Count  Dtype              │     │
│    │  ---  ------  --------------  -----              │     │
│    │   0   名前    3 non-null      object  ← 欠損なし│     │
│    │   1   年齢    3 non-null      int64              │     │
│    │   2   都市    3 non-null      object             │     │
│    │  dtypes: int64(1), object(2)                     │     │
│    │  memory usage: XXX bytes      ← メモリ使用量    │     │
│    └──────────────────────────────────────────────────┘     │
│                                                             │
│    【読み方】                                               │
│    ・Non-Null Count: 欠損していない値の数                   │
│    ・3 non-null なら欠損値なし                              │
│    ・2 non-null なら1つ欠損あり                             │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

```python
import pandas as pd

data = {
    "名前": ["田中", "鈴木", "佐藤"],
    "年齢": [25, 30, 28],
    "都市": ["東京", "大阪", "名古屋"]
}
df = pd.DataFrame(data)

df.info()
```

---

## describe() で統計情報を確認

数値列の統計情報を自動的に計算してくれます。

```
┌─────────────────────────────────────────────────────────────┐
│                describe() の出力内容                        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│    df.describe() の出力（数値列のみ対象）:                  │
│    ┌───────────┬──────────┬──────────┐                      │
│    │           │   年齢   │   給料   │                      │
│    ├───────────┼──────────┼──────────┤                      │
│    │  count    │   3.0    │   3.0    │ ← データ数          │
│    │  mean     │  27.67   │ 333.33   │ ← 平均              │
│    │  std      │   2.52   │  57.74   │ ← 標準偏差          │
│    │  min      │  25.0    │ 280.0    │ ← 最小値            │
│    │  25%      │  26.5    │ 305.0    │ ← 第1四分位数       │
│    │  50%      │  28.0    │ 330.0    │ ← 中央値            │
│    │  75%      │  29.0    │ 360.0    │ ← 第3四分位数       │
│    │  max      │  30.0    │ 390.0    │ ← 最大値            │
│    └───────────┴──────────┴──────────┘                      │
│                                                             │
│    【ポイント】                                             │
│    ・文字列列は含まれない（数値列のみ）                     │
│    ・パーセンタイル（25%, 50%, 75%）も表示される            │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

```python
import pandas as pd

data = {
    "名前": ["田中", "鈴木", "佐藤"],
    "年齢": [25, 30, 28],
    "給料": [280, 330, 390]
}
df = pd.DataFrame(data)

print(df.describe())
```

出力:
```
             年齢         給料
count   3.000000    3.000000
mean   27.666667  333.333333
std     2.516611   55.075705
min    25.000000  280.000000
25%    26.500000  305.000000
50%    28.000000  330.000000
75%    29.000000  360.000000
max    30.000000  390.000000
```

---

## まとめ

```
┌─────────────────────────────────────────────────────────────┐
│                  DataFrame まとめ                           │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  【DataFrame の特徴】                                       │
│    ・行と列を持つ表形式データ（Excel シートのようなもの）   │
│    ・各列は Series                                          │
│    ・行には index、列には columns がある                    │
│                                                             │
│  【作成方法】                                               │
│    ┌──────────────────────┬─────────────────────────┐       │
│    │  辞書から            │  pd.DataFrame(dict)     │       │
│    │  リストのリストから  │  pd.DataFrame(list,     │       │
│    │                      │    columns=[...])       │       │
│    │  NumPy配列から       │  pd.DataFrame(array)    │       │
│    └──────────────────────┴─────────────────────────┘       │
│                                                             │
│  【主な属性・メソッド】                                     │
│    ┌───────────────┬──────────────────────────┐             │
│    │  df.shape     │  (行数, 列数)            │             │
│    │  df.columns   │  列名の取得              │             │
│    │  df.index     │  行インデックスの取得    │             │
│    │  df.dtypes    │  各列のデータ型          │             │
│    │  df.head(n)   │  先頭 n 行を表示         │             │
│    │  df.tail(n)   │  末尾 n 行を表示         │             │
│    │  df.info()    │  データ構造の確認        │             │
│    │  df.describe()│  統計情報の表示          │             │
│    └───────────────┴──────────────────────────┘             │
│                                                             │
│  【次のステップ】                                           │
│    Section3 では CSV/Excel ファイルの読み書きを学びます     │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```
