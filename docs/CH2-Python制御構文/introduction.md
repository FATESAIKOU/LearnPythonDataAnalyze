# CH2: Python 制御構文 - 学習の動機づけ

## 🎯 なぜ制御構文を学ぶのか？

Excel では、セルの数だけ同じ式をコピーしたり、IF 関数で条件分岐をしていませんか？
「もっと複雑な条件を設定したい」「もっと効率的に繰り返したい」と思ったことはありませんか？

Python の制御構文を学ぶことで、**プログラムの流れを自由にコントロール** できるようになります。

```
┌─────────────────────────────────────────────────────────────────┐
│                制御構文を学ぶ目的                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   🔀 条件で処理を分ける   →  複雑な判定を簡潔に表現できる      │
│                                                                 │
│   🔄 繰り返しを自動化     →  1万行でも同じコードで処理できる   │
│                                                                 │
│   🎮 流れをコントロール   →  途中でやめる・スキップも自由自在  │
│                                                                 │
│   📊 データ処理の基盤     →  Pandas での操作も内部で使用       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🔑 この章を学ぶための前提条件

```
┌─────────────────────────────────────────────────────────────────┐
│                      学習の前提条件                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ✅ 条件 1: CH1 の内容を理解している                            │
│     ─────────────────────────────────────────────────           │
│     • 変数に値を代入できる                                      │
│     • データ型（数値、文字列、真偽値）がわかる                  │
│     • 基本的な演算ができる                                      │
│                                                                 │
│  ✅ 条件 2: Excel の IF 関数を使ったことがある                  │
│     ─────────────────────────────────────────────────           │
│     • =IF(A1>100, "高い", "安い") のような式を見たことがある    │
│     • 条件によって結果が変わる、という概念がわかる              │
│                                                                 │
│  ✅ 条件 3: 繰り返し作業の経験がある                            │
│     ─────────────────────────────────────────────────           │
│     • 式を下にコピーして「オートフィル」した経験がある          │
│     • 「この作業、自動でできないかな」と思ったことがある        │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🔄 この章を学ぶと何が変わるのか？（As-Is / To-Be 比較）

### 変化1: 条件分岐がシンプルになる

**シナリオ**: 点数によって成績（A/B/C/D）を判定したい

```
┌─────────────────────────────────────────────────────────────────────────┐
│  📊 As-Is: Excel の IF 関数の場合                                       │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌───────┬─────────────────────────────────────────────────────────┐   │
│   │ 点数  │  成績                                                   │   │
│   ├───────┼─────────────────────────────────────────────────────────┤   │
│   │  85   │ =IF(A2>=90,"A",IF(A2>=70,"B",IF(A2>=50,"C","D")))       │   │
│   │  72   │ =IF(A3>=90,"A",IF(A3>=70,"B",IF(A3>=50,"C","D")))       │   │
│   │  45   │ =IF(A4>=90,"A",IF(A4>=70,"B",IF(A4>=50,"C","D")))       │   │
│   └───────┴─────────────────────────────────────────────────────────┘   │
│                                                                         │
│   😰 問題点:                                                            │
│   • IF がネストして読みにくい（括弧の対応が難しい）                     │
│   • 条件を追加すると式がさらに複雑になる                                │
│   • 修正時に括弧を間違えやすい                                          │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│  🐍 To-Be: Python の if-elif-else の場合                                │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  score = 85                                                     │   │
│   │                                                                 │   │
│   │  if score >= 90:                                                │   │
│   │      grade = "A"                                                │   │
│   │  elif score >= 70:                                              │   │
│   │      grade = "B"                                                │   │
│   │  elif score >= 50:                                              │   │
│   │      grade = "C"                                                │   │
│   │  else:                                                          │   │
│   │      grade = "D"                                                │   │
│   │                                                                 │   │
│   │  print(grade)  # → "B"                                         │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   😊 利点:                                                              │
│   • 条件が上から順に並んでいて読みやすい                                │
│   • 条件の追加・変更が簡単                                              │
│   • 括弧のネストがないのでミスしにくい                                  │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

### 変化2: 繰り返し処理が劇的に楽になる

**シナリオ**: 1〜100の数値それぞれに処理をしたい

```
┌─────────────────────────────────────────────────────────────────────────┐
│  📊 As-Is: Excel のオートフィルの場合                                   │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ① 式を入力                                                           │
│   ┌───────┬─────────────────┐                                           │
│   │   A   │       B         │                                           │
│   ├───────┼─────────────────┤                                           │
│   │   1   │  =A1*2          │  ← まず1行目に式を書く                   │
│   │   2   │                 │                                           │
│   │   3   │                 │                                           │
│   │  ...  │                 │                                           │
│   │  100  │                 │                                           │
│   └───────┴─────────────────┘                                           │
│                                                                         │
│   ② B1 セルを選択                                                      │
│   ③ 右下の角をドラッグして B100 までコピー                             │
│   ④ または Ctrl+D でオートフィル                                       │
│                                                                         │
│   😰 問題点:                                                            │
│   • 10万行になると手作業では限界                                        │
│   • 行数が変わるたびにやり直し                                          │
│   • 処理の途中で条件分岐するのが面倒                                    │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│  🐍 To-Be: Python の for ループの場合                                   │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  # 1から100まで、2倍した値を計算                                │   │
│   │  for i in range(1, 101):                                        │   │
│   │      result = i * 2                                             │   │
│   │      print(result)                                              │   │
│   │                                                                 │   │
│   │  # 出力:                                                        │   │
│   │  # 2                                                            │   │
│   │  # 4                                                            │   │
│   │  # 6                                                            │   │
│   │  # ... (100万行でも同じコード！)                                │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   😊 利点:                                                              │
│   • 100行でも100万行でも同じコードでOK                                  │
│   • 行数を変えるときは数字を変えるだけ                                  │
│   • ループ内で複雑な処理も簡単に追加できる                              │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

### 変化3: 条件付き繰り返しができるようになる

**シナリオ**: データを1行ずつ処理し、「終了」が出たら止めたい

```
┌─────────────────────────────────────────────────────────────────────────┐
│  📊 As-Is: Excel の場合                                                 │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌───────┬─────────────────────────────────────────────────────────┐   │
│   │ データ │  処理結果                                              │   │
│   ├───────┼─────────────────────────────────────────────────────────┤   │
│   │ 商品A │  =IF(A1="終了","",A1&"処理済み")                        │   │
│   │ 商品B │  =IF(A2="終了","",A2&"処理済み")                        │   │
│   │ 終了  │  =IF(A3="終了","",A3&"処理済み")  ← ここで止めたい...  │   │
│   │ 商品C │  =IF(A4="終了","",A4&"処理済み")  ← でも式は続く...    │   │
│   └───────┴─────────────────────────────────────────────────────────┘   │
│                                                                         │
│   😰 問題点:                                                            │
│   • 「途中で処理を止める」ことができない                                │
│   • 全行に式を入れておく必要がある                                      │
│   • 「終了」以降の行も計算されてしまう                                  │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│  🐍 To-Be: Python の for + break の場合                                 │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  data = ["商品A", "商品B", "終了", "商品C"]                     │   │
│   │                                                                 │   │
│   │  for item in data:                                              │   │
│   │      if item == "終了":                                         │   │
│   │          print("処理を終了します")                              │   │
│   │          break              # ← ここでループを抜ける！         │   │
│   │      print(item + "を処理しました")                             │   │
│   │                                                                 │   │
│   │  # 出力:                                                        │   │
│   │  # 商品Aを処理しました                                          │   │
│   │  # 商品Bを処理しました                                          │   │
│   │  # 処理を終了します                                             │   │
│   │  # (商品C は処理されない！)                                     │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   😊 利点:                                                              │
│   • 条件を満たしたら途中で止められる（break）                           │
│   • 特定の条件だけスキップすることも可能（continue）                    │
│   • 処理の流れを細かくコントロールできる                                │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 📚 この章で学ぶ内容

```
┌─────────────────────────────────────────────────────────────────────────┐
│                       CH2 の学習内容                                    │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  Section 1: 条件分岐（if文）                                            │
│  ────────────────────────────                                           │
│  • 条件によって処理を分岐させる                                         │
│                                                                         │
│      ┌─────────────────────────────────────────────────────────────┐    │
│      │        条件                                                 │    │
│      │         │                                                   │    │
│      │    ┌────┴────┐                                              │    │
│      │    ▼        ▼                                             │    │
│      │  [True]    [False]                                          │    │
│      │    │         │                                              │    │
│      │  処理A     処理B                                            │    │
│      └─────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ─────────────────────────────────────────────────────────────────────  │
│                                                                         │
│  Section 2: 繰り返し（for文）                                           │
│  ────────────────────────────                                           │
│  • リストや範囲の要素を順番に処理する                                   │
│                                                                         │
│      リスト: [1, 2, 3, 4, 5]                                            │
│                                                                         │
│      ┌────────────────────────────────────────────┐                     │
│      │  1回目: i=1 → print(1*10) → 10           │                     │
│      │  2回目: i=2 → print(2*10) → 20           │                     │
│      │  3回目: i=3 → print(3*10) → 30           │                     │
│      │  4回目: i=4 → print(4*10) → 40           │                     │
│      │  5回目: i=5 → print(5*10) → 50           │                     │
│      └────────────────────────────────────────────┘                     │
│                                                                         │
│      コード:                                                            │
│      ┌────────────────────────────────────────────┐                     │
│      │  for i in [1, 2, 3, 4, 5]:                 │                     │
│      │      print(i * 10)                         │                     │
│      └────────────────────────────────────────────┘                     │
│                                                                         │
│  ─────────────────────────────────────────────────────────────────────  │
│                                                                         │
│  Section 3: 繰り返し（while文）                                         │
│  ────────────────────────────                                           │
│  • 条件が満たされる間、処理を繰り返す                                   │
│                                                                         │
│      ┌──────────────────────────────────────────────┐                   │
│      │                                              │                   │
│      │   開始                                       │                   │
│      │     │                                        │                   │
│      │     ▼                                       │                   │
│      │   ┌──────────────┐                           │                   │
│      │   │ 条件チェック │──False──→ 終了           │                   │
│      │   └──────────────┘                           │                   │
│      │         │                                    │                   │
│      │       True                                   │                   │
│      │         ▼                                   │                   │
│      │   ┌──────────────┐                           │                   │
│      │   │   処理実行   │                           │                   │
│      │   └──────────────┘                           │                   │
│      │         │                                    │                   │
│      │         └──────────┐                         │                   │
│      │                    │                         │                   │
│      │      ┌─────────────┘                         │                   │
│      │      │  (条件チェックに戻る)                 │                   │
│      │      └───→ 上に戻る                         │                   │
│      │                                              │                   │
│      └──────────────────────────────────────────────┘                   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 🏁 この章のゴール

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        CH2 修了時の姿                                   │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  # この章を修了すると、このコードが「書ける」ようになります     │   │
│   │                                                                 │   │
│   │  # 売上データを分析                                             │   │
│   │  sales = [120, 85, 200, 45, 180, 95, 150]                       │   │
│   │                                                                 │   │
│   │  total = 0                                                      │   │
│   │  high_count = 0                                                 │   │
│   │                                                                 │   │
│   │  for sale in sales:                                             │   │
│   │      total = total + sale           # 合計を計算                │   │
│   │                                                                 │   │
│   │      if sale >= 150:                # 150以上なら               │   │
│   │          high_count = high_count + 1                            │   │
│   │          print(f"{sale}万円: 高売上！")                         │   │
│   │      elif sale >= 100:              # 100以上なら               │   │
│   │          print(f"{sale}万円: 標準")                             │   │
│   │      else:                          # それ以外                  │   │
│   │          print(f"{sale}万円: 要改善")                           │   │
│   │                                                                 │   │
│   │  print(f"合計: {total}万円")                                    │   │
│   │  print(f"高売上の日数: {high_count}日")                         │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   出力:                                                                 │
│   ┌─────────────────────────────────────────┐                           │
│   │  120万円: 標準                          │                           │
│   │  85万円: 要改善                         │                           │
│   │  200万円: 高売上！                      │                           │
│   │  45万円: 要改善                         │                           │
│   │  180万円: 高売上！                      │                           │
│   │  95万円: 要改善                         │                           │
│   │  150万円: 高売上！                      │                           │
│   │  合計: 875万円                          │                           │
│   │  高売上の日数: 3日                      │                           │
│   └─────────────────────────────────────────┘                           │
│                                                                         │
│   💡 for で繰り返し、if で条件分岐、これがデータ処理の基本！            │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 💪 さあ、始めましょう！

制御構文は、プログラミングの「心臓部」です。
Excel の IF 関数やオートフィルでやっていたことが、より柔軟かつ強力にできるようになります。

条件分岐と繰り返しをマスターすれば、データ処理の自動化が現実のものになります。

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│     🚀 次のステップ: ch-overview.md で章の全体像を確認！        │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```
