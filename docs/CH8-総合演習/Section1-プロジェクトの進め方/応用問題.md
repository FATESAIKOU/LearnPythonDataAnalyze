# Section1: プロジェクトの進め方 - 応用問題

## 🎯 この応用問題の目標

別のデータセット（penguins）を使って、ミニ分析プロセスの5ステップを **自分の力で** 実践する。

---

## 📋 課題概要

ペンギンの観測データ（penguins データセット）を分析し、種類ごとの特徴を明らかにしてください。

### 使用データ
- **データセット**: penguins（seaborn 組み込み）
- **内容**: 南極のペンギン3種類の体の測定データ

### 最終成果物
- 3つ以上の分析の問いとその答え
- 2つ以上のグラフ
- 簡単な分析レポート（Markdown）

---

## 📝 Step 1: 問いを立てる

penguins データセットについて、3つ以上の「問い」を考えてください。

```python
# Step 1: 分析の問いを書き出す

# 私の分析の問い:
# 1. 
# 2. 
# 3. 
```

**ヒント**: 以下の観点で考えてみてください
- 種類（species）による違い
- 島（island）による違い
- 体の各部位の関係性
- 性別（sex）による違い

---

## 📝 Step 2: データを見る

penguins データセットを読み込み、全体像を把握してください。

```python
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

# penguins データセットの読み込み
df = sns.load_dataset('penguins')

# ここから先は自分で書いてください
# head(), info(), describe(), shape を使って確認しましょう
```

### 確認すべき質問

1. このデータセットは何行何列ですか？
2. 欠損値はありますか？あるとしたらどの列に何件ありますか？
3. ペンギンの種類（species）は何種類ありますか？
4. 体重（body_mass_g）の平均値と最大値はいくらですか？

<details>
<summary>💡 ヒント：データ確認のコード</summary>

```python
# 先頭5行
print(df.head())

# 基本情報
print(df.info())

# 統計量
print(df.describe())

# サイズ
print(f"行数: {df.shape[0]}, 列数: {df.shape[1]}")

# 種類の確認
print(df['species'].unique())
```

</details>

<details>
<summary>💡 解答を見る</summary>

1. **344行、7列**
2. **欠損値あり**: bill_length_mm に 2件、bill_depth_mm に 2件、flipper_length_mm に 2件、body_mass_g に 2件、sex に 11件
3. **3種類**: Adelie, Chinstrap, Gentoo
4. **平均値: 約 4,202g、最大値: 6,300g**

</details>

---

## 📝 Step 3: データを整える

データに欠損値がある場合は、適切に処理してください。

```python
# 欠損値の確認
print("=== 欠損値の確認 ===")
# ここにコードを書く

# 欠損値の処理（必要に応じて）
# ここにコードを書く

# 処理後の確認
# ここにコードを書く
```

**ヒント**: 欠損値の処理方法
- `dropna()`: 欠損値を含む行を削除
- `fillna(値)`: 欠損値を特定の値で補完

<details>
<summary>💡 ヒントを見る</summary>

```python
# 欠損値の確認
print(df.isnull().sum())

# 欠損値を含む行を削除
df_clean = df.dropna()
```

</details>

<details>
<summary>💡 解答を見る</summary>

```python
# 欠損値の確認
print("=== 欠損値の確認 ===")
print(df.isnull().sum())

# 欠損値を含む行を削除
df_clean = df.dropna()

# 処理後の確認
print(f"\n処理前: {len(df)}行")
print(f"処理後: {len(df_clean)}行")
print(f"削除された行: {len(df) - len(df_clean)}行")
```

結果:
- 処理前: 344行
- 処理後: 333行
- 削除された行: 11行

</details>

---

## 📝 Step 4: 集計・可視化する

設定した問いに答えるための集計とグラフを作成してください。

### 課題4-1: 種類別の集計

ペンギンの種類ごとに、体の各部位の平均値を計算してください。

```python
# 種類別の平均値
# ここにコードを書く
```

<details>
<summary>💡 ヒントを見る</summary>

`groupby()` で種類ごとにグループ化し、`mean()` で平均を計算します。

```python
df_clean.groupby('species')[['列名1', '列名2', ...]].mean()
```

</details>

<details>
<summary>💡 解答を見る</summary>

```python
# 種類別の平均値
species_stats = df_clean.groupby('species')[['bill_length_mm', 'bill_depth_mm', 
                                              'flipper_length_mm', 'body_mass_g']].mean()
print(species_stats)
```

結果:
| species | bill_length_mm | bill_depth_mm | flipper_length_mm | body_mass_g |
|---------|----------------|---------------|-------------------|-------------|
| Adelie | 38.82 | 18.35 | 190.10 | 3706.16 |
| Chinstrap | 48.83 | 18.42 | 195.82 | 3733.09 |
| Gentoo | 47.57 | 15.00 | 217.24 | 5092.44 |

</details>

### 課題4-2: グラフの作成

2つ以上のグラフを作成してください。

**グラフ案**:
- 種類別の体重の棒グラフ
- くちばしの長さと深さの散布図（種類別に色分け）
- 種類別・性別の体重比較

```python
# グラフ1: 
# ここにコードを書く
```

<details>
<summary>💡 グラフ1のヒント：棒グラフ</summary>

種類別の体重を棒グラフで表示する場合：

```python
species_weight = df_clean.groupby('species')['body_mass_g'].mean()
species_weight.plot(kind='bar')
```

</details>

<details>
<summary>💡 グラフ1の解答を見る</summary>

```python
# グラフ1: 種類別の体重（棒グラフ）
species_weight = df_clean.groupby('species')['body_mass_g'].mean()

plt.figure(figsize=(8, 5))
species_weight.plot(kind='bar', color=['steelblue', 'coral', 'seagreen'])
plt.title('Average Body Mass by Species')
plt.xlabel('Species')
plt.ylabel('Body Mass (g)')
plt.xticks(rotation=0)
plt.tight_layout()
plt.show()
```

</details>

```python
# グラフ2: 
# ここにコードを書く
```

<details>
<summary>💡 グラフ2のヒント：散布図</summary>

種類別に色分けした散布図を作るには、for ループで種類ごとにプロットします：

```python
for species in df_clean['species'].unique():
    subset = df_clean[df_clean['species'] == species]
    plt.scatter(subset['x列'], subset['y列'], label=species)
plt.legend()
```

</details>

<details>
<summary>💡 グラフ2の解答を見る</summary>

```python
# グラフ2: くちばしの長さと深さの散布図（種類別）
colors = {'Adelie': 'steelblue', 'Chinstrap': 'coral', 'Gentoo': 'seagreen'}

plt.figure(figsize=(8, 6))
for species in df_clean['species'].unique():
    subset = df_clean[df_clean['species'] == species]
    plt.scatter(subset['bill_length_mm'], subset['bill_depth_mm'], 
                label=species, alpha=0.7, color=colors[species])

plt.title('Bill Length vs Bill Depth by Species')
plt.xlabel('Bill Length (mm)')
plt.ylabel('Bill Depth (mm)')
plt.legend()
plt.tight_layout()
plt.show()
```

この散布図から、3種類のペンギンがくちばしの形状で明確に分かれることがわかります。

</details>

---

## 📝 Step 5: 結論をまとめる

分析結果をレポートにまとめてください。

```markdown
# 分析レポート: ペンギンデータセット

## 1. 分析の目的
（あなたが設定した問いを書く）

## 2. 使用データ
- データセット: 
- レコード数: 
- 欠損値の処理: 

## 3. 分析結果

### 発見1: 
（集計結果とグラフから読み取れること）

### 発見2: 
（集計結果とグラフから読み取れること）

### 発見3: 
（集計結果とグラフから読み取れること）

## 4. 考察・まとめ
（結果から言えること、発見したパターンなど）
```

---

## ✅ 応用問題の完了チェック

以下の項目ができたら、この応用問題は完了です：

- [ ] penguins データセットを読み込んだ
- [ ] head/info/describe でデータを確認した
- [ ] 欠損値を確認し、必要に応じて処理した
- [ ] 3つ以上の問いを設定した
- [ ] 種類別の集計を行った
- [ ] 2つ以上のグラフを作成した
- [ ] 分析レポートを作成した

---

## 💡 解答例

<details>
<summary>クリックして解答例を見る</summary>

### Step 1: 問いの例

1. ペンギンの種類によって体重に差はあるか？
2. くちばしの長さと深さには相関関係があるか？
3. 種類によって生息している島は異なるか？

### Step 2: データの確認

```python
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

df = sns.load_dataset('penguins')

print("=== 先頭5行 ===")
print(df.head())

print("\n=== 基本情報 ===")
print(df.info())

print("\n=== 統計量 ===")
print(df.describe())

print(f"\n=== サイズ: {df.shape[0]}行, {df.shape[1]}列 ===")
```

- 344行、7列
- 欠損値あり（sex に 11件、他の数値列にも数件）

### Step 3: データの整理

```python
# 欠損値の確認
print("=== 欠損値の確認 ===")
print(df.isnull().sum())

# 欠損値を含む行を削除
df_clean = df.dropna()
print(f"\n処理後の行数: {len(df_clean)}")
```

### Step 4: 集計・可視化

```python
# 種類別の平均値
species_stats = df_clean.groupby('species')[['bill_length_mm', 'bill_depth_mm', 
                                              'flipper_length_mm', 'body_mass_g']].mean()
print(species_stats)
```

```python
# グラフ1: 種類別の体重（棒グラフ）
species_weight = df_clean.groupby('species')['body_mass_g'].mean()

plt.figure(figsize=(8, 5))
species_weight.plot(kind='bar', color=['steelblue', 'coral', 'seagreen'])
plt.title('Average Body Mass by Species')
plt.xlabel('Species')
plt.ylabel('Body Mass (g)')
plt.xticks(rotation=0)
plt.tight_layout()
plt.show()
```

```python
# グラフ2: くちばしの長さと深さの散布図（種類別）
colors = {'Adelie': 'steelblue', 'Chinstrap': 'coral', 'Gentoo': 'seagreen'}

plt.figure(figsize=(8, 6))
for species in df_clean['species'].unique():
    subset = df_clean[df_clean['species'] == species]
    plt.scatter(subset['bill_length_mm'], subset['bill_depth_mm'], 
                label=species, alpha=0.7, color=colors[species])

plt.title('Bill Length vs Bill Depth by Species')
plt.xlabel('Bill Length (mm)')
plt.ylabel('Bill Depth (mm)')
plt.legend()
plt.tight_layout()
plt.show()
```

### Step 5: レポート例

```markdown
# 分析レポート: ペンギンデータセット

## 1. 分析の目的
南極に生息する3種類のペンギンの体の特徴の違いを明らかにする。

## 2. 使用データ
- データセット: penguins（seaborn 組み込み）
- 元のレコード数: 344件
- 欠損値処理後: 333件（欠損値を含む行を削除）

## 3. 分析結果

### 発見1: 種類によって体重に大きな差がある
- Gentoo が最も重い（平均約 5,076g）
- Adelie と Chinstrap は同程度（約 3,700g）

### 発見2: くちばしの形状は種類ごとに特徴がある
- Gentoo: 長くて浅いくちばし
- Adelie: 短くて深いくちばし
- Chinstrap: Adelie と Gentoo の中間

### 発見3: 種類と島の関係
- Gentoo は主に Biscoe 島に生息
- Chinstrap は Dream 島のみに生息
- Adelie は3つの島すべてに生息

## 4. 考察・まとめ
ペンギンの3種類は体の特徴で明確に区別できる。特にくちばしの形状は
種類判別の良い指標となる。Gentoo は他の2種より体が大きく、
くちばしも長いことから、異なる食性を持つ可能性がある。
```

</details>

---

## 🎉 Section1 完了！

お疲れさまでした！これでミニ分析プロセスの5ステップを理解しました。

次の Section2 では、このプロセスを使って「売上分析」のミニプロジェクトに挑戦します！
