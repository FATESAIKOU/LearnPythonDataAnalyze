# Section3: ãƒŸãƒ‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆâ‘¡ ãƒšãƒ³ã‚®ãƒ³è¦³æ¸¬ãƒ‡ãƒ¼ã‚¿åˆ†æ - å¿œç”¨å•é¡Œ

## ğŸ¯ ã“ã®å¿œç”¨å•é¡Œã®ç›®æ¨™

æ¼”ç¿’ã§è¡Œã£ãŸåŸºæœ¬çš„ãªåˆ†æã«åŠ ãˆã¦ã€ã‚ˆã‚Šæ·±ã„åˆ†æã«æŒ‘æˆ¦ã™ã‚‹ã€‚
ç›¸é–¢åˆ†æã‚„æ¡ä»¶ä»˜ãåˆ†æãªã©ã€ç™ºå±•çš„ãªãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’ä½¿ã†ã€‚

---

## ğŸ“‹ å¿œç”¨èª²é¡Œ

ä»¥ä¸‹ã®3ã¤ã®èª²é¡Œã«å–ã‚Šçµ„ã‚“ã§ãã ã•ã„ã€‚

---

## ğŸ“ èª²é¡Œ1: ç›¸é–¢åˆ†æ

### èª²é¡Œã®èª¬æ˜

ãƒšãƒ³ã‚®ãƒ³ã®ä½“ã®å„éƒ¨ä½ã®é–“ã«ã¯ã©ã®ã‚ˆã†ãªç›¸é–¢é–¢ä¿‚ãŒã‚ã‚‹ã‹åˆ†æã—ã¦ãã ã•ã„ã€‚

### ã‚„ã‚‹ã“ã¨

1. æ•°å€¤åˆ—ã®ç›¸é–¢è¡Œåˆ—ã‚’è¨ˆç®—
2. ç›¸é–¢ãŒå¼·ã„ãƒšã‚¢ã€å¼±ã„ãƒšã‚¢ã‚’ç‰¹å®š
3. æœ€ã‚‚ç›¸é–¢ãŒå¼·ã„ãƒšã‚¢ã®æ•£å¸ƒå›³ã‚’ä½œæˆ
4. ç¨®é¡ã«ã‚ˆã£ã¦ç›¸é–¢ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒç•°ãªã‚‹ã‹ç¢ºèª

```python
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

df = sns.load_dataset('penguins')
df_clean = df.dropna()

# èª²é¡Œ1: ç›¸é–¢åˆ†æ
# ã“ã“ã«ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã
```

<details>
<summary>ğŸ’¡ ãƒ’ãƒ³ãƒˆã‚’è¦‹ã‚‹</summary>

ç›¸é–¢è¡Œåˆ—ã®è¨ˆç®—ï¼š
```python
numeric_cols = ['bill_length_mm', 'bill_depth_mm', 'flipper_length_mm', 'body_mass_g']
correlation_matrix = df_clean[numeric_cols].corr()
```

ç¨®é¡ã”ã¨ã«ç›¸é–¢ã‚’è¨ˆç®—ï¼š
```python
for species in df_clean['species'].unique():
    subset = df_clean[df_clean['species'] == species]
    print(f"\n=== {species} ===")
    print(subset[numeric_cols].corr().round(3))
```

</details>

<details>
<summary>ğŸ’¡ è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

```python
# æ•°å€¤åˆ—ã‚’é¸æŠ
numeric_cols = ['bill_length_mm', 'bill_depth_mm', 'flipper_length_mm', 'body_mass_g']

# å…¨ä½“ã®ç›¸é–¢è¡Œåˆ—
print("=== å…¨ä½“ã®ç›¸é–¢è¡Œåˆ— ===")
correlation_matrix = df_clean[numeric_cols].corr()
print(correlation_matrix.round(3))

# æœ€ã‚‚ç›¸é–¢ãŒå¼·ã„ãƒšã‚¢ï¼šã²ã‚Œã®é•·ã• Ã— ä½“é‡
print(f"\nã²ã‚Œã®é•·ã• Ã— ä½“é‡ ã®ç›¸é–¢: {df_clean['flipper_length_mm'].corr(df_clean['body_mass_g']):.3f}")

# æ•£å¸ƒå›³ã§ç¢ºèª
plt.figure(figsize=(8, 6))
for species in df_clean['species'].unique():
    subset = df_clean[df_clean['species'] == species]
    plt.scatter(subset['flipper_length_mm'], subset['body_mass_g'], 
                label=species, alpha=0.7)

plt.title('Flipper Length vs Body Mass')
plt.xlabel('Flipper Length (mm)')
plt.ylabel('Body Mass (g)')
plt.legend()
plt.tight_layout()
plt.show()

# ç¨®é¡ã”ã¨ã®ç›¸é–¢
print("\n=== ç¨®é¡ã”ã¨ã®ã€Œã²ã‚Œã®é•·ã• Ã— ä½“é‡ã€ç›¸é–¢ ===")
for species in df_clean['species'].unique():
    subset = df_clean[df_clean['species'] == species]
    corr = subset['flipper_length_mm'].corr(subset['body_mass_g'])
    print(f"{species}: {corr:.3f}")
```

**ç™ºè¦‹ä¾‹**:
- å…¨ä½“ã§ã¯ã€Œã²ã‚Œã®é•·ã• Ã— ä½“é‡ã€ã®ç›¸é–¢ãŒæœ€ã‚‚å¼·ã„ï¼ˆ0.87ï¼‰
- ç¨®é¡ã”ã¨ã«è¦‹ã‚‹ã¨ã€ç›¸é–¢ã¯ 0.70-0.72 ç¨‹åº¦
- å…¨ä½“ã®ç›¸é–¢ãŒé«˜ãè¦‹ãˆã‚‹ã®ã¯ã€ç¨®é¡é–“ã®å·®ãŒå¤§ãã„ãŸã‚

</details>

---

## ğŸ“ èª²é¡Œ2: å³¶ã”ã¨ã®è©³ç´°åˆ†æ

### èª²é¡Œã®èª¬æ˜

3ã¤ã®å³¶ï¼ˆBiscoe, Dream, Torgersenï¼‰ã”ã¨ã«ã€ãƒšãƒ³ã‚®ãƒ³ã®ç‰¹å¾´ã‚’è©³ã—ãåˆ†æã—ã¦ãã ã•ã„ã€‚

### ã‚„ã‚‹ã“ã¨

1. å³¶ã”ã¨ã®ç¨®ã®åˆ†å¸ƒã‚’ç¢ºèª
2. å³¶ã”ã¨ã®å¹³å‡ä½“æ ¼ã‚’æ¯”è¼ƒ
3. åŒã˜ç¨®ï¼ˆAdelieï¼‰ãŒè¤‡æ•°ã®å³¶ã«ã„ã‚‹å ´åˆã€å³¶ã«ã‚ˆã£ã¦ä½“æ ¼ã«å·®ãŒã‚ã‚‹ã‹åˆ†æ
4. çµæœã‚’å¯è¦–åŒ–

```python
# èª²é¡Œ2: å³¶ã”ã¨ã®åˆ†æ
# ã“ã“ã«ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã
```

<details>
<summary>ğŸ’¡ ãƒ’ãƒ³ãƒˆã‚’è¦‹ã‚‹</summary>

å³¶ã”ã¨ã®é›†è¨ˆï¼š
```python
df_clean.groupby('island')[['body_mass_g', 'flipper_length_mm']].mean()
```

Adelie ã ã‘ã‚’æŠ½å‡ºã—ã¦å³¶ã”ã¨ã«æ¯”è¼ƒï¼š
```python
adelie = df_clean[df_clean['species'] == 'Adelie']
adelie.groupby('island')['body_mass_g'].mean()
```

</details>

<details>
<summary>ğŸ’¡ è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

```python
# å³¶ã”ã¨ã®ç¨®ã®åˆ†å¸ƒ
print("=== å³¶ã”ã¨ã®ç¨®ã®åˆ†å¸ƒ ===")
island_species = pd.crosstab(df_clean['island'], df_clean['species'])
print(island_species)

# å³¶ã”ã¨ã®å¹³å‡ä½“æ ¼
print("\n=== å³¶ã”ã¨ã®å¹³å‡ä½“æ ¼ ===")
island_stats = df_clean.groupby('island')[['body_mass_g', 'flipper_length_mm', 
                                            'bill_length_mm', 'bill_depth_mm']].mean()
print(island_stats.round(2))

# Adelie ã ã‘ã‚’æŠ½å‡ºã—ã¦å³¶ã”ã¨ã«æ¯”è¼ƒ
print("\n=== Adelie ã®å³¶åˆ¥ä½“æ ¼ ===")
adelie = df_clean[df_clean['species'] == 'Adelie']
adelie_by_island = adelie.groupby('island')['body_mass_g'].agg(['mean', 'std', 'count'])
print(adelie_by_island.round(2))

# å¯è¦–åŒ–
adelie.groupby('island')['body_mass_g'].mean().plot(kind='bar', figsize=(8, 5), color='steelblue')
plt.title('Adelie Body Mass by Island')
plt.xlabel('Island')
plt.ylabel('Body Mass (g)')
plt.xticks(rotation=0)
plt.tight_layout()
plt.show()
```

**ç™ºè¦‹ä¾‹**:
- Biscoe å³¶ã¯ Gentoo ã®å½±éŸ¿ã§å¹³å‡ä½“é‡ãŒé«˜ã„
- Adelie ã¯3å³¶ã§ä½“æ ¼ã«å¤§ããªå·®ã¯ãªã„ï¼ˆç´„ 3,700gï¼‰
- Torgersen å³¶ã® Adelie ãŒã‚ãšã‹ã«è»½ã„å‚¾å‘

</details>

---

## ğŸ“ èª²é¡Œ3: ç¨®ã®åˆ¤åˆ¥ãƒ«ãƒ¼ãƒ«ã‚’ä½œæˆ

### èª²é¡Œã®èª¬æ˜

ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã€ç¨®ã‚’åˆ¤åˆ¥ã™ã‚‹ãŸã‚ã®ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ«ãƒ¼ãƒ«ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

### ã‚„ã‚‹ã“ã¨

1. å„æŒ‡æ¨™ã®é–¾å€¤ï¼ˆã—ãã„å€¤ï¼‰ã‚’è¦‹ã¤ã‘ã‚‹
2. ãƒ«ãƒ¼ãƒ«ã‚’è¨€èªåŒ–ã™ã‚‹ï¼ˆä¾‹ï¼šã€Œãã¡ã°ã—ã®æ·±ã•ãŒ 16mm æœªæº€ãªã‚‰ Gentooã€ï¼‰
3. ãã®ãƒ«ãƒ¼ãƒ«ã®æ­£ç¢ºæ€§ã‚’æ¤œè¨¼
4. åˆ¤åˆ¥ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã‚’ä½œæˆ

```python
# èª²é¡Œ3: åˆ¤åˆ¥ãƒ«ãƒ¼ãƒ«ã®ä½œæˆ
# ã“ã“ã«ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã
```

<details>
<summary>ğŸ’¡ ãƒ’ãƒ³ãƒˆã‚’è¦‹ã‚‹</summary>

å„ç¨®é¡ã®çµ±è¨ˆé‡ã‚’è©³ã—ãè¦‹ã‚‹ï¼š
```python
df_clean.groupby('species')['bill_depth_mm'].describe()
```

ãƒ«ãƒ¼ãƒ«ã®æ¤œè¨¼ï¼š
```python
# ä¾‹ï¼šãã¡ã°ã—ã®æ·±ã• < 16mm ã‚’ Gentoo ã¨äºˆæ¸¬
prediction = df_clean['bill_depth_mm'] < 16
actual_gentoo = df_clean['species'] == 'Gentoo'
accuracy = (prediction == actual_gentoo).mean()
print(f"æ­£è§£ç‡: {accuracy:.1%}")
```

</details>

<details>
<summary>ğŸ’¡ è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

```python
# å„ç¨®é¡ã®æŒ‡æ¨™ã®åˆ†å¸ƒã‚’ç¢ºèª
print("=== ãã¡ã°ã—ã®æ·±ã• ===")
print(df_clean.groupby('species')['bill_depth_mm'].describe().round(2))

print("\n=== ã²ã‚Œã®é•·ã• ===")
print(df_clean.groupby('species')['flipper_length_mm'].describe().round(2))

print("\n=== ãã¡ã°ã—ã®é•·ã• ===")
print(df_clean.groupby('species')['bill_length_mm'].describe().round(2))

# ãƒ«ãƒ¼ãƒ«1: ãã¡ã°ã—ã®æ·±ã• < 16mm â†’ Gentoo
rule1 = df_clean['bill_depth_mm'] < 16
actual_gentoo = df_clean['species'] == 'Gentoo'
accuracy1 = (rule1 == actual_gentoo).mean()
print(f"\nãƒ«ãƒ¼ãƒ«1ã€Œæ·±ã• < 16mm â†’ Gentooã€ã®æ­£è§£ç‡: {accuracy1:.1%}")

# ãƒ«ãƒ¼ãƒ«2: ã²ã‚Œã®é•·ã• > 210mm â†’ Gentoo
rule2 = df_clean['flipper_length_mm'] > 210
accuracy2 = (rule2 == actual_gentoo).mean()
print(f"ãƒ«ãƒ¼ãƒ«2ã€Œã²ã‚Œ > 210mm â†’ Gentooã€ã®æ­£è§£ç‡: {accuracy2:.1%}")

# Gentoo ä»¥å¤–ã‚’åˆ¤åˆ¥ï¼šãã¡ã°ã—ã®é•·ã•ã§ Adelie vs Chinstrap
non_gentoo = df_clean[df_clean['species'] != 'Gentoo']
rule3 = non_gentoo['bill_length_mm'] < 45
actual_adelie = non_gentoo['species'] == 'Adelie'
accuracy3 = (rule3 == actual_adelie).mean()
print(f"ãƒ«ãƒ¼ãƒ«3ã€Œé•·ã• < 45mm â†’ Adelieã€ã®æ­£è§£ç‡: {accuracy3:.1%}")

# åˆ¤åˆ¥ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ
flowchart = """
=== ç¨®ã®åˆ¤åˆ¥ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ ===

              ãƒšãƒ³ã‚®ãƒ³ã‚’è¦³æ¸¬
                   â”‚
                   â–¼
        ãã¡ã°ã—ã®æ·±ã• < 16mm ?
              /         \\
           Yes           No
            â”‚             â”‚
            â–¼             â–¼
         Gentoo    ãã¡ã°ã—ã®é•·ã• < 45mm ?
                        /         \\
                     Yes           No
                      â”‚             â”‚
                      â–¼             â–¼
                   Adelie       Chinstrap
"""
print(flowchart)

# å…¨ä½“ã®æ­£è§£ç‡ã‚’æ¤œè¨¼
def predict_species(row):
    if row['bill_depth_mm'] < 16:
        return 'Gentoo'
    elif row['bill_length_mm'] < 45:
        return 'Adelie'
    else:
        return 'Chinstrap'

df_clean['predicted'] = df_clean.apply(predict_species, axis=1)
total_accuracy = (df_clean['predicted'] == df_clean['species']).mean()
print(f"\nå…¨ä½“ã®æ­£è§£ç‡: {total_accuracy:.1%}")

# æ··åŒè¡Œåˆ—
print("\n=== æ··åŒè¡Œåˆ— ===")
confusion = pd.crosstab(df_clean['species'], df_clean['predicted'])
print(confusion)
```

**ç™ºè¦‹ä¾‹**:
- ãƒ«ãƒ¼ãƒ«1ã€Œæ·±ã• < 16mm â†’ Gentooã€ã§ç´„ 95% ã®æ­£è§£ç‡
- 3ã¤ã®ç°¡å˜ãªãƒ«ãƒ¼ãƒ«ã§ç´„ 95% ã®ç²¾åº¦ã§ç¨®ã‚’åˆ¤åˆ¥ã§ãã‚‹

</details>

---

## ğŸ“ è¿½åŠ ãƒãƒ£ãƒ¬ãƒ³ã‚¸ï¼ˆä»»æ„ï¼‰

æ™‚é–“ã«ä½™è£•ãŒã‚ã‚Œã°ã€ä»¥ä¸‹ã®èª²é¡Œã«ã‚‚æŒ‘æˆ¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚

### ãƒãƒ£ãƒ¬ãƒ³ã‚¸1: å¤–ã‚Œå€¤ã®åˆ†æ

ä½“é‡ãŒæ¥µç«¯ã«è»½ã„/é‡ã„ãƒšãƒ³ã‚®ãƒ³ã¯ã©ã®ã‚ˆã†ãªç‰¹å¾´ãŒã‚ã‚‹ã‹ï¼Ÿ

<details>
<summary>ğŸ’¡ åˆ†æã®ãƒ’ãƒ³ãƒˆ</summary>

```python
# å››åˆ†ä½ç¯„å›²ï¼ˆIQRï¼‰ã§å¤–ã‚Œå€¤ã‚’æ¤œå‡º
Q1 = df_clean['body_mass_g'].quantile(0.25)
Q3 = df_clean['body_mass_g'].quantile(0.75)
IQR = Q3 - Q1

lower_bound = Q1 - 1.5 * IQR
upper_bound = Q3 + 1.5 * IQR

outliers = df_clean[(df_clean['body_mass_g'] < lower_bound) | 
                    (df_clean['body_mass_g'] > upper_bound)]
print(outliers)
```

</details>

### ãƒãƒ£ãƒ¬ãƒ³ã‚¸2: å¹´åº¦ã«ã‚ˆã‚‹å¤‰åŒ–ï¼ˆç™ºå±•ï¼‰

penguins ãƒ‡ãƒ¼ã‚¿ã«ã¯å¹´åº¦æƒ…å ±ãŒã‚ã‚Šã¾ã›ã‚“ãŒã€ã‚‚ã—ã‚ã£ãŸå ´åˆã©ã®ã‚ˆã†ãªåˆ†æãŒã§ãã‚‹ã‹è€ƒãˆã¦ã¿ã¦ãã ã•ã„ã€‚

<details>
<summary>ğŸ’¡ è€ƒå¯Ÿã®ãƒ’ãƒ³ãƒˆ</summary>

- çµŒå¹´ã§ã®ä½“æ ¼ã®å¤‰åŒ–ï¼ˆæ¸©æš–åŒ–ã®å½±éŸ¿ï¼Ÿï¼‰
- ç¨®ã®å€‹ä½“æ•°ã®å¤‰åŒ–
- ç”Ÿæ¯å³¶ã®å¤‰åŒ–

å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿åˆ†æã§ã¯ã€æ™‚ç³»åˆ—ã®å¤‰åŒ–ã‚’è¦‹ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚

</details>

---

## âœ… å¿œç”¨å•é¡Œã®å®Œäº†ãƒã‚§ãƒƒã‚¯

ä»¥ä¸‹ã®é …ç›®ãŒã§ããŸã‚‰ã€ã“ã®å¿œç”¨å•é¡Œã¯å®Œäº†ã§ã™ï¼š

- [ ] èª²é¡Œ1: ç›¸é–¢åˆ†æã‚’è¡Œã„ã€å¼·ã„ç›¸é–¢ã®ãƒšã‚¢ã‚’ç™ºè¦‹ã—ãŸ
- [ ] èª²é¡Œ2: å³¶ã”ã¨ã®è©³ç´°åˆ†æã‚’è¡Œã£ãŸ
- [ ] èª²é¡Œ3: ç¨®ã®åˆ¤åˆ¥ãƒ«ãƒ¼ãƒ«ã‚’ä½œæˆã—ã€æ­£ç¢ºæ€§ã‚’æ¤œè¨¼ã—ãŸ
- [ ] å„èª²é¡Œã§ç™ºè¦‹ã—ãŸã“ã¨ã‚’ã¾ã¨ã‚ãŸ

---

## ğŸ‰ CH8 å®Œäº†ï¼ æ•™æä¿®äº†ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼

ãŠç–²ã‚Œã•ã¾ã§ã—ãŸï¼ã“ã‚Œã§ç·åˆæ¼”ç¿’ã¯å®Œäº†ã§ã™ã€‚

ã‚ãªãŸã¯ä»¥ä¸‹ã®ã‚¹ã‚­ãƒ«ã‚’èº«ã«ã¤ã‘ã¾ã—ãŸï¼š

| ã‚¹ã‚­ãƒ« | å†…å®¹ |
|--------|------|
| **Python åŸºç¤** | å¤‰æ•°ã€ãƒ‡ãƒ¼ã‚¿å‹ã€åˆ¶å¾¡æ§‹æ–‡ã€é–¢æ•° |
| **NumPy** | é…åˆ—ã®ä½œæˆã¨æ“ä½œã€æ•°å€¤è¨ˆç®— |
| **Pandas** | ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã€åŠ å·¥ã€é›†è¨ˆã€çµåˆ |
| **Matplotlib** | æ£’ã‚°ãƒ©ãƒ•ã€æŠ˜ã‚Œç·šã€æ•£å¸ƒå›³ã€ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ  |
| **ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ—ãƒ­ã‚»ã‚¹** | å•ã„ã‚’ç«‹ã¦ã‚‹ â†’ ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã‚‹ â†’ æ•´ãˆã‚‹ â†’ é›†è¨ˆãƒ»å¯è¦–åŒ– â†’ ã¾ã¨ã‚ã‚‹ |

---

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ã•ã‚‰ã«å­¦ç¿’ã‚’ç¶šã‘ãŸã„æ–¹ã¸ã®ãŠã™ã™ã‚ï¼š

| ãƒˆãƒ”ãƒƒã‚¯ | èª¬æ˜ |
|----------|------|
| **Seaborn** | ã‚ˆã‚Šç¾ã—ã„çµ±è¨ˆã‚°ãƒ©ãƒ•ã‚’ç°¡å˜ã«ä½œæˆ |
| **çµ±è¨ˆå­¦** | ä»®èª¬æ¤œå®šã€ä¿¡é ¼åŒºé–“ã€å›å¸°åˆ†æ |
| **æ©Ÿæ¢°å­¦ç¿’** | scikit-learn ã§åˆ†é¡ãƒ»å›å¸°ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ |
| **SQL** | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾— |
| **å®Ÿãƒ‡ãƒ¼ã‚¿ã§ç·´ç¿’** | Kaggle ãªã©ã§ã‚³ãƒ³ãƒšã«å‚åŠ  |

**ã“ã‚Œã‹ã‚‰ã‚‚å­¦ã³ç¶šã‘ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ä¾¡å€¤ã‚’ç”Ÿã¿å‡ºã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼**
