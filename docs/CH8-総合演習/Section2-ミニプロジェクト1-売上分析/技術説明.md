# Section2: ミニプロジェクト① 売上分析 - 技術説明

## 🎯 このセクションの目標

レストランの売上データを分析し、ビジネス改善のための示唆を導き出す。
Section1 で学んだ **ミニ分析プロセス（5ステップ）** を実践で活用する。

---

## 📋 プロジェクト概要

### シナリオ

あなたはレストランチェーンのデータ分析担当者です。
経営陣から「売上を伸ばすためのヒントを見つけてほしい」と依頼されました。

手元にあるのは、過去の会計データ（合計金額、チップ、曜日、時間帯など）です。
このデータを分析して、売上向上のための提案をまとめてください。

### 使用データ

**tips データセット**（seaborn 組み込み）

| 列名 | 説明 | データ型 |
|------|------|----------|
| total_bill | 合計金額（$） | 数値 |
| tip | チップ額（$） | 数値 |
| sex | 支払者の性別 | カテゴリ |
| smoker | 喫煙者かどうか | カテゴリ |
| day | 曜日（Thur, Fri, Sat, Sun） | カテゴリ |
| time | 時間帯（Lunch, Dinner） | カテゴリ |
| size | 人数 | 数値 |

```python
import seaborn as sns
df = sns.load_dataset('tips')
```

---

## 🔍 分析の問い（例）

このプロジェクトでは、以下のような問いに答えることを目指します：

| # | 分析の問い | 使う技術 |
|---|------------|----------|
| 1 | 曜日によって売上（合計金額）に差はあるか？ | groupby + 棒グラフ |
| 2 | ランチとディナーで客単価に違いはあるか？ | groupby + 比較 |
| 3 | 人数と合計金額にはどんな関係があるか？ | 散布図 + 相関 |
| 4 | チップ率が高いのはどんな条件か？ | groupby + 複合分析 |
| 5 | 売上を伸ばすにはどうすればよいか？ | 総合的な考察 |

---

## 📊 分析で使うテクニック

### 1. 売上の集計

```python
# 曜日別の合計売上
daily_sales = df.groupby('day')['total_bill'].sum()
print(daily_sales)

# 曜日別の平均客単価
daily_avg = df.groupby('day')['total_bill'].mean()
print(daily_avg)

# 曜日別の来客数（レコード数）
daily_count = df.groupby('day')['total_bill'].count()
print(daily_count)
```

### 2. 複数条件でのグループ化

```python
# 曜日 × 時間帯 の平均売上
cross_avg = df.groupby(['day', 'time'])['total_bill'].mean()
print(cross_avg)

# 見やすく表形式に変換
cross_table = cross_avg.unstack()
print(cross_table)
```

### 3. チップ率の計算

```python
# チップ率（%）を新しい列として追加
df['tip_rate'] = df['tip'] / df['total_bill'] * 100

# チップ率の統計量
print(df['tip_rate'].describe())
```

### 4. 条件別の比較

```python
# 喫煙者・非喫煙者の比較
smoker_comparison = df.groupby('smoker')['total_bill'].agg(['mean', 'sum', 'count'])
print(smoker_comparison)
```

### 5. 相関の確認

```python
# 人数と合計金額の相関係数
correlation = df['size'].corr(df['total_bill'])
print(f"相関係数: {correlation:.3f}")
```

> 💡 **相関係数の解釈**
> - 0.7 以上: 強い正の相関
> - 0.4 〜 0.7: 中程度の正の相関
> - 0.0 〜 0.4: 弱い相関または相関なし

---

## 📈 可視化のテクニック

### 棒グラフ：カテゴリ別の比較

```python
import matplotlib.pyplot as plt

# 曜日別の平均売上
daily_avg = df.groupby('day')['total_bill'].mean()

plt.figure(figsize=(8, 5))
daily_avg.plot(kind='bar', color='steelblue')
plt.title('Average Sales by Day')
plt.xlabel('Day')
plt.ylabel('Average Total Bill ($)')
plt.xticks(rotation=0)
plt.tight_layout()
plt.show()
```

### 散布図：2変数の関係

```python
# 人数と合計金額の関係
plt.figure(figsize=(8, 5))
plt.scatter(df['size'], df['total_bill'], alpha=0.6)
plt.title('Party Size vs Total Bill')
plt.xlabel('Party Size')
plt.ylabel('Total Bill ($)')
plt.tight_layout()
plt.show()
```

### 複数カテゴリの比較：グループ化棒グラフ

```python
# 曜日 × 時間帯 の平均売上を比較
cross_table = df.groupby(['day', 'time'])['total_bill'].mean().unstack()

cross_table.plot(kind='bar', figsize=(10, 5))
plt.title('Average Sales by Day and Time')
plt.xlabel('Day')
plt.ylabel('Average Total Bill ($)')
plt.xticks(rotation=0)
plt.legend(title='Time')
plt.tight_layout()
plt.show()
```

### ヒストグラム：分布の確認

```python
# 合計金額の分布
plt.figure(figsize=(8, 5))
plt.hist(df['total_bill'], bins=20, color='steelblue', edgecolor='white')
plt.title('Distribution of Total Bill')
plt.xlabel('Total Bill ($)')
plt.ylabel('Frequency')
plt.tight_layout()
plt.show()
```

---

## 📝 レポートの書き方

### 構成例

```markdown
# 売上分析レポート

## 1. 分析の目的
レストランの売上データを分析し、売上向上のための示唆を得る。

## 2. 使用データ
- データセット: tips（seaborn 組み込み）
- レコード数: 244件
- 期間: サンプルデータ

## 3. 分析結果

### 3.1 曜日別の売上傾向
（グラフと数値を示し、発見を記述）

### 3.2 時間帯別の客単価
（グラフと数値を示し、発見を記述）

### 3.3 人数と売上の関係
（グラフと相関係数を示し、発見を記述）

## 4. 考察・提案
（分析結果から導かれる示唆と具体的な提案）
```

### 提案の書き方のコツ

| ポイント | 説明 | 例 |
|----------|------|-----|
| 具体的に | 「〜すべき」より「〜を〜%増やす」 | 週末の席数を 20% 増やす |
| 根拠を示す | 数字やグラフを引用 | 「土曜日の売上が最も高い」ため |
| 実行可能に | 現実的な提案 | 「全店舗で即日実施」は非現実的 |

---

## ⏰ 想定作業時間

| 作業 | 時間 |
|------|------|
| データの読み込みと確認 | 10 分 |
| 集計と可視化 | 40 分 |
| 結果の解釈と考察 | 20 分 |
| レポート作成 | 20 分 |
| **合計** | **90 分** |

---

## 💡 進め方のヒント

1. **まずデータを見る**: head(), info(), describe() で全体像を把握
2. **問いを1つずつ**: 一度に全部やらず、1つずつ分析
3. **グラフで確認**: 数字だけでなく可視化して傾向を掴む
4. **メモを残す**: 気づいたことは Jupyter の Markdown セルにメモ
5. **行き詰まったら AI に相談**: エラーや方針で困ったら質問

---

次の「演習.md」で、実際にこのプロジェクトを進めます！
