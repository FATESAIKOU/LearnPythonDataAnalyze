# Python データ分析入門 - 学習の動機づけ

## 🎯 なぜ Python でデータ分析を学ぶのか？

あなたは普段、Excel や Google スプレッドシートでデータを整理していませんか？
「もっと大量のデータを扱いたい」「繰り返し作業を自動化したい」と思ったことはありませんか？

**Python を使ったデータ分析** を学ぶことで、これらの課題を解決できます。

```
┌─────────────────────────────────────────────────────────────────┐
│                    Python を学ぶ目的                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   📊 大量データの処理     →  数万行のデータも一瞬で処理        │
│                                                                 │
│   🔄 繰り返し作業の自動化 →  毎月のレポート作成を自動で実行    │
│                                                                 │
│   📈 高度な分析と可視化   →  専門的なグラフや統計分析が可能    │
│                                                                 │
│   🤖 AI 活用の基盤作り    →  データを AI に渡す前処理ができる  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🔑 学習を始める前に（前提条件）

Python データ分析を学ぶために、特別なプログラミング知識は必要ありません。
以下の経験があれば、スムーズに学習を進められます。

```
┌─────────────────────────────────────────────────────────────────┐
│                      学習の前提条件                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ✅ 条件 1: Excel / スプレッドシートの基本操作ができる          │
│     ─────────────────────────────────────────────────           │
│     • セルにデータを入力できる                                  │
│     • SUM や AVERAGE などの関数を使ったことがある               │
│     • フィルターやソートでデータを整理できる                    │
│                                                                 │
│  ✅ 条件 2: 表形式データの概念を理解している                    │
│     ─────────────────────────────────────────────────           │
│     • 「行」と「列」の違いがわかる                              │
│     • ヘッダー行（項目名）の意味がわかる                        │
│     • CSV ファイルを見たことがある                              │
│                                                                 │
│  ✅ 条件 3: 「自動化したい」という気持ちがある                  │
│     ─────────────────────────────────────────────────           │
│     • 手作業の繰り返しに疲れている                              │
│     • もっと効率的にデータを扱いたい                            │
│     • AI にコードを生成してもらう「その先」を知りたい           │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

> 💡 **GAS（Google Apps Script）を使っている方へ**
> 
> AI にコードを生成してもらい、そのまま貼り付けて使っている経験がある方は、
> 本教材で「コードの意味」を理解することで、より効果的に AI を活用できるようになります。

---

## 🔄 Python を学ぶと何が変わるのか？（As-Is / To-Be 比較）

### 例1: 複数ファイルのデータ集計

**シナリオ**: 12ヶ月分の売上データ（各月1ファイル）を1つに結合して集計したい

#### 📊 As-Is: Excel / スプレッドシートの場合

```
┌─────────────────────────────────────────────────────────────────────────┐
│  手順: 12ファイルを手作業で結合                                         │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   📁 1月.xlsx    📁 2月.xlsx    📁 3月.xlsx   ...   📁 12月.xlsx        │ 
│       │              │              │                   │               │
│       └──────────────┴──────────────┴───────────────────┘               │
│                              │                                          │
│                              ▼                                         │
│                     ┌────────────────────┐                              │
│                     │  1. ファイルを開く │                              │
│                     │  2. 範囲を選択     │  ← 12回繰り返し 😰          │
│                     │  3. コピー         │                              │
│                     │  4. 貼り付け       │                              │
│                     └────────────────────┘                              │
│                              │                                          │
│                              ▼                                         │
│              ┌─────────────────────────────────┐                        │
│              │  集計.xlsx                      │                        │
│              ├──────┬──────┬──────┬────────────┤                        │
│              │ 日付 │ 商品 │ 金額 │  =SUM(C:C) │ ← 関数を手入力        │
│              ├──────┼──────┼──────┼────────────┤                        │
│              │ 1/1  │  A   │ 100  │            │                        │
│              │ 1/2  │  B   │ 200  │            │                        │
│              │ ...  │  ... │ ...  │            │                        │
│              └──────┴──────┴──────┴────────────┘                        │
│                                                                         │
│   ⏰ 作業時間: 30分〜1時間                                              │
│   😰 問題: ファイルが増えるたびに同じ作業が必要                         │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

#### 🐍 To-Be: Python の場合

```
┌─────────────────────────────────────────────────────────────────────────┐
│  手順: コード実行で自動結合                                             │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   📁 1月.xlsx    📁 2月.xlsx    📁 3月.xlsx   ...   📁 12月.xlsx        │
│       │              │              │                   │               │
│       └──────────────┴──────────────┴───────────────────┘               │
│                              │                                          │
│                              ▼                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  # すべてのファイルを読み込んで結合                             │   │
│   │  import pandas as pd                                            │   │
│   │  import glob                                                    │   │
│   │                                                                 │   │
│   │  files = glob.glob("*.xlsx")        # 全ファイル取得            │   │
│   │  df = pd.concat([pd.read_excel(f) for f in files])  # 一括結合  │   │
│   │  total = df["金額"].sum()           # 合計を計算                │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                              │                                          │
│                              ▼  一瞬で完了！                           │
│              ┌─────────────────────────────────┐                        │
│              │  結果: total = 1,234,567 円     │                        │
│              └─────────────────────────────────┘                        │
│                                                                         │
│   ⏰ 作業時間: 数秒                                                     │
│   😊 利点: ファイルが増えても同じコードで対応可能                       │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

### 例2: 条件に合うデータの抽出

**シナリオ**: 売上データから「東京支店」かつ「100万円以上」のデータだけ抽出したい

#### 📊 As-Is: Excel / スプレッドシートの場合

```
┌─────────────────────────────────────────────────────────────────────────┐
│  手順: フィルター機能を使って手動抽出                                   │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌───────────────────────────────────────────────────────────┐         │
│   │  売上データ.xlsx                                          │         │
│   ├───────┬────────┬──────────┬───────────────────────────────┤         │
│   │ 支店  │  商品  │   金額   │                               │         │
│   ├───────┼────────┼──────────┤  ① [データ] → [フィルター]  │         │
│   │ 東京  │   A    │ 1,500,000│                               │         │
│   │ 大阪  │   B    │   800,000│  ② 支店列で「東京」を選択    │         │
│   │ 東京  │   C    │   500,000│                               │         │
│   │ 名古屋│   A    │ 1,200,000│  ③ 金額列で「100万以上」設定 │         │
│   │ 東京  │   B    │ 2,000,000│     └→ ユーザー設定フィルター│         │
│   │  ...  │  ...   │   ...    │        └→ 条件入力...        │         │
│   └───────┴────────┴──────────┴───────────────────────────────┘         │
│                                                                         │
│   😰 問題点:                                                            │
│   • 条件が複雑になると設定が面倒                                        │
│   • 毎回同じフィルター操作を繰り返す必要がある                          │
│   • 条件を変えるたびに手動でやり直し                                    │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

#### 🐍 To-Be: Python の場合

```
┌─────────────────────────────────────────────────────────────────────────┐
│  手順: 1行のコードで条件抽出                                            │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  # 条件に合うデータを抽出                                       │   │
│   │  result = df[(df["支店"] == "東京") & (df["金額"] >= 1000000)]  │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                              │                                          │
│                              ▼                                         │
│   ┌─────────────────────────────────────────────────────────┐           │
│   │  抽出結果                                               │           │
│   ├───────┬────────┬──────────┐                             │           │
│   │ 支店  │  商品  │   金額   │  ← 条件に合う行だけ自動抽出│           │
│   ├───────┼────────┼──────────┤                             │           │
│   │ 東京  │   A    │ 1,500,000│                             │           │
│   │ 東京  │   B    │ 2,000,000│                             │           │
│   └───────┴────────┴──────────┘                             │           │
│                                                                         │
│   😊 利点:                                                              │
│   • 複雑な条件も1行で表現できる                                         │
│   • 条件を変数にすれば、簡単に条件変更可能                              │
│   • コードを保存しておけば、いつでも同じ抽出ができる                    │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

### 例3: グラフの作成と更新

**シナリオ**: 月次売上の推移グラフを作成し、毎月更新したい

#### 📊 As-Is: Excel / スプレッドシートの場合

```
┌─────────────────────────────────────────────────────────────────────────┐
│  手順: グラフを手動で作成・調整                                         │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ① データ範囲を選択                                                   │
│   ② [挿入] → [グラフ] → [折れ線グラフ]                               │
│   ③ グラフタイトル、軸ラベルを手入力                                   │
│   ④ 色、フォント、サイズを調整                                         │
│                                                                         │
│   ┌────────────────────────────────────┐                                │
│   │  月次売上推移        [グラフ]      │                                │
│   │                         ╱╲         │                                │
│   │  (万円)            ╱╲  ╱  ╲        │                                │
│   │    │          ╱╲  ╱  ╲╱    ╲       │                                │
│   │    │      ╱╲ ╱  ╲╱                 │                                │
│   │    │  ╱╲ ╱  ╲                      │                                │
│   │    │ ╱  ╲                          │                                │
│   │    └───────────────────────→ (月) │                                │
│   │      1  2  3  4  5  6  7  8        │                                │
│   └────────────────────────────────────┘                                │
│                                                                         │
│   😰 毎月の更新作業:                                                    │
│   • 新しいデータを追加                                                  │
│   • グラフの範囲を手動で拡張                                            │
│   • 軸の範囲を調整し直す                                                │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

#### 🐍 To-Be: Python の場合

```
┌─────────────────────────────────────────────────────────────────────────┐
│  手順: コードを実行するだけで最新グラフが完成                           │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  import matplotlib.pyplot as plt                                │   │
│   │                                                                 │   │
│   │  # データ読み込み（最新データが自動反映）                       │   │
│   │  df = pd.read_excel("売上データ.xlsx")                          │   │
│   │                                                                 │   │
│   │  # グラフ作成（設定は保存済み）                                 │   │
│   │  plt.figure(figsize=(10, 6))                                    │   │
│   │  plt.plot(df["月"], df["売上"], marker="o")                     │   │
│   │  plt.title("月次売上推移")                                      │   │
│   │  plt.xlabel("月")                                               │   │
│   │  plt.ylabel("売上（万円）")                                     │   │
│   │  plt.savefig("売上グラフ.png")  # 画像として保存                │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                              │                                          │
│                              ▼  実行ボタンを押すだけ！                 │
│   ┌────────────────────────────────────┐                                │
│   │  売上グラフ.png      [自動生成]    │                                │
│   │                         ╱╲         │                                │
│   │  (万円)            ╱╲  ╱  ╲   ●   │ ← 新しいデータも自動反映      │
│   │    │          ╱╲  ╱  ╲╱    ╲ ╱     │                                │
│   │    │      ╱╲ ╱  ╲╱          ●     │                                │
│   │    │  ╱╲ ╱  ╲                      │                                │
│   │    │ ╱  ╲                          │                                │
│   │    └───────────────────────→ (月) │                                │
│   │      1  2  3  4  5  6  7  8  9 10  │                                │
│   └────────────────────────────────────┘                                │
│                                                                         │
│   😊 利点:                                                              │
│   • データを更新してコード実行するだけで最新グラフが完成                │
│   • グラフのスタイル設定を再利用できる                                  │
│   • 複数のグラフを一括生成することも可能                                │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 🗺️ 学習のロードマップ

本教材を通じて、以下のスキルを段階的に習得します。
各章で「できるようになること」を具体例で示します。

---

### 📘 CH1-3: Python 基礎（変数・制御構文・関数）

プログラミングの基本を理解し、簡単な自動処理が書けるようになる。

```
┌─────────────────────────────────────────────────────────────────────────┐
│  📝 学習後にできること: データの繰り返し処理                            │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   Excel での作業:                                                       │
│   ┌──────┬─────────┐                                                    │
│   │ 単価 │  税込   │                                                    │
│   ├──────┼─────────┤   ← 各行に =A2*1.1 と入力して                     │
│   │ 100  │ =A2*1.1 │     下までコピー...                                │
│   │ 200  │ =A3*1.1 │                                                    │
│   │ 300  │ =A4*1.1 │                                                    │
│   └──────┴─────────┘                                                    │
│                                                                         │
│   Python での記述:                                                      │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  prices = [100, 200, 300]                                       │   │
│   │  tax_included = []                                              │   │
│   │  for price in prices:           # 繰り返し処理                  │   │
│   │      tax_included.append(price * 1.1)                           │   │
│   │  print(tax_included)  # → [110.0, 220.0, 330.0]                │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   💡 ポイント: 何行あっても同じコードで処理できる！                     │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

### 📘 CH4: NumPy 入門

大量の数値データを高速に計算できるようになる。

```
┌─────────────────────────────────────────────────────────────────────────┐
│  📝 学習後にできること: 配列の一括計算                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   Excel での作業:                                                       │
│   ┌─────┬─────┬─────────────┐                                           │
│   │  A  │  B  │   C (=A+B)  │  ← 列ごとに計算式を入力                  │
│   ├─────┼─────┼─────────────┤                                           │
│   │  1  │  4  │  =A2+B2     │                                           │
│   │  2  │  5  │  =A3+B3     │                                           │
│   │  3  │  6  │  =A4+B4     │                                           │
│   └─────┴─────┴─────────────┘                                           │
│                                                                         │
│   NumPy での記述:                                                       │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  import numpy as np                                             │   │
│   │                                                                 │   │
│   │  a = np.array([1, 2, 3])                                        │   │
│   │  b = np.array([4, 5, 6])                                        │   │
│   │  c = a + b                  # 配列同士を一括計算！              │   │
│   │  print(c)  # → [5 7 9]                                         │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   💡 ポイント: 100万行でも一瞬で計算完了！                              │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

### 📘 CH5-6: Pandas 入門・応用

Excel のような表データを自在に操れるようになる。

```
┌─────────────────────────────────────────────────────────────────────────┐
│  📝 学習後にできること: グループ別集計                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   Excel での作業:                                                       │
│   ┌───────┬────────┐                                                    │
│   │ 支店  │  売上  │    ① ピボットテーブルを挿入                       │
│   ├───────┼────────┤    ② 行に「支店」をドラッグ                       │
│   │ 東京  │  100   │    ③ 値に「売上」をドラッグ                       │
│   │ 大阪  │  200   │    ④ 集計方法を「合計」に設定                     │
│   │ 東京  │  150   │                                                    │
│   │ 大阪  │  180   │    → 手順が多い...                                │
│   └───────┴────────┘                                                    │
│                                                                         │
│   Pandas での記述:                                                      │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  # 支店ごとの売上合計を計算                                     │   │
│   │  result = df.groupby("支店")["売上"].sum()                      │   │
│   │                                                                 │   │
│   │  # 結果                                                         │   │
│   │  # 支店                                                         │   │
│   │  # 大阪    380                                                  │   │
│   │  # 東京    250                                                  │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   💡 ポイント: 1行で複雑な集計ができる！                                │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

### 📘 CH7: Matplotlib 入門

分析結果をグラフで可視化できるようになる。

```
┌─────────────────────────────────────────────────────────────────────────┐
│  📝 学習後にできること: コードでグラフ作成                              │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   Excel での作業:                                                       │
│   [挿入] → [グラフ] → 種類選択 → タイトル入力 → 軸設定 → 色調整... │
│                                                                         │
│   Matplotlib での記述:                                                  │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  import matplotlib.pyplot as plt                                │   │
│   │                                                                 │   │
│   │  months = ["1月", "2月", "3月", "4月", "5月"]                   │   │
│   │  sales = [120, 150, 180, 160, 200]                              │   │
│   │                                                                 │   │
│   │  plt.bar(months, sales)         # 棒グラフ作成                  │   │
│   │  plt.title("月別売上")          # タイトル設定                  │   │
│   │  plt.ylabel("売上（万円）")     # Y軸ラベル                     │   │
│   │  plt.show()                     # グラフ表示                    │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                              │                                          │
│                              ▼                                         │
│   ┌─────────────────────────────────────────────────────────┐           │
│   │  月別売上                                               │           │
│   │                                              ┌───┐      │           │
│   │                              ┌───┐           │   │      │           │
│   │                  ┌───┐       │   │   ┌───┐   │   │      │           │
│   │      ┌───┐       │   │       │   │   │   │   │   │      │           │
│   │      │   │       │   │       │   │   │   │   │   │      │           │
│   │  ────┴───┴───────┴───┴───────┴───┴───┴───┴───┴───┴────  │           │
│   │       1月        2月         3月     4月     5月        │           │
│   └─────────────────────────────────────────────────────────┘           │
│                                                                         │
│   💡 ポイント: コードを保存すれば、毎月同じグラフを自動生成！           │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

### 📘 CH8: 総合演習

学んだ技術を組み合わせて、実際のデータ分析プロジェクトに挑戦。

```
┌─────────────────────────────────────────────────────────────────────────┐
│  📝 総合演習でできること: データ分析の一連の流れを実践                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────┐      ┌────────────┐      ┌─────────┐      ┌─────────┐     │
│   │ データ  │ ──→ │  加工      │ ──→ │  集計   │ ──→ │ 可視化  │     │
│   │ 読込み  │      │クリーニング│      │  分析   │      │ グラフ  │     │
│   └─────────┘      └────────────┘      └─────────┘      └─────────┘     │
│                                                                         │
│   例: 売上データ分析レポートの自動作成                                  │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  # 1. データ読み込み                                            │   │
│   │  df = pd.read_csv("sales_2024.csv")                             │   │
│   │                                                                 │   │
│   │  # 2. データクリーニング                                        │   │
│   │  df = df.dropna()  # 欠損値を除去                               │   │
│   │                                                                 │   │
│   │  # 3. 月別・支店別の売上集計                                    │   │
│   │  summary = df.groupby(["月", "支店"])["売上"].sum()             │   │
│   │                                                                 │   │
│   │  # 4. グラフで可視化                                            │   │
│   │  summary.plot(kind="bar")                                       │   │
│   │  plt.savefig("monthly_report.png")                              │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   💡 ゴール: この一連の流れを自分で書けるようになる！                   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 💪 さあ、始めましょう！

Python を学ぶことで、データ処理の可能性が大きく広がります。
Excel では難しかった作業も、Python なら効率的に実現できます。

最初は難しく感じるかもしれませんが、一歩ずつ進めば必ず習得できます。
AI エージェントがあなたの学習をサポートしますので、安心して学習を始めてください。

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│     🚀 次のステップ: overview.md を読んで学習を始めましょう！   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```
