# CH3: Python 関数とモジュール - 学習の動機づけ

## 🎯 なぜ関数とモジュールを学ぶのか？

同じような処理を何度も書いていませんか？
「この計算、前にも書いたな...」と思ったことはありませんか？

関数とモジュールを学ぶことで、**コードを部品化して再利用** できるようになります。
また、世界中の開発者が作った便利なツールを活用できるようになります。

```
┌──────────────────────────────────────────────────────────────────┐
│              関数とモジュールを学ぶ目的                          │
├──────────────────────────────────────────────────────────────────┤
│                                                                  │
│   📦 コードを部品化      →  同じ処理を何度も書かなくてよい      │
│                                                                  │
│   🔧 メンテナンスが楽    →  修正は1箇所だけで全体に反映         │
│                                                                  │
│   📚 便利な道具を活用    →  NumPy, Pandas など強力なツールを使う│
│                                                                  │
│   🤝 他の人と共有しやすい →  関数名で処理内容がわかる           │
│                                                                  │
└──────────────────────────────────────────────────────────────────┘
```

---

## 🔑 この章を学ぶための前提条件

```
┌─────────────────────────────────────────────────────────────────┐
│                      学習の前提条件                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ✅ 条件 1: CH1-CH2 の内容を理解している                        │
│     ─────────────────────────────────────────────────           │
│     • 変数・データ型・演算ができる                              │
│     • if 文で条件分岐ができる                                   │
│     • for/while 文で繰り返しができる                            │
│                                                                 │
│  ✅ 条件 2: Excel の関数を使った経験がある                      │
│     ─────────────────────────────────────────────────           │
│     • SUM(), AVERAGE(), IF() などを使ったことがある             │
│     • 「関数に値を渡すと結果が返ってくる」感覚がある            │
│                                                                 │
│  ✅ 条件 3: 「同じ作業を繰り返したくない」と思っている          │
│     ─────────────────────────────────────────────────           │
│     • 効率化への意欲がある                                      │
│     • 便利なツールを使いたい                                    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🔄 この章を学ぶと何が変わるのか？（As-Is / To-Be 比較）

### 変化1: 同じ処理を繰り返し書かなくてよくなる

**シナリオ**: 税込価格の計算を複数箇所で行いたい

```
┌─────────────────────────────────────────────────────────────────────────┐
│  😰 As-Is: 関数を使わない場合                                           │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  # 商品Aの税込価格                                              │   │
│   │  price_a = 1000                                                 │   │
│   │  tax_a = price_a * 0.1                                          │   │
│   │  total_a = price_a + tax_a                                      │   │
│   │                                                                 │   │
│   │  # 商品Bの税込価格（同じ処理を再度書く...）                     │   │
│   │  price_b = 2000                                                 │   │
│   │  tax_b = price_b * 0.1                                          │   │
│   │  total_b = price_b + tax_b                                      │   │
│   │                                                                 │   │
│   │  # 商品Cの税込価格（また同じ処理...）                           │   │
│   │  price_c = 1500                                                 │   │
│   │  tax_c = price_c * 0.1                                          │   │
│   │  total_c = price_c + tax_c                                      │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   😰 問題点:                                                            │
│   • 同じ計算を3回書いている（コピペ地獄）                               │
│   • 税率が変わったら3箇所を修正しなければならない                       │
│   • 修正漏れでバグが発生しやすい                                        │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│  😊 To-Be: 関数を使う場合                                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  # 税込価格を計算する関数を定義（1回だけ）                      │   │
│   │  def calc_tax_included(price):                                  │   │
│   │      tax = price * 0.1                                          │   │
│   │      return price + tax                                         │   │
│   │                                                                 │   │
│   │  # 関数を呼び出すだけ！                                         │   │
│   │  total_a = calc_tax_included(1000)  # → 1100                   │   │
│   │  total_b = calc_tax_included(2000)  # → 2200                   │   │
│   │  total_c = calc_tax_included(1500)  # → 1650                   │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   😊 利点:                                                              │
│   • 処理は1箇所に集約（DRY原則: Don't Repeat Yourself）                 │
│   • 税率変更は関数内の1箇所を修正するだけ                               │
│   • コードが短く、読みやすい                                            │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

### 変化2: Excel 関数と同じ感覚で使える

**シナリオ**: 関数の使い方を比較
```
┌─────────────────────────────────────────────────────────────────────────┐
│  📊 Excel の関数と Python の関数の対比                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   Excel の場合:                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │                                                                 │   │
│   │   =SUM(A1:A5)         ← 関数名(引数) で呼び出す                │   │
│   │      │    │                                                     │   │
│   │      │    └── 引数: 計算対象のセル範囲                          │   │
│   │      └─────── 関数名: 合計を計算                                │   │
│   │                                                                 │   │
│   │   =ROUND(B1, 2)       ← 複数の引数をカンマで区切る             │   │
│   │         │   │                                                   │   │
│   │         │   └── 第2引数: 小数点以下の桁数                       │   │
│   │         └────── 第1引数: 丸める数値                             │   │
│   │                                                                 │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   Python の場合:                                                        │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │                                                                 │   │
│   │   sum([10, 20, 30])   ← 関数名(引数) で呼び出す                │   │
│   │    │       │                                                    │   │
│   │    │       └── 引数: 合計したいリスト                           │   │
│   │    └────────── 関数名: 合計を計算                               │   │
│   │                                                                 │   │
│   │   round(3.14159, 2)   ← 複数の引数をカンマで区切る             │   │
│   │         │        │                                              │   │
│   │         │        └── 第2引数: 小数点以下の桁数                  │   │
│   │         └─────────── 第1引数: 丸める数値                        │   │
│   │                                                                 │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   💡 ポイント: Excel の関数を使ったことがあれば、                       │
│              Python の関数も同じ感覚で使える！                          │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

### 変化3: 世界中の便利なツールが使えるようになる

**シナリオ**: 複雑な計算や処理を行いたい

```
┌─────────────────────────────────────────────────────────────────────────┐
│  😰 As-Is: 全部自分で書く場合                                           │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   やりたいこと:                                                         │
│   • 平方根を計算したい                                                  │
│   • ランダムな数を生成したい                                            │
│   • 今日の日付を取得したい                                              │
│   • 大量データを高速に処理したい                                        │
│                                                                         │
│   😰 「全部自分で実装するの...？」                                      │
│   😰 「平方根の計算方法なんて知らない...」                              │
│   😰 「車輪の再発明（同じものを作り直す）は時間の無駄...」              │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│  😊 To-Be: モジュールを import する場合                                 │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  # 便利なモジュールを読み込む                                   │   │
│   │  import math           # 数学関数                               │   │
│   │  import random         # ランダム生成                           │   │
│   │  import datetime       # 日付・時刻                             │   │
│   │                                                                 │   │
│   │  # すぐに使える！                                               │   │
│   │  print(math.sqrt(16))           # → 4.0（平方根）              │   │
│   │  print(random.randint(1, 100))  # → 42（ランダムな整数）       │   │
│   │  print(datetime.date.today())   # → 2024-01-15（今日の日付）   │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   さらに、データ分析用の強力なライブラリも！                            │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  import numpy as np    # 高速な数値計算                         │   │
│   │  import pandas as pd   # データ操作                             │   │
│   │  import matplotlib.pyplot as plt  # グラフ作成                  │   │
│   │                                                                 │   │
│   │  # これらを使えば、データ分析が簡単に！                         │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   😊 利点:                                                              │
│   • 世界中の開発者が作った高品質なコードを利用できる                    │
│   • 自分で実装する必要がない（時間節約）                                │
│   • NumPy, Pandas を使う準備が整う                                      │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 📚 この章で学ぶ内容

```
┌─────────────────────────────────────────────────────────────────────────┐
│                       CH3 の学習内容                                    │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  Section 1: 関数の基本                                                  │
│  ────────────────────────────                                           │
│  • 関数を定義して呼び出す方法                                           │
│                                                                         │
│      ┌────────────────────────────────────────────────────────────┐     │
│      │  def greet(name):            # 関数を定義                  │     │
│      │      return "こんにちは、" + name + "さん"                 │     │
│      │                                                            │     │
│      │  message = greet("田中")     # 関数を呼び出す              │     │
│      │  print(message)              # → こんにちは、田中さん     │     │
│      └────────────────────────────────────────────────────────────┘     │
│                                                                         │
│  ─────────────────────────────────────────────────────────────────────  │
│                                                                         │
│  Section 2: 関数の応用                                                  │
│  ────────────────────────────                                           │
│  • より柔軟な関数の書き方                                               │
│                                                                         │
│      ┌────────────────────────────────────────────────────────────┐     │
│      │  # デフォルト引数: 引数を省略可能にする                    │     │
│      │  def greet(name, greeting="こんにちは"):                   │     │
│      │      return greeting + "、" + name + "さん"                │     │
│      │                                                            │     │
│      │  print(greet("田中"))             # → こんにちは、田中さん│     │
│      │  print(greet("田中", "おはよう")) # → おはよう、田中さん  │     │
│      └────────────────────────────────────────────────────────────┘     │
│                                                                         │
│  ─────────────────────────────────────────────────────────────────────  │
│                                                                         │
│  Section 3: モジュールとパッケージ                                      │
│  ────────────────────────────                                           │
│  • 外部のコードを読み込んで使う方法                                     │
│                                                                         │
│      ┌────────────────────────────────────────────────────────────┐     │
│      │  import math                 # モジュールを読み込む        │     │
│      │                                                            │     │
│      │  print(math.pi)              # → 3.141592653589793        │     │
│      │  print(math.sqrt(2))         # → 1.4142135623730951       │     │
│      └────────────────────────────────────────────────────────────┘     │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 🏁 この章のゴール

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        CH3 修了時の姿                                   │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  # この章を修了すると、このコードが「書ける」ようになります     │   │
│   │                                                                 │   │
│   │  import math                                                    │   │
│   │                                                                 │   │
│   │  # 商品の合計金額を計算する関数                                 │   │
│   │  def calc_total(price, quantity, tax_rate=0.1):                 │   │
│   │      """税込合計金額を計算する"""                               │   │
│   │      subtotal = price * quantity                                │   │
│   │      tax = subtotal * tax_rate                                  │   │
│   │      return math.floor(subtotal + tax)  # 小数点以下切り捨て    │   │
│   │                                                                 │   │
│   │  # 関数を使って計算                                             │   │
│   │  items = [                                                      │   │
│   │      {"name": "りんご", "price": 150, "qty": 3},                │   │
│   │      {"name": "みかん", "price": 80, "qty": 5},                 │   │
│   │      {"name": "バナナ", "price": 200, "qty": 2},                │   │
│   │  ]                                                              │   │
│   │                                                                 │   │
│   │  grand_total = 0                                                │   │
│   │  for item in items:                                             │   │
│   │      total = calc_total(item["price"], item["qty"])             │   │
│   │      print(f"{item['name']}: {total}円")                        │   │
│   │      grand_total += total                                       │   │
│   │                                                                 │   │
│   │  print(f"合計: {grand_total}円")                                │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   出力:                                                                 │
│   ┌─────────────────────────────────────────┐                           │
│   │  りんご: 495円                          │                           │
│   │  みかん: 440円                          │                           │
│   │  バナナ: 440円                          │                           │
│   │  合計: 1375円                           │                           │
│   └─────────────────────────────────────────┘                           │
│                                                                         │
│   💡 関数 + モジュール + 制御構文の組み合わせで実用的なコードが書ける！ │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 🚀 この章が終わると...

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     データ分析への扉が開く！                            │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   CH1-CH3 で学んだこと:                                                 │
│                                                                         │
│   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐                   │
│   │   CH1       │   │   CH2       │   │   CH3       │                   │
│   │  変数・型   │ + │  制御構文   │ + │ 関数・import│                   │
│   │   演算      │   │ if/for/while│   │ モジュール  │                   │
│   └─────────────┘   └─────────────┘   └─────────────┘                   │
│         │                 │                 │                           │
│         └─────────────────┴─────────────────┘                           │
│                           │                                             │
│                           ▼                                            │
│              ┌───────────────────────────┐                              │
│              │   Python の基礎完成！     │                              │
│              │   データ分析の準備 OK！   │                              │
│              └───────────────────────────┘                              │
│                           │                                             │
│                           ▼                                            │
│   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                 │
│   │   CH4       │    │  CH5-CH6    │    │   CH7       │                 │
│   │   NumPy     │ → │   Pandas    │ → │ Matplotlib  │                 │
│   │  数値計算   │    │ データ操作  │    │  可視化     │                 │
│   └─────────────┘    └─────────────┘    └─────────────┘                 │
│                                                                         │
│   💡 import ができれば、これらのライブラリがすぐに使える！              │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 💪 さあ、始めましょう！

関数とモジュールを学べば、「コードを効率的に書く」技術が身につきます。
そして、いよいよ次の章からはデータ分析ライブラリの世界に入ります。

この章は Python 基礎の総仕上げです。しっかりマスターしましょう！

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│     🚀 次のステップ: ch-overview.md で章の全体像を確認！        │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```
