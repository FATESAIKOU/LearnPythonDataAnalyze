# Section2: ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›ã¨åŠ å·¥ - å¿œç”¨å•é¡Œ

## ğŸ¯ ã“ã®å¿œç”¨å•é¡Œã®ç›®çš„

å®Ÿéš›ã®ãƒ“ã‚¸ãƒã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’æƒ³å®šã—ã€
è¤‡åˆçš„ãªãƒ‡ãƒ¼ã‚¿å¤‰æ›ãƒ»åŠ å·¥ä½œæ¥­ã‚’é€šã˜ã¦å®Ÿè·µåŠ›ã‚’é¤Šã„ã¾ã™ã€‚

---

## ğŸš€ å¿œç”¨å•é¡Œ1: ECã‚µã‚¤ãƒˆã®æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿åŠ å·¥

### å•é¡Œ

ä»¥ä¸‹ã®ECã‚µã‚¤ãƒˆã®æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿ã‚’ã€åˆ†æã—ã‚„ã™ã„å½¢ã«åŠ å·¥ã—ã¦ãã ã•ã„ã€‚

```python
import pandas as pd

df = pd.DataFrame({
    "order_id": ["ORD001", "ORD002", "ORD003", "ORD004", "ORD005"],
    "customer_name": ["  TANAKA  ", "sato", "SUZUKI", "  yamada", "ITO  "],
    "product_code": ["P001", "P002", "P001", "P003", "P002"],
    "quantity": [2, 1, 3, 2, 1],
    "unit_price": [1500, 3000, 1500, 800, 3000],
    "status_code": [1, 2, 1, 3, 2],
    "payment_type": ["C", "B", "C", "C", "B"]
})
```

å¤‰æ›è¦ä»¶ï¼š
1. åˆ—åã‚’æ—¥æœ¬èªã«å¤‰æ›
2. é¡§å®¢åã‚’æ•´å½¢ï¼ˆç©ºç™½å‰Šé™¤ã€å…ˆé ­å¤§æ–‡å­—ï¼‰
3. ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’æ—¥æœ¬èªã«å¤‰æ›ï¼ˆ1â†’æ³¨æ–‡ç¢ºå®šã€2â†’ç™ºé€æ¸ˆã¿ã€3â†’é…é”å®Œäº†ï¼‰
4. æ”¯æ‰•ã„æ–¹æ³•ã‚’æ—¥æœ¬èªã«å¤‰æ›ï¼ˆCâ†’ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã€Bâ†’éŠ€è¡ŒæŒ¯è¾¼ï¼‰
5. å£²ä¸Šåˆ—ã‚’è¿½åŠ ï¼ˆæ•°é‡ Ã— å˜ä¾¡ï¼‰
6. å£²ä¸Šãƒ©ãƒ³ã‚¯ã‚’è¿½åŠ ï¼ˆ5000å††ä»¥ä¸Šâ†’Aã€3000å††ä»¥ä¸Šâ†’Bã€ãã‚Œä»¥å¤–â†’Cï¼‰

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

### åŸºæœ¬è§£æ³•ï¼ˆã‚¹ãƒ†ãƒƒãƒ—ã”ã¨ã«å‡¦ç†ï¼‰

```python
import pandas as pd

df = pd.DataFrame({
    "order_id": ["ORD001", "ORD002", "ORD003", "ORD004", "ORD005"],
    "customer_name": ["  TANAKA  ", "sato", "SUZUKI", "  yamada", "ITO  "],
    "product_code": ["P001", "P002", "P001", "P003", "P002"],
    "quantity": [2, 1, 3, 2, 1],
    "unit_price": [1500, 3000, 1500, 800, 3000],
    "status_code": [1, 2, 1, 3, 2],
    "payment_type": ["C", "B", "C", "C", "B"]
})

print("=== å¤‰æ›å‰ ===")
print(df)
print()

# ===== 1. åˆ—åã‚’æ—¥æœ¬èªã«å¤‰æ› =====

column_names = {
    "order_id": "æ³¨æ–‡ID",
    "customer_name": "é¡§å®¢å",
    "product_code": "å•†å“ã‚³ãƒ¼ãƒ‰",
    "quantity": "æ•°é‡",
    "unit_price": "å˜ä¾¡",
    "status_code": "ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹",
    "payment_type": "æ”¯æ‰•æ–¹æ³•"
}

# åŸºæœ¬è§£æ³•ï¼šæ–°ã—ã„åˆ—åãƒªã‚¹ãƒˆã‚’ä½œæˆ
new_columns = []
for col in df.columns:
    if col in column_names:
        new_columns.append(column_names[col])
    else:
        new_columns.append(col)

df.columns = new_columns

print("=== 1. åˆ—åã‚’æ—¥æœ¬èªã« ===")
print(df.columns.tolist())
print()

# ===== 2. é¡§å®¢åã‚’æ•´å½¢ =====

# åŸºæœ¬è§£æ³•ï¼šãƒ«ãƒ¼ãƒ—ã§å‡¦ç†
formatted_names = []
for i in range(len(df)):
    name = df.iloc[i]["é¡§å®¢å"]
    # ç©ºç™½å‰Šé™¤ã—ã¦å°æ–‡å­—ã«å¤‰æ›å¾Œã€å…ˆé ­ã‚’å¤§æ–‡å­—ã«
    name = name.strip().lower()
    name = name[0].upper() + name[1:]  # å…ˆé ­å¤§æ–‡å­—
    formatted_names.append(name)

df["é¡§å®¢å"] = formatted_names

print("=== 2. é¡§å®¢åã‚’æ•´å½¢ ===")
print(df["é¡§å®¢å"])
print()

# ===== 3. ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’æ—¥æœ¬èªã«å¤‰æ› =====

status_map = {1: "æ³¨æ–‡ç¢ºå®š", 2: "ç™ºé€æ¸ˆã¿", 3: "é…é”å®Œäº†"}

converted_status = []
for i in range(len(df)):
    code = df.iloc[i]["ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹"]
    if code in status_map:
        converted_status.append(status_map[code])
    else:
        converted_status.append("ä¸æ˜")

df["ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹"] = converted_status

print("=== 3. ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ—¥æœ¬èªã« ===")
print(df["ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹"])
print()

# ===== 4. æ”¯æ‰•ã„æ–¹æ³•ã‚’æ—¥æœ¬èªã«å¤‰æ› =====

payment_map = {"C": "ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ", "B": "éŠ€è¡ŒæŒ¯è¾¼"}

converted_payment = []
for i in range(len(df)):
    code = df.iloc[i]["æ”¯æ‰•æ–¹æ³•"]
    if code in payment_map:
        converted_payment.append(payment_map[code])
    else:
        converted_payment.append("ãã®ä»–")

df["æ”¯æ‰•æ–¹æ³•"] = converted_payment

print("=== 4. æ”¯æ‰•æ–¹æ³•ã‚’æ—¥æœ¬èªã« ===")
print(df["æ”¯æ‰•æ–¹æ³•"])
print()

# ===== 5. å£²ä¸Šåˆ—ã‚’è¿½åŠ  =====

sales = []
for i in range(len(df)):
    qty = df.iloc[i]["æ•°é‡"]
    price = df.iloc[i]["å˜ä¾¡"]
    sales.append(qty * price)

df["å£²ä¸Š"] = sales

print("=== 5. å£²ä¸Šåˆ—ã‚’è¿½åŠ  ===")
print(df[["æ•°é‡", "å˜ä¾¡", "å£²ä¸Š"]])
print()

# ===== 6. å£²ä¸Šãƒ©ãƒ³ã‚¯ã‚’è¿½åŠ  =====

ranks = []
for i in range(len(df)):
    sale = df.iloc[i]["å£²ä¸Š"]
    if sale >= 5000:
        ranks.append("A")
    elif sale >= 3000:
        ranks.append("B")
    else:
        ranks.append("C")

df["å£²ä¸Šãƒ©ãƒ³ã‚¯"] = ranks

print("=== å¤‰æ›å¾Œ ===")
print(df)
```

**å®Ÿè¡Œçµæœ:**
```
=== å¤‰æ›å‰ ===
  order_id customer_name product_code  quantity  unit_price  status_code payment_type
0   ORD001      TANAKA          P001         2        1500            1            C
1   ORD002          sato         P002         1        3000            2            B
2   ORD003       SUZUKI         P001         3        1500            1            C
3   ORD004      yamada         P003         2         800            3            C
4   ORD005         ITO          P002         1        3000            2            B

=== å¤‰æ›å¾Œ ===
    æ³¨æ–‡ID   é¡§å®¢å å•†å“ã‚³ãƒ¼ãƒ‰  æ•°é‡  å˜ä¾¡   ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹     æ”¯æ‰•æ–¹æ³•   å£²ä¸Š å£²ä¸Šãƒ©ãƒ³ã‚¯
0  ORD001  Tanaka       P001     2  1500     æ³¨æ–‡ç¢ºå®š   ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ   3000         B
1  ORD002    Sato       P002     1  3000     ç™ºé€æ¸ˆã¿     éŠ€è¡ŒæŒ¯è¾¼   3000         B
2  ORD003  Suzuki       P001     3  1500     æ³¨æ–‡ç¢ºå®š   ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ   4500         B
3  ORD004  Yamada       P003     2   800     é…é”å®Œäº†   ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ   1600         C
4  ORD005     Ito       P002     1  3000     ç™ºé€æ¸ˆã¿     éŠ€è¡ŒæŒ¯è¾¼   3000         B
```

---

### ç™ºå±•è§£æ³•ï¼ˆPandas ã®æ©Ÿèƒ½ã‚’æ´»ç”¨ï¼‰

```python
import pandas as pd

df = pd.DataFrame({
    "order_id": ["ORD001", "ORD002", "ORD003", "ORD004", "ORD005"],
    "customer_name": ["  TANAKA  ", "sato", "SUZUKI", "  yamada", "ITO  "],
    "product_code": ["P001", "P002", "P001", "P003", "P002"],
    "quantity": [2, 1, 3, 2, 1],
    "unit_price": [1500, 3000, 1500, 800, 3000],
    "status_code": [1, 2, 1, 3, 2],
    "payment_type": ["C", "B", "C", "C", "B"]
})

df_transformed = (df
    .rename(columns={
        "order_id": "æ³¨æ–‡ID", "customer_name": "é¡§å®¢å", "product_code": "å•†å“ã‚³ãƒ¼ãƒ‰",
        "quantity": "æ•°é‡", "unit_price": "å˜ä¾¡", "status_code": "ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹",
        "payment_type": "æ”¯æ‰•æ–¹æ³•"
    })
    .assign(é¡§å®¢å=lambda x: x["é¡§å®¢å"].str.strip().str.capitalize())
    .assign(ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹=lambda x: x["ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹"].replace({1: "æ³¨æ–‡ç¢ºå®š", 2: "ç™ºé€æ¸ˆã¿", 3: "é…é”å®Œäº†"}))
    .assign(æ”¯æ‰•æ–¹æ³•=lambda x: x["æ”¯æ‰•æ–¹æ³•"].replace({"C": "ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ", "B": "éŠ€è¡ŒæŒ¯è¾¼"}))
    .assign(å£²ä¸Š=lambda x: x["æ•°é‡"] * x["å˜ä¾¡"])
    .assign(å£²ä¸Šãƒ©ãƒ³ã‚¯=lambda x: pd.cut(x["å£²ä¸Š"], bins=[0, 3000, 5000, float("inf")], 
                                        labels=["C", "B", "A"], right=False))
)

print(df_transformed)
```

</details>

---

## ğŸš€ å¿œç”¨å•é¡Œ2: ç¤¾å“¡ãƒ‡ãƒ¼ã‚¿ã®åŠ å·¥ã¨åˆ†ææº–å‚™

### å•é¡Œ

ä»¥ä¸‹ã®ç¤¾å“¡ãƒ‡ãƒ¼ã‚¿ã‚’åŠ å·¥ã—ã¦ã€äººäº‹åˆ†æç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

```python
import pandas as pd

df = pd.DataFrame({
    "emp_id": ["E001", "E002", "E003", "E004", "E005", "E006"],
    "name": ["tanaka taro", "sato hanako", "suzuki ichiro", 
             "yamada jiro", "ito yuko", "nakamura ken"],
    "dept": ["sales", "DEV", "Sales", "hr", "DEV", "SALES"],
    "hire_year": [2018, 2020, 2015, 2019, 2021, 2017],
    "salary": [4500000, 5200000, 6800000, 4800000, 4200000, 5500000],
    "eval_score": [3.5, 4.2, 4.8, 3.8, 3.2, 4.0]
})
```

å¤‰æ›è¦ä»¶ï¼š
1. åˆ—åã‚’æ—¥æœ¬èªã«å¤‰æ›
2. åå‰ã‚’ã€Œå§“ã€ã¨ã€Œåã€ã«åˆ†å‰²ã—ã¦ã€ãã‚Œãã‚Œå…ˆé ­å¤§æ–‡å­—ã«
3. éƒ¨ç½²ã‚’å¤§æ–‡å­—ã«çµ±ä¸€
4. å‹¤ç¶šå¹´æ•°ã‚’è¨ˆç®—ï¼ˆ2024å¹´åŸºæº–ï¼‰
5. å¹´åã‚’ä¸‡å††å˜ä½ã«å¤‰æ›
6. è©•ä¾¡ãƒ©ãƒ³ã‚¯ã‚’è¿½åŠ ï¼ˆ4.5ä»¥ä¸Šâ†’Sã€4.0ä»¥ä¸Šâ†’Aã€3.5ä»¥ä¸Šâ†’Bã€ãã‚Œä»¥å¤–â†’Cï¼‰
7. å‹¤ç¶šå¹´æ•°ã‚«ãƒ†ã‚´ãƒªã‚’è¿½åŠ ï¼ˆ5å¹´ä»¥ä¸Šâ†’ãƒ™ãƒ†ãƒ©ãƒ³ã€3å¹´ä»¥ä¸Šâ†’ä¸­å …ã€ãã‚Œä»¥å¤–â†’è‹¥æ‰‹ï¼‰

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

### åŸºæœ¬è§£æ³•ï¼ˆã‚¹ãƒ†ãƒƒãƒ—ã”ã¨ã«å‡¦ç†ï¼‰

```python
import pandas as pd

df = pd.DataFrame({
    "emp_id": ["E001", "E002", "E003", "E004", "E005", "E006"],
    "name": ["tanaka taro", "sato hanako", "suzuki ichiro", 
             "yamada jiro", "ito yuko", "nakamura ken"],
    "dept": ["sales", "DEV", "Sales", "hr", "DEV", "SALES"],
    "hire_year": [2018, 2020, 2015, 2019, 2021, 2017],
    "salary": [4500000, 5200000, 6800000, 4800000, 4200000, 5500000],
    "eval_score": [3.5, 4.2, 4.8, 3.8, 3.2, 4.0]
})

print("=== å¤‰æ›å‰ ===")
print(df)
print()

# ===== 1. åˆ—åã‚’æ—¥æœ¬èªã«å¤‰æ› =====

df = df.rename(columns={
    "emp_id": "ç¤¾å“¡ID",
    "name": "æ°å",
    "dept": "éƒ¨ç½²",
    "hire_year": "å…¥ç¤¾å¹´",
    "salary": "å¹´å",
    "eval_score": "è©•ä¾¡ç‚¹"
})

print("=== 1. åˆ—åã‚’æ—¥æœ¬èªã« ===")
print(df.columns.tolist())
print()

# ===== 2. åå‰ã‚’ã€Œå§“ã€ã¨ã€Œåã€ã«åˆ†å‰² =====

last_names = []
first_names = []
for i in range(len(df)):
    full_name = df.iloc[i]["æ°å"]
    parts = full_name.split(" ")
    # å…ˆé ­å¤§æ–‡å­—ã«å¤‰æ›
    last_name = parts[0][0].upper() + parts[0][1:]
    first_name = parts[1][0].upper() + parts[1][1:]
    last_names.append(last_name)
    first_names.append(first_name)

df["å§“"] = last_names
df["å"] = first_names
df = df.drop(columns=["æ°å"])

print("=== 2. å§“ã¨åã«åˆ†å‰² ===")
print(df[["ç¤¾å“¡ID", "å§“", "å"]])
print()

# ===== 3. éƒ¨ç½²ã‚’å¤§æ–‡å­—ã«çµ±ä¸€ =====

upper_depts = []
for i in range(len(df)):
    dept = df.iloc[i]["éƒ¨ç½²"]
    upper_depts.append(dept.upper())

df["éƒ¨ç½²"] = upper_depts

print("=== 3. éƒ¨ç½²ã‚’å¤§æ–‡å­—ã« ===")
print(df["éƒ¨ç½²"].value_counts())
print()

# ===== 4. å‹¤ç¶šå¹´æ•°ã‚’è¨ˆç®—ï¼ˆ2024å¹´åŸºæº–ï¼‰=====

years_of_service = []
current_year = 2024
for i in range(len(df)):
    hire_year = df.iloc[i]["å…¥ç¤¾å¹´"]
    years = current_year - hire_year
    years_of_service.append(years)

df["å‹¤ç¶šå¹´æ•°"] = years_of_service

print("=== 4. å‹¤ç¶šå¹´æ•°ã‚’è¿½åŠ  ===")
print(df[["ç¤¾å“¡ID", "å…¥ç¤¾å¹´", "å‹¤ç¶šå¹´æ•°"]])
print()

# ===== 5. å¹´åã‚’ä¸‡å††å˜ä½ã«å¤‰æ› =====

salary_man = []
for i in range(len(df)):
    salary = df.iloc[i]["å¹´å"]
    salary_man.append(salary / 10000)

df["å¹´åï¼ˆä¸‡å††ï¼‰"] = salary_man
df = df.drop(columns=["å¹´å"])

print("=== 5. å¹´åã‚’ä¸‡å††ã« ===")
print(df[["ç¤¾å“¡ID", "å¹´åï¼ˆä¸‡å††ï¼‰"]])
print()

# ===== 6. è©•ä¾¡ãƒ©ãƒ³ã‚¯ã‚’è¿½åŠ  =====

eval_ranks = []
for i in range(len(df)):
    score = df.iloc[i]["è©•ä¾¡ç‚¹"]
    if score >= 4.5:
        eval_ranks.append("S")
    elif score >= 4.0:
        eval_ranks.append("A")
    elif score >= 3.5:
        eval_ranks.append("B")
    else:
        eval_ranks.append("C")

df["è©•ä¾¡ãƒ©ãƒ³ã‚¯"] = eval_ranks

print("=== 6. è©•ä¾¡ãƒ©ãƒ³ã‚¯ã‚’è¿½åŠ  ===")
print(df[["ç¤¾å“¡ID", "è©•ä¾¡ç‚¹", "è©•ä¾¡ãƒ©ãƒ³ã‚¯"]])
print()

# ===== 7. å‹¤ç¶šå¹´æ•°ã‚«ãƒ†ã‚´ãƒªã‚’è¿½åŠ  =====

tenure_categories = []
for i in range(len(df)):
    years = df.iloc[i]["å‹¤ç¶šå¹´æ•°"]
    if years >= 5:
        tenure_categories.append("ãƒ™ãƒ†ãƒ©ãƒ³")
    elif years >= 3:
        tenure_categories.append("ä¸­å …")
    else:
        tenure_categories.append("è‹¥æ‰‹")

df["å‹¤ç¶šã‚«ãƒ†ã‚´ãƒª"] = tenure_categories

print("=== å¤‰æ›å¾Œ ===")
print(df)
```

**å®Ÿè¡Œçµæœ:**
```
=== å¤‰æ›å¾Œ ===
  ç¤¾å“¡ID       å§“        å  éƒ¨ç½²  å…¥ç¤¾å¹´  è©•ä¾¡ç‚¹  å‹¤ç¶šå¹´æ•°  å¹´åï¼ˆä¸‡å††ï¼‰  è©•ä¾¡ãƒ©ãƒ³ã‚¯ å‹¤ç¶šã‚«ãƒ†ã‚´ãƒª
0   E001   Tanaka     Taro  SALES   2018     3.5         6        450.0          B     ãƒ™ãƒ†ãƒ©ãƒ³
1   E002     Sato   Hanako    DEV   2020     4.2         4        520.0          A       ä¸­å …
2   E003   Suzuki  Ichiro   SALES   2015     4.8         9        680.0          S     ãƒ™ãƒ†ãƒ©ãƒ³
3   E004   Yamada    Jiro      HR   2019     3.8         5        480.0          B     ãƒ™ãƒ†ãƒ©ãƒ³
4   E005      Ito    Yuko     DEV   2021     3.2         3        420.0          C       ä¸­å …
5   E006  Nakamura    Ken   SALES   2017     4.0         7        550.0          A     ãƒ™ãƒ†ãƒ©ãƒ³
```

---

### ç™ºå±•è§£æ³•ï¼ˆPandas ã®æ©Ÿèƒ½ã‚’æ´»ç”¨ï¼‰

```python
import pandas as pd

df = pd.DataFrame({
    "emp_id": ["E001", "E002", "E003", "E004", "E005", "E006"],
    "name": ["tanaka taro", "sato hanako", "suzuki ichiro", 
             "yamada jiro", "ito yuko", "nakamura ken"],
    "dept": ["sales", "DEV", "Sales", "hr", "DEV", "SALES"],
    "hire_year": [2018, 2020, 2015, 2019, 2021, 2017],
    "salary": [4500000, 5200000, 6800000, 4800000, 4200000, 5500000],
    "eval_score": [3.5, 4.2, 4.8, 3.8, 3.2, 4.0]
})

def get_eval_rank(score):
    if score >= 4.5: return "S"
    elif score >= 4.0: return "A"
    elif score >= 3.5: return "B"
    else: return "C"

df_transformed = (df
    .rename(columns={"emp_id": "ç¤¾å“¡ID", "dept": "éƒ¨ç½²", "hire_year": "å…¥ç¤¾å¹´", 
                     "salary": "å¹´å", "eval_score": "è©•ä¾¡ç‚¹"})
    .assign(å§“=lambda x: x["name"].str.split(" ").str[0].str.capitalize())
    .assign(å=lambda x: x["name"].str.split(" ").str[1].str.capitalize())
    .drop(columns=["name"])
    .assign(éƒ¨ç½²=lambda x: x["éƒ¨ç½²"].str.upper())
    .assign(å‹¤ç¶šå¹´æ•°=lambda x: 2024 - x["å…¥ç¤¾å¹´"])
    .assign(**{"å¹´åï¼ˆä¸‡å††ï¼‰": lambda x: x["å¹´å"] / 10000})
    .drop(columns=["å¹´å"])
    .assign(è©•ä¾¡ãƒ©ãƒ³ã‚¯=lambda x: x["è©•ä¾¡ç‚¹"].apply(get_eval_rank))
    .assign(å‹¤ç¶šã‚«ãƒ†ã‚´ãƒª=lambda x: pd.cut(x["å‹¤ç¶šå¹´æ•°"], bins=[0, 3, 5, 100], 
                                          labels=["è‹¥æ‰‹", "ä¸­å …", "ãƒ™ãƒ†ãƒ©ãƒ³"], right=False))
)

print(df_transformed)
```

</details>

---

## ğŸš€ å¿œç”¨å•é¡Œ3: å•†å“ãƒã‚¹ã‚¿ã®æ•´å‚™

### å•é¡Œ

ä»¥ä¸‹ã®å•†å“ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’æ•´å‚™ã—ã¦ãã ã•ã„ã€‚

```python
import pandas as pd

df = pd.DataFrame({
    "product_id": ["P001", "P002", "P003", "P004", "P005"],
    "product_name": ["  Apple iPhone 15  ", "samsung galaxy", "SONY XPERIA", 
                     "google Pixel", "  OPPO Reno  "],
    "category": ["smartphone", "SMARTPHONE", "SmartPhone", "smartphone", "Smartphone"],
    "price": [150000, 120000, 100000, 90000, 50000],
    "stock": [50, 30, 20, 100, 200],
    "release_year": [2023, 2023, 2022, 2023, 2022]
})
```

å¤‰æ›è¦ä»¶ï¼š
1. åˆ—åã‚’æ—¥æœ¬èªã«å¤‰æ›
2. å•†å“åã®ç©ºç™½ã‚’å‰Šé™¤
3. å•†å“åã‹ã‚‰ãƒ–ãƒ©ãƒ³ãƒ‰åã‚’æŠ½å‡ºã—ã¦æ–°ã—ã„åˆ—ã«
4. ã‚«ãƒ†ã‚´ãƒªã‚’çµ±ä¸€ï¼ˆã™ã¹ã¦ã€Œã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã€ã«ï¼‰
5. åœ¨åº«é‡‘é¡ã‚’è¨ˆç®—ï¼ˆä¾¡æ ¼ Ã— åœ¨åº«æ•°ï¼‰
6. ä¾¡æ ¼å¸¯ã‚’è¿½åŠ ï¼ˆ10ä¸‡å††ä»¥ä¸Šâ†’é«˜ä¾¡æ ¼å¸¯ã€5ä¸‡å††ä»¥ä¸Šâ†’ä¸­ä¾¡æ ¼å¸¯ã€ãã‚Œä»¥å¤–â†’ä½ä¾¡æ ¼å¸¯ï¼‰
7. åœ¨åº«çŠ¶æ³ã‚’è¿½åŠ ï¼ˆ100ä»¥ä¸Šâ†’æ½¤æ²¢ã€50ä»¥ä¸Šâ†’é©æ­£ã€ãã‚Œä»¥å¤–â†’è¦ç™ºæ³¨ï¼‰

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

### åŸºæœ¬è§£æ³•ï¼ˆã‚¹ãƒ†ãƒƒãƒ—ã”ã¨ã«å‡¦ç†ï¼‰

```python
import pandas as pd

df = pd.DataFrame({
    "product_id": ["P001", "P002", "P003", "P004", "P005"],
    "product_name": ["  Apple iPhone 15  ", "samsung galaxy", "SONY XPERIA", 
                     "google Pixel", "  OPPO Reno  "],
    "category": ["smartphone", "SMARTPHONE", "SmartPhone", "smartphone", "Smartphone"],
    "price": [150000, 120000, 100000, 90000, 50000],
    "stock": [50, 30, 20, 100, 200],
    "release_year": [2023, 2023, 2022, 2023, 2022]
})

print("=== å¤‰æ›å‰ ===")
print(df)
print()

# ===== 1. åˆ—åã‚’æ—¥æœ¬èªã«å¤‰æ› =====

df = df.rename(columns={
    "product_id": "å•†å“ID",
    "product_name": "å•†å“å",
    "category": "ã‚«ãƒ†ã‚´ãƒª",
    "price": "ä¾¡æ ¼",
    "stock": "åœ¨åº«æ•°",
    "release_year": "ç™ºå£²å¹´"
})

# ===== 2. å•†å“åã®ç©ºç™½ã‚’å‰Šé™¤ =====

cleaned_names = []
for i in range(len(df)):
    name = df.iloc[i]["å•†å“å"]
    cleaned_names.append(name.strip())

df["å•†å“å"] = cleaned_names

# ===== 3. å•†å“åã‹ã‚‰ãƒ–ãƒ©ãƒ³ãƒ‰åã‚’æŠ½å‡º =====

brands = []
for i in range(len(df)):
    name = df.iloc[i]["å•†å“å"]
    # æœ€åˆã®å˜èªã‚’ãƒ–ãƒ©ãƒ³ãƒ‰åã¨ã™ã‚‹
    brand = name.split(" ")[0]
    # å…ˆé ­å¤§æ–‡å­—ã«çµ±ä¸€
    brand = brand[0].upper() + brand[1:].lower()
    brands.append(brand)

df["ãƒ–ãƒ©ãƒ³ãƒ‰"] = brands

print("=== 3. ãƒ–ãƒ©ãƒ³ãƒ‰åã‚’æŠ½å‡º ===")
print(df[["å•†å“å", "ãƒ–ãƒ©ãƒ³ãƒ‰"]])
print()

# ===== 4. ã‚«ãƒ†ã‚´ãƒªã‚’çµ±ä¸€ =====

df["ã‚«ãƒ†ã‚´ãƒª"] = "ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³"

# ===== 5. åœ¨åº«é‡‘é¡ã‚’è¨ˆç®— =====

stock_values = []
for i in range(len(df)):
    price = df.iloc[i]["ä¾¡æ ¼"]
    stock = df.iloc[i]["åœ¨åº«æ•°"]
    stock_values.append(price * stock)

df["åœ¨åº«é‡‘é¡"] = stock_values

print("=== 5. åœ¨åº«é‡‘é¡ã‚’è¿½åŠ  ===")
print(df[["å•†å“ID", "ä¾¡æ ¼", "åœ¨åº«æ•°", "åœ¨åº«é‡‘é¡"]])
print()

# ===== 6. ä¾¡æ ¼å¸¯ã‚’è¿½åŠ  =====

price_ranges = []
for i in range(len(df)):
    price = df.iloc[i]["ä¾¡æ ¼"]
    if price >= 100000:
        price_ranges.append("é«˜ä¾¡æ ¼å¸¯")
    elif price >= 50000:
        price_ranges.append("ä¸­ä¾¡æ ¼å¸¯")
    else:
        price_ranges.append("ä½ä¾¡æ ¼å¸¯")

df["ä¾¡æ ¼å¸¯"] = price_ranges

# ===== 7. åœ¨åº«çŠ¶æ³ã‚’è¿½åŠ  =====

stock_status = []
for i in range(len(df)):
    stock = df.iloc[i]["åœ¨åº«æ•°"]
    if stock >= 100:
        stock_status.append("æ½¤æ²¢")
    elif stock >= 50:
        stock_status.append("é©æ­£")
    else:
        stock_status.append("è¦ç™ºæ³¨")

df["åœ¨åº«çŠ¶æ³"] = stock_status

print("=== å¤‰æ›å¾Œ ===")
print(df)
print()

# é›†è¨ˆ
print("=== ä¾¡æ ¼å¸¯åˆ¥ã®å•†å“æ•° ===")
price_counts = {}
for i in range(len(df)):
    pr = df.iloc[i]["ä¾¡æ ¼å¸¯"]
    if pr in price_counts:
        price_counts[pr] = price_counts[pr] + 1
    else:
        price_counts[pr] = 1

for pr, count in price_counts.items():
    print(f"{pr}: {count}ä»¶")

print()

print("=== åœ¨åº«çŠ¶æ³åˆ¥ã®å•†å“æ•° ===")
status_counts = {}
for i in range(len(df)):
    st = df.iloc[i]["åœ¨åº«çŠ¶æ³"]
    if st in status_counts:
        status_counts[st] = status_counts[st] + 1
    else:
        status_counts[st] = 1

for st, count in status_counts.items():
    print(f"{st}: {count}ä»¶")

print()

print("=== åœ¨åº«é‡‘é¡åˆè¨ˆ ===")
total_stock_value = 0
for i in range(len(df)):
    total_stock_value = total_stock_value + df.iloc[i]["åœ¨åº«é‡‘é¡"]

print(f"åˆè¨ˆ: {total_stock_value:,}å††")
```

**å®Ÿè¡Œçµæœ:**
```
=== å¤‰æ›å¾Œ ===
  å•†å“ID          å•†å“å        ã‚«ãƒ†ã‚´ãƒª     ä¾¡æ ¼  åœ¨åº«æ•°  ç™ºå£²å¹´     ãƒ–ãƒ©ãƒ³ãƒ‰      åœ¨åº«é‡‘é¡      ä¾¡æ ¼å¸¯  åœ¨åº«çŠ¶æ³
0   P001   Apple iPhone 15  ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³  150000      50    2023       Apple    7500000    é«˜ä¾¡æ ¼å¸¯      é©æ­£
1   P002    samsung galaxy  ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³  120000      30    2023     Samsung    3600000    é«˜ä¾¡æ ¼å¸¯    è¦ç™ºæ³¨
2   P003       SONY XPERIA  ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³  100000      20    2022        Sony    2000000    é«˜ä¾¡æ ¼å¸¯    è¦ç™ºæ³¨
3   P004      google Pixel  ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³   90000     100    2023      Google    9000000    ä¸­ä¾¡æ ¼å¸¯      æ½¤æ²¢
4   P005         OPPO Reno  ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³   50000     200    2022        Oppo   10000000    ä¸­ä¾¡æ ¼å¸¯      æ½¤æ²¢

=== ä¾¡æ ¼å¸¯åˆ¥ã®å•†å“æ•° ===
é«˜ä¾¡æ ¼å¸¯: 3ä»¶
ä¸­ä¾¡æ ¼å¸¯: 2ä»¶

=== åœ¨åº«çŠ¶æ³åˆ¥ã®å•†å“æ•° ===
é©æ­£: 1ä»¶
è¦ç™ºæ³¨: 2ä»¶
æ½¤æ²¢: 2ä»¶

=== åœ¨åº«é‡‘é¡åˆè¨ˆ ===
åˆè¨ˆ: 32,100,000å††
```

---

### ç™ºå±•è§£æ³•ï¼ˆPandas ã®æ©Ÿèƒ½ã‚’æ´»ç”¨ï¼‰

```python
import pandas as pd

df = pd.DataFrame({
    "product_id": ["P001", "P002", "P003", "P004", "P005"],
    "product_name": ["  Apple iPhone 15  ", "samsung galaxy", "SONY XPERIA", 
                     "google Pixel", "  OPPO Reno  "],
    "category": ["smartphone", "SMARTPHONE", "SmartPhone", "smartphone", "Smartphone"],
    "price": [150000, 120000, 100000, 90000, 50000],
    "stock": [50, 30, 20, 100, 200],
    "release_year": [2023, 2023, 2022, 2023, 2022]
})

df_transformed = (df
    .rename(columns={"product_id": "å•†å“ID", "product_name": "å•†å“å", 
                     "category": "ã‚«ãƒ†ã‚´ãƒª", "price": "ä¾¡æ ¼", 
                     "stock": "åœ¨åº«æ•°", "release_year": "ç™ºå£²å¹´"})
    .assign(å•†å“å=lambda x: x["å•†å“å"].str.strip())
    .assign(ãƒ–ãƒ©ãƒ³ãƒ‰=lambda x: x["å•†å“å"].str.split(" ").str[0].str.capitalize())
    .assign(ã‚«ãƒ†ã‚´ãƒª="ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³")
    .assign(åœ¨åº«é‡‘é¡=lambda x: x["ä¾¡æ ¼"] * x["åœ¨åº«æ•°"])
    .assign(ä¾¡æ ¼å¸¯=lambda x: pd.cut(x["ä¾¡æ ¼"], bins=[0, 50000, 100000, float("inf")], 
                                    labels=["ä½ä¾¡æ ¼å¸¯", "ä¸­ä¾¡æ ¼å¸¯", "é«˜ä¾¡æ ¼å¸¯"], right=False))
    .assign(åœ¨åº«çŠ¶æ³=lambda x: pd.cut(x["åœ¨åº«æ•°"], bins=[0, 50, 100, float("inf")], 
                                      labels=["è¦ç™ºæ³¨", "é©æ­£", "æ½¤æ²¢"], right=False))
)

print(df_transformed)
print("\nä¾¡æ ¼å¸¯åˆ¥:", df_transformed["ä¾¡æ ¼å¸¯"].value_counts())
print("\nåœ¨åº«é‡‘é¡åˆè¨ˆ:", f"{df_transformed['åœ¨åº«é‡‘é¡'].sum():,}å††")
```

</details>

---

## ğŸ¯ å¿œç”¨å•é¡Œãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

ä»¥ä¸‹ãŒã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã‹ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š

- [ ] è¤‡æ•°ã®å¤‰æ›å‡¦ç†ã‚’é †åºç«‹ã¦ã¦å®Ÿè¡Œã§ãã‚‹
- [ ] æ–‡å­—åˆ—ã‹ã‚‰æƒ…å ±ã‚’æŠ½å‡ºã—ã¦æ–°ã—ã„åˆ—ã‚’ä½œæˆã§ãã‚‹
- [ ] replace() ã¨ map() ã‚’ä½¿ã„åˆ†ã‘ã¦å€¤ã‚’å¤‰æ›ã§ãã‚‹
- [ ] apply() ã§ã‚«ã‚¹ã‚¿ãƒ å¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…ã§ãã‚‹
- [ ] cut() ã§æ•°å€¤ã‚’ã‚«ãƒ†ã‚´ãƒªã«å¤‰æ›ã§ãã‚‹
- [ ] å¤‰æ›å¾Œã®ãƒ‡ãƒ¼ã‚¿ã§é›†è¨ˆãƒ»åˆ†æãŒã§ãã‚‹
