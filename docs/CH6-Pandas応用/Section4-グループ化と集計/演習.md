# Section4: ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã¨é›†è¨ˆ - æ¼”ç¿’

## æ¼”ç¿’1: åŸºæœ¬çš„ãª groupby

### å•é¡Œ 1-1

ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã€ã€Œã‚¯ãƒ©ã‚¹ã€ã”ã¨ã®ã€Œç‚¹æ•°ã€ã®**åˆè¨ˆ**ã‚’æ±‚ã‚ã¦ãã ã•ã„ã€‚

```python
import pandas as pd

df = pd.DataFrame({
    "ã‚¯ãƒ©ã‚¹": ["A", "A", "A", "B", "B", "B"],
    "åå‰": ["ç”°ä¸­", "ä½è—¤", "éˆ´æœ¨", "é«˜æ©‹", "ä¼Šè—¤", "å±±ç”°"],
    "ç‚¹æ•°": [85, 92, 78, 88, 95, 82]
})
```

**æœŸå¾…ã™ã‚‹çµæœ:**
```
ã‚¯ãƒ©ã‚¹
A    255
B    265
Name: ç‚¹æ•°, dtype: int64
```

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

**åŸºæœ¬è§£æ³•ï¼ˆfor ãƒ«ãƒ¼ãƒ—ï¼‰:**
```python
import pandas as pd

df = pd.DataFrame({
    "ã‚¯ãƒ©ã‚¹": ["A", "A", "A", "B", "B", "B"],
    "åå‰": ["ç”°ä¸­", "ä½è—¤", "éˆ´æœ¨", "é«˜æ©‹", "ä¼Šè—¤", "å±±ç”°"],
    "ç‚¹æ•°": [85, 92, 78, 88, 95, 82]
})

# ã‚¯ãƒ©ã‚¹ã”ã¨ã«åˆè¨ˆã‚’è¨ˆç®—
class_totals = {}
for class_name in df["ã‚¯ãƒ©ã‚¹"].unique():
    class_data = df[df["ã‚¯ãƒ©ã‚¹"] == class_name]
    class_totals[class_name] = class_data["ç‚¹æ•°"].sum()

print("ã‚¯ãƒ©ã‚¹ã”ã¨ã®ç‚¹æ•°åˆè¨ˆ:")
for cls, total in class_totals.items():
    print(f"{cls}: {total}")
```

**ç™ºå±•è§£æ³•ï¼ˆgroupbyï¼‰:**
```python
import pandas as pd

df = pd.DataFrame({
    "ã‚¯ãƒ©ã‚¹": ["A", "A", "A", "B", "B", "B"],
    "åå‰": ["ç”°ä¸­", "ä½è—¤", "éˆ´æœ¨", "é«˜æ©‹", "ä¼Šè—¤", "å±±ç”°"],
    "ç‚¹æ•°": [85, 92, 78, 88, 95, 82]
})

# groupby ã§ã‚¯ãƒ©ã‚¹ã”ã¨ã®ç‚¹æ•°åˆè¨ˆ
result = df.groupby("ã‚¯ãƒ©ã‚¹")["ç‚¹æ•°"].sum()
print(result)
```

</details>

---

### å•é¡Œ 1-2

å•é¡Œ 1-1 ã®ãƒ‡ãƒ¼ã‚¿ã§ã€ã€Œã‚¯ãƒ©ã‚¹ã€ã”ã¨ã®ã€Œç‚¹æ•°ã€ã®**å¹³å‡**ã‚’æ±‚ã‚ã¦ãã ã•ã„ã€‚

**æœŸå¾…ã™ã‚‹çµæœ:**
```
ã‚¯ãƒ©ã‚¹
A    85.0
B    88.333...
Name: ç‚¹æ•°, dtype: float64
```

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

**åŸºæœ¬è§£æ³•:**
```python
import pandas as pd

df = pd.DataFrame({
    "ã‚¯ãƒ©ã‚¹": ["A", "A", "A", "B", "B", "B"],
    "åå‰": ["ç”°ä¸­", "ä½è—¤", "éˆ´æœ¨", "é«˜æ©‹", "ä¼Šè—¤", "å±±ç”°"],
    "ç‚¹æ•°": [85, 92, 78, 88, 95, 82]
})

# ã‚¯ãƒ©ã‚¹ã”ã¨ã«å¹³å‡ã‚’è¨ˆç®—
class_means = {}
for class_name in df["ã‚¯ãƒ©ã‚¹"].unique():
    class_data = df[df["ã‚¯ãƒ©ã‚¹"] == class_name]
    total = 0
    count = 0
    for score in class_data["ç‚¹æ•°"]:
        total = total + score
        count = count + 1
    class_means[class_name] = total / count

print("ã‚¯ãƒ©ã‚¹ã”ã¨ã®ç‚¹æ•°å¹³å‡:")
for cls, mean in class_means.items():
    print(f"{cls}: {mean}")
```

**ç™ºå±•è§£æ³•ï¼ˆgroupbyï¼‰:**
```python
import pandas as pd

df = pd.DataFrame({
    "ã‚¯ãƒ©ã‚¹": ["A", "A", "A", "B", "B", "B"],
    "åå‰": ["ç”°ä¸­", "ä½è—¤", "éˆ´æœ¨", "é«˜æ©‹", "ä¼Šè—¤", "å±±ç”°"],
    "ç‚¹æ•°": [85, 92, 78, 88, 95, 82]
})

# groupby ã§ã‚¯ãƒ©ã‚¹ã”ã¨ã®å¹³å‡
result = df.groupby("ã‚¯ãƒ©ã‚¹")["ç‚¹æ•°"].mean()
print(result)
```

</details>

---

### å•é¡Œ 1-3

å•é¡Œ 1-1 ã®ãƒ‡ãƒ¼ã‚¿ã§ã€ã€Œã‚¯ãƒ©ã‚¹ã€ã”ã¨ã®ã€Œäººæ•°ã€ã‚’æ±‚ã‚ã¦ãã ã•ã„ã€‚

**æœŸå¾…ã™ã‚‹çµæœ:**
```
ã‚¯ãƒ©ã‚¹
A    3
B    3
Name: ç‚¹æ•°, dtype: int64
```

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

**åŸºæœ¬è§£æ³•:**
```python
import pandas as pd

df = pd.DataFrame({
    "ã‚¯ãƒ©ã‚¹": ["A", "A", "A", "B", "B", "B"],
    "åå‰": ["ç”°ä¸­", "ä½è—¤", "éˆ´æœ¨", "é«˜æ©‹", "ä¼Šè—¤", "å±±ç”°"],
    "ç‚¹æ•°": [85, 92, 78, 88, 95, 82]
})

# ã‚¯ãƒ©ã‚¹ã”ã¨ã«ã‚«ã‚¦ãƒ³ãƒˆ
class_counts = {}
for class_name in df["ã‚¯ãƒ©ã‚¹"].unique():
    class_data = df[df["ã‚¯ãƒ©ã‚¹"] == class_name]
    class_counts[class_name] = len(class_data)

print("ã‚¯ãƒ©ã‚¹ã”ã¨ã®äººæ•°:")
for cls, count in class_counts.items():
    print(f"{cls}: {count}")
```

**ç™ºå±•è§£æ³•ï¼ˆgroupbyï¼‰:**
```python
import pandas as pd

df = pd.DataFrame({
    "ã‚¯ãƒ©ã‚¹": ["A", "A", "A", "B", "B", "B"],
    "åå‰": ["ç”°ä¸­", "ä½è—¤", "éˆ´æœ¨", "é«˜æ©‹", "ä¼Šè—¤", "å±±ç”°"],
    "ç‚¹æ•°": [85, 92, 78, 88, 95, 82]
})

# groupby ã§ã‚¯ãƒ©ã‚¹ã”ã¨ã®ä»¶æ•°
result = df.groupby("ã‚¯ãƒ©ã‚¹")["ç‚¹æ•°"].count()
print(result)
```

</details>

---

## æ¼”ç¿’2: è¤‡æ•°åˆ—ã§ã®ã‚°ãƒ«ãƒ¼ãƒ—åŒ–

### å•é¡Œ 2-1

ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã€ã€Œéƒ¨ç½²ã€ã¨ã€Œå¹´åº¦ã€ã”ã¨ã®ã€Œå£²ä¸Šã€ã®**åˆè¨ˆ**ã‚’æ±‚ã‚ã¦ãã ã•ã„ã€‚

```python
import pandas as pd

df = pd.DataFrame({
    "éƒ¨ç½²": ["å–¶æ¥­", "å–¶æ¥­", "å–¶æ¥­", "é–‹ç™º", "é–‹ç™º", "é–‹ç™º"],
    "å¹´åº¦": [2023, 2023, 2024, 2023, 2024, 2024],
    "å£²ä¸Š": [100, 150, 120, 200, 180, 220]
})
```

**æœŸå¾…ã™ã‚‹çµæœ:**
```
éƒ¨ç½²  å¹´åº¦
å–¶æ¥­  2023    250
      2024    120
é–‹ç™º  2023    200
      2024    400
Name: å£²ä¸Š, dtype: int64
```

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

**åŸºæœ¬è§£æ³•:**
```python
import pandas as pd

df = pd.DataFrame({
    "éƒ¨ç½²": ["å–¶æ¥­", "å–¶æ¥­", "å–¶æ¥­", "é–‹ç™º", "é–‹ç™º", "é–‹ç™º"],
    "å¹´åº¦": [2023, 2023, 2024, 2023, 2024, 2024],
    "å£²ä¸Š": [100, 150, 120, 200, 180, 220]
})

# éƒ¨ç½²ã¨å¹´åº¦ã®çµ„ã¿åˆã‚ã›ã”ã¨ã«é›†è¨ˆ
results = {}
for dept in df["éƒ¨ç½²"].unique():
    for year in df["å¹´åº¦"].unique():
        # æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡º
        filtered = df[(df["éƒ¨ç½²"] == dept) & (df["å¹´åº¦"] == year)]
        if len(filtered) > 0:
            total = 0
            for value in filtered["å£²ä¸Š"]:
                total = total + value
            results[(dept, year)] = total

print("éƒ¨ç½²ãƒ»å¹´åº¦åˆ¥å£²ä¸Šåˆè¨ˆ:")
for key, value in results.items():
    print(f"{key}: {value}")
```

**ç™ºå±•è§£æ³•ï¼ˆgroupbyï¼‰:**
```python
import pandas as pd

df = pd.DataFrame({
    "éƒ¨ç½²": ["å–¶æ¥­", "å–¶æ¥­", "å–¶æ¥­", "é–‹ç™º", "é–‹ç™º", "é–‹ç™º"],
    "å¹´åº¦": [2023, 2023, 2024, 2023, 2024, 2024],
    "å£²ä¸Š": [100, 150, 120, 200, 180, 220]
})

# è¤‡æ•°åˆ—ã§ groupby
result = df.groupby(["éƒ¨ç½²", "å¹´åº¦"])["å£²ä¸Š"].sum()
print(result)
```

</details>

---

### å•é¡Œ 2-2

å•é¡Œ 2-1 ã®çµæœã‹ã‚‰ã€ã€Œå–¶æ¥­ã€éƒ¨ç½²ã®ãƒ‡ãƒ¼ã‚¿ã ã‘ã‚’å–ã‚Šå‡ºã—ã¦ãã ã•ã„ã€‚

**æœŸå¾…ã™ã‚‹çµæœ:**
```
å¹´åº¦
2023    250
2024    120
Name: å£²ä¸Š, dtype: int64
```

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

**åŸºæœ¬è§£æ³•:**
```python
import pandas as pd

df = pd.DataFrame({
    "éƒ¨ç½²": ["å–¶æ¥­", "å–¶æ¥­", "å–¶æ¥­", "é–‹ç™º", "é–‹ç™º", "é–‹ç™º"],
    "å¹´åº¦": [2023, 2023, 2024, 2023, 2024, 2024],
    "å£²ä¸Š": [100, 150, 120, 200, 180, 220]
})

# ã¾ãšå–¶æ¥­ã ã‘ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã¦ã‹ã‚‰ groupby
sales_dept = df[df["éƒ¨ç½²"] == "å–¶æ¥­"]
result = sales_dept.groupby("å¹´åº¦")["å£²ä¸Š"].sum()
print(result)
```

**ç™ºå±•è§£æ³•ï¼ˆãƒãƒ«ãƒã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ï¼‰:**
```python
import pandas as pd

df = pd.DataFrame({
    "éƒ¨ç½²": ["å–¶æ¥­", "å–¶æ¥­", "å–¶æ¥­", "é–‹ç™º", "é–‹ç™º", "é–‹ç™º"],
    "å¹´åº¦": [2023, 2023, 2024, 2023, 2024, 2024],
    "å£²ä¸Š": [100, 150, 120, 200, 180, 220]
})

# è¤‡æ•°åˆ—ã§ groupby ã—ã¦ã‹ã‚‰ loc ã§ã‚¢ã‚¯ã‚»ã‚¹
grouped = df.groupby(["éƒ¨ç½²", "å¹´åº¦"])["å£²ä¸Š"].sum()
result = grouped.loc["å–¶æ¥­"]
print(result)
```

</details>

---

### å•é¡Œ 2-3

å•é¡Œ 2-1 ã®çµæœã‚’ `reset_index()` ã§é€šå¸¸ã® DataFrame ã«å¤‰æ›ã—ã¦ãã ã•ã„ã€‚

**æœŸå¾…ã™ã‚‹çµæœ:**
```
   éƒ¨ç½²    å¹´åº¦   å£²ä¸Š
0  å–¶æ¥­  2023   250
1  å–¶æ¥­  2024   120
2  é–‹ç™º  2023   200
3  é–‹ç™º  2024   400
```

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

```python
import pandas as pd

df = pd.DataFrame({
    "éƒ¨ç½²": ["å–¶æ¥­", "å–¶æ¥­", "å–¶æ¥­", "é–‹ç™º", "é–‹ç™º", "é–‹ç™º"],
    "å¹´åº¦": [2023, 2023, 2024, 2023, 2024, 2024],
    "å£²ä¸Š": [100, 150, 120, 200, 180, 220]
})

# groupby ã§é›†è¨ˆ
grouped = df.groupby(["éƒ¨ç½²", "å¹´åº¦"])["å£²ä¸Š"].sum()

print("=== reset_index å‰ï¼ˆSeriesï¼‰===")
print(grouped)

# reset_index ã§ DataFrame ã«å¤‰æ›
result = grouped.reset_index()

print("\n=== reset_index å¾Œï¼ˆDataFrameï¼‰===")
print(result)
```

</details>

---

## æ¼”ç¿’3: agg ã«ã‚ˆã‚‹è¤‡æ•°é›†è¨ˆ

### å•é¡Œ 3-1

ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã§ã€ã€Œåº—èˆ—ã€ã”ã¨ã®ã€Œå£²ä¸Šã€ã«ã¤ã„ã¦ã€**åˆè¨ˆã€å¹³å‡ã€ä»¶æ•°**ã‚’åŒæ™‚ã«æ±‚ã‚ã¦ãã ã•ã„ã€‚

```python
import pandas as pd

df = pd.DataFrame({
    "åº—èˆ—": ["æ±äº¬", "æ±äº¬", "æ±äº¬", "å¤§é˜ª", "å¤§é˜ª"],
    "å£²ä¸Š": [10000, 12000, 8000, 15000, 9000]
})
```

**æœŸå¾…ã™ã‚‹çµæœ:**
```
        sum     mean  count
åº—èˆ—                        
å¤§é˜ª  24000  12000.0      2
æ±äº¬  30000  10000.0      3
```

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

**åŸºæœ¬è§£æ³•:**
```python
import pandas as pd

df = pd.DataFrame({
    "åº—èˆ—": ["æ±äº¬", "æ±äº¬", "æ±äº¬", "å¤§é˜ª", "å¤§é˜ª"],
    "å£²ä¸Š": [10000, 12000, 8000, 15000, 9000]
})

# åº—èˆ—ã”ã¨ã«é›†è¨ˆã‚’è¨ˆç®—
for store in df["åº—èˆ—"].unique():
    store_data = df[df["åº—èˆ—"] == store]
    
    # åˆè¨ˆ
    total = 0
    for v in store_data["å£²ä¸Š"]:
        total = total + v
    
    # ä»¶æ•°
    count = len(store_data)
    
    # å¹³å‡
    mean = total / count
    
    print(f"{store}: åˆè¨ˆ={total}, å¹³å‡={mean}, ä»¶æ•°={count}")
```

**ç™ºå±•è§£æ³•ï¼ˆaggï¼‰:**
```python
import pandas as pd

df = pd.DataFrame({
    "åº—èˆ—": ["æ±äº¬", "æ±äº¬", "æ±äº¬", "å¤§é˜ª", "å¤§é˜ª"],
    "å£²ä¸Š": [10000, 12000, 8000, 15000, 9000]
})

# agg ã§è¤‡æ•°ã®é›†è¨ˆé–¢æ•°ã‚’é©ç”¨
result = df.groupby("åº—èˆ—")["å£²ä¸Š"].agg(["sum", "mean", "count"])
print(result)
```

</details>

---

### å•é¡Œ 3-2

ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã§ã€ã€Œåº—èˆ—ã€ã”ã¨ã«ã€Œå£²ä¸Šã€ã¯**åˆè¨ˆ**ã€ã€Œå®¢æ•°ã€ã¯**æœ€å¤§å€¤**ã‚’æ±‚ã‚ã¦ãã ã•ã„ã€‚

```python
import pandas as pd

df = pd.DataFrame({
    "åº—èˆ—": ["æ±äº¬", "æ±äº¬", "å¤§é˜ª", "å¤§é˜ª"],
    "å£²ä¸Š": [10000, 12000, 15000, 9000],
    "å®¢æ•°": [50, 60, 70, 40]
})
```

**æœŸå¾…ã™ã‚‹çµæœ:**
```
       å£²ä¸Š   å®¢æ•°
       sum  max
åº—èˆ—           
å¤§é˜ª  24000   70
æ±äº¬  22000   60
```

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

**åŸºæœ¬è§£æ³•:**
```python
import pandas as pd

df = pd.DataFrame({
    "åº—èˆ—": ["æ±äº¬", "æ±äº¬", "å¤§é˜ª", "å¤§é˜ª"],
    "å£²ä¸Š": [10000, 12000, 15000, 9000],
    "å®¢æ•°": [50, 60, 70, 40]
})

# åº—èˆ—ã”ã¨ã«ç•°ãªã‚‹é›†è¨ˆã‚’è¨ˆç®—
for store in df["åº—èˆ—"].unique():
    store_data = df[df["åº—èˆ—"] == store]
    
    # å£²ä¸Šã®åˆè¨ˆ
    sales_sum = 0
    for v in store_data["å£²ä¸Š"]:
        sales_sum = sales_sum + v
    
    # å®¢æ•°ã®æœ€å¤§å€¤
    customer_max = store_data["å®¢æ•°"].iloc[0]  # æœ€åˆã®å€¤ã§åˆæœŸåŒ–
    for v in store_data["å®¢æ•°"]:
        if v > customer_max:
            customer_max = v
    
    print(f"{store}: å£²ä¸Šåˆè¨ˆ={sales_sum}, å®¢æ•°æœ€å¤§={customer_max}")
```

**ç™ºå±•è§£æ³•ï¼ˆagg + è¾æ›¸ï¼‰:**
```python
import pandas as pd

df = pd.DataFrame({
    "åº—èˆ—": ["æ±äº¬", "æ±äº¬", "å¤§é˜ª", "å¤§é˜ª"],
    "å£²ä¸Š": [10000, 12000, 15000, 9000],
    "å®¢æ•°": [50, 60, 70, 40]
})

# åˆ—ã”ã¨ã«ç•°ãªã‚‹é›†è¨ˆé–¢æ•°ã‚’é©ç”¨
result = df.groupby("åº—èˆ—").agg({
    "å£²ä¸Š": "sum",
    "å®¢æ•°": "max"
})
print(result)
```

</details>

---

## æ¼”ç¿’4: pivot_table

### å•é¡Œ 4-1

ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã«å¤‰æ›ã—ã¦ãã ã•ã„ã€‚
- è¡Œï¼ˆindexï¼‰: åº—èˆ—
- åˆ—ï¼ˆcolumnsï¼‰: æœˆ
- å€¤ï¼ˆvaluesï¼‰: å£²ä¸Š

```python
import pandas as pd

df = pd.DataFrame({
    "åº—èˆ—": ["æ±äº¬", "æ±äº¬", "å¤§é˜ª", "å¤§é˜ª"],
    "æœˆ": [1, 2, 1, 2],
    "å£²ä¸Š": [10000, 12000, 8000, 9000]
})
```

**æœŸå¾…ã™ã‚‹çµæœ:**
```
æœˆ       1      2
åº—èˆ—            
å¤§é˜ª   8000   9000
æ±äº¬  10000  12000
```

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

**åŸºæœ¬è§£æ³•:**
```python
import pandas as pd

df = pd.DataFrame({
    "åº—èˆ—": ["æ±äº¬", "æ±äº¬", "å¤§é˜ª", "å¤§é˜ª"],
    "æœˆ": [1, 2, 1, 2],
    "å£²ä¸Š": [10000, 12000, 8000, 9000]
})

# æ‰‹å‹•ã§ãƒ”ãƒœãƒƒãƒˆã‚’ä½œæˆ
stores = df["åº—èˆ—"].unique()
months = df["æœˆ"].unique()

result = {}
for store in stores:
    result[store] = {}
    for month in months:
        filtered = df[(df["åº—èˆ—"] == store) & (df["æœˆ"] == month)]
        if len(filtered) > 0:
            result[store][month] = filtered["å£²ä¸Š"].iloc[0]

print("æ‰‹å‹•ãƒ”ãƒœãƒƒãƒˆ:")
for store, data in result.items():
    print(f"{store}: {data}")
```

**ç™ºå±•è§£æ³•ï¼ˆpivot_tableï¼‰:**
```python
import pandas as pd

df = pd.DataFrame({
    "åº—èˆ—": ["æ±äº¬", "æ±äº¬", "å¤§é˜ª", "å¤§é˜ª"],
    "æœˆ": [1, 2, 1, 2],
    "å£²ä¸Š": [10000, 12000, 8000, 9000]
})

# pivot_table ã§ã‚¯ãƒ­ã‚¹é›†è¨ˆ
pivot = pd.pivot_table(df, values="å£²ä¸Š", index="åº—èˆ—", columns="æœˆ")
print(pivot)
```

</details>

---

### å•é¡Œ 4-2

ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã§ã€è¤‡æ•°ã®å€¤ãŒã‚ã‚‹å ´åˆã«**åˆè¨ˆ**ã§é›†è¨ˆã™ã‚‹ãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

```python
import pandas as pd

df = pd.DataFrame({
    "åº—èˆ—": ["æ±äº¬", "æ±äº¬", "æ±äº¬", "å¤§é˜ª", "å¤§é˜ª", "å¤§é˜ª"],
    "æœˆ": [1, 1, 2, 1, 2, 2],
    "å£²ä¸Š": [5000, 5000, 12000, 8000, 4000, 5000]
})
```

**æœŸå¾…ã™ã‚‹çµæœ:**
```
æœˆ        1      2
åº—èˆ—             
å¤§é˜ª    8000   9000
æ±äº¬   10000  12000
```

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

**åŸºæœ¬è§£æ³•:**
```python
import pandas as pd

df = pd.DataFrame({
    "åº—èˆ—": ["æ±äº¬", "æ±äº¬", "æ±äº¬", "å¤§é˜ª", "å¤§é˜ª", "å¤§é˜ª"],
    "æœˆ": [1, 1, 2, 1, 2, 2],
    "å£²ä¸Š": [5000, 5000, 12000, 8000, 4000, 5000]
})

# æ‰‹å‹•ã§ãƒ”ãƒœãƒƒãƒˆ + åˆè¨ˆ
stores = df["åº—èˆ—"].unique()
months = df["æœˆ"].unique()

result = {}
for store in stores:
    result[store] = {}
    for month in months:
        filtered = df[(df["åº—èˆ—"] == store) & (df["æœˆ"] == month)]
        total = 0
        for v in filtered["å£²ä¸Š"]:
            total = total + v
        result[store][month] = total

print("æ‰‹å‹•ãƒ”ãƒœãƒƒãƒˆï¼ˆåˆè¨ˆï¼‰:")
for store, data in result.items():
    print(f"{store}: {data}")
```

**ç™ºå±•è§£æ³•ï¼ˆpivot_table + aggfuncï¼‰:**
```python
import pandas as pd

df = pd.DataFrame({
    "åº—èˆ—": ["æ±äº¬", "æ±äº¬", "æ±äº¬", "å¤§é˜ª", "å¤§é˜ª", "å¤§é˜ª"],
    "æœˆ": [1, 1, 2, 1, 2, 2],
    "å£²ä¸Š": [5000, 5000, 12000, 8000, 4000, 5000]
})

# aggfunc="sum" ã§åˆè¨ˆã‚’æŒ‡å®š
pivot = pd.pivot_table(df, values="å£²ä¸Š", index="åº—èˆ—", columns="æœˆ", aggfunc="sum")
print(pivot)
```

</details>

---

### å•é¡Œ 4-3

å•é¡Œ 4-2 ã«**åˆè¨ˆè¡Œãƒ»åˆ—ã‚’è¿½åŠ **ã—ã¦ãã ã•ã„ã€‚

**æœŸå¾…ã™ã‚‹çµæœ:**
```
æœˆ        1      2    åˆè¨ˆ
åº—èˆ—                     
å¤§é˜ª    8000   9000  17000
æ±äº¬   10000  12000  22000
åˆè¨ˆ   18000  21000  39000
```

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

```python
import pandas as pd

df = pd.DataFrame({
    "åº—èˆ—": ["æ±äº¬", "æ±äº¬", "æ±äº¬", "å¤§é˜ª", "å¤§é˜ª", "å¤§é˜ª"],
    "æœˆ": [1, 1, 2, 1, 2, 2],
    "å£²ä¸Š": [5000, 5000, 12000, 8000, 4000, 5000]
})

# margins=True ã§åˆè¨ˆè¡Œãƒ»åˆ—ã‚’è¿½åŠ 
pivot = pd.pivot_table(df, values="å£²ä¸Š", index="åº—èˆ—", columns="æœˆ", 
                        aggfunc="sum", margins=True, margins_name="åˆè¨ˆ")
print(pivot)
```

</details>

---

## ğŸ‰ æ¼”ç¿’å®Œäº†ï¼

ã™ã¹ã¦ã®å•é¡ŒãŒè§£ã‘ãŸã‚‰ã€ã€Œå¿œç”¨å•é¡Œã€ã«é€²ã¿ã¾ã—ã‚‡ã†ï¼
