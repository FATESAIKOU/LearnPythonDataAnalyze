# Section5: è¤‡æ•°ã‚°ãƒ©ãƒ•ã¨ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ - å¿œç”¨å•é¡Œ

## ğŸš€ å®Ÿè·µèª²é¡Œ

---

### å¿œç”¨å•é¡Œ1: å£²ä¸Šåˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ã€**4ã¤ã®ã‚°ãƒ©ãƒ•ã‚’2x2ã§é…ç½®** ã—ãŸãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

**ãƒ‡ãƒ¼ã‚¿:**
```python
months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun']
sales = [100, 120, 110, 140, 155, 170]
target = [110, 115, 120, 130, 145, 160]
profit = [15, 18, 16, 22, 25, 28]

products = ['A', 'B', 'C', 'D']
product_sales = [40, 30, 20, 10]
```

**è¦ä»¶:**
1. å·¦ä¸Š: å£²ä¸Šã¨ç›®æ¨™ã®æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•
2. å³ä¸Š: è£½å“åˆ¥å£²ä¸Šã®æ£’ã‚°ãƒ©ãƒ•
3. å·¦ä¸‹: è£½å“åˆ¥å£²ä¸Šã®å††ã‚°ãƒ©ãƒ•
4. å³ä¸‹: å£²ä¸Šã¨åˆ©ç›Šã®åŒè»¸ã‚°ãƒ©ãƒ•
5. å…¨ä½“ã‚¿ã‚¤ãƒˆãƒ«: "Sales Dashboard - H1 2024"
6. PNG(300dpi)ã¨PDFã§ä¿å­˜

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

```python
import matplotlib.pyplot as plt

months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun']
sales = [100, 120, 110, 140, 155, 170]
target = [110, 115, 120, 130, 145, 160]
profit = [15, 18, 16, 22, 25, 28]

products = ['A', 'B', 'C', 'D']
product_sales = [40, 30, 20, 10]
colors = ['#3498db', '#e74c3c', '#2ecc71', '#f39c12']

fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# === å·¦ä¸Š: å£²ä¸Šã¨ç›®æ¨™ã®æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ• ===
ax1 = axes[0, 0]
ax1.plot(months, sales, 'o-', color='#3498db', linewidth=2, 
         markersize=8, label='Actual')
ax1.plot(months, target, 's--', color='#e74c3c', linewidth=2, 
         markersize=6, label='Target')
ax1.set_title('Sales vs Target', fontsize=12, fontweight='bold')
ax1.set_ylabel('Sales (ä¸‡å††)')
ax1.legend(loc='upper left')
ax1.grid(True, axis='y', alpha=0.3)

# === å³ä¸Š: è£½å“åˆ¥å£²ä¸Šã®æ£’ã‚°ãƒ©ãƒ• ===
ax2 = axes[0, 1]
ax2.bar(products, product_sales, color=colors, edgecolor='white')
ax2.set_title('Sales by Product', fontsize=12, fontweight='bold')
ax2.set_ylabel('Sales (ä¸‡å††)')
ax2.grid(True, axis='y', alpha=0.3)

# å€¤ã‚’æ£’ã®ä¸Šã«è¡¨ç¤º
for i, v in enumerate(product_sales):
    ax2.text(i, v + 1, str(v), ha='center', fontsize=10)

# === å·¦ä¸‹: è£½å“åˆ¥å£²ä¸Šã®å††ã‚°ãƒ©ãƒ• ===
ax3 = axes[1, 0]
ax3.pie(product_sales, labels=products, autopct='%1.1f%%',
        colors=colors, startangle=90,
        wedgeprops={'edgecolor': 'white', 'linewidth': 2})
ax3.set_title('Product Share', fontsize=12, fontweight='bold')

# === å³ä¸‹: å£²ä¸Šã¨åˆ©ç›Šã®åŒè»¸ã‚°ãƒ©ãƒ• ===
ax4 = axes[1, 1]
ax4.bar(months, sales, color='#3498db', alpha=0.7, label='Sales')
ax4.set_ylabel('Sales (ä¸‡å††)', color='#3498db')
ax4.tick_params(axis='y', labelcolor='#3498db')

ax4_twin = ax4.twinx()
ax4_twin.plot(months, profit, 'o-', color='#e74c3c', linewidth=2, 
              markersize=8, label='Profit')
ax4_twin.set_ylabel('Profit (ä¸‡å††)', color='#e74c3c')
ax4_twin.tick_params(axis='y', labelcolor='#e74c3c')

ax4.set_title('Sales & Profit', fontsize=12, fontweight='bold')

# å‡¡ä¾‹ã‚’ã¾ã¨ã‚ã‚‹
lines1, labels1 = ax4.get_legend_handles_labels()
lines2, labels2 = ax4_twin.get_legend_handles_labels()
ax4.legend(lines1 + lines2, labels1 + labels2, loc='upper left')

# å…¨ä½“ã‚¿ã‚¤ãƒˆãƒ«
fig.suptitle('Sales Dashboard - H1 2024', 
             fontsize=16, fontweight='bold', y=0.98)

plt.tight_layout()
plt.subplots_adjust(top=0.92)

# ä¿å­˜
fig.savefig('dashboard.png', dpi=300, bbox_inches='tight', facecolor='white')
fig.savefig('dashboard.pdf', bbox_inches='tight')

plt.show()
```

</details>

---

### å¿œç”¨å•é¡Œ2: æ™‚ç³»åˆ—æ¯”è¼ƒãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã§ã€**xè»¸ã‚’å…±æœ‰ã—ãŸ3æ®µã‚°ãƒ©ãƒ•** ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

**ãƒ‡ãƒ¼ã‚¿:**
```python
import random
random.seed(42)

dates = [f'Day {i}' for i in range(1, 15)]
visitors = [random.randint(80, 150) for _ in range(14)]
sales = [v * random.uniform(0.5, 0.8) for v in visitors]
conversion = [s / v * 100 for s, v in zip(sales, visitors)]
```

**è¦ä»¶:**
1. ä¸Šæ®µ: æ¥å®¢æ•°ï¼ˆæ£’ã‚°ãƒ©ãƒ•ã€é’ï¼‰
2. ä¸­æ®µ: å£²ä¸Šï¼ˆæŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ã€ç·‘ï¼‰
3. ä¸‹æ®µ: è»¢æ›ç‡ï¼ˆæŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ã€èµ¤ï¼‰
4. xè»¸ã‚’å…±æœ‰ï¼ˆä¸€ç•ªä¸‹ã®ã‚°ãƒ©ãƒ•ã«ã®ã¿ãƒ©ãƒ™ãƒ«ï¼‰
5. å„ã‚°ãƒ©ãƒ•ã«ã‚°ãƒªãƒƒãƒ‰ã‚’è¿½åŠ 

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

```python
import matplotlib.pyplot as plt
import random

random.seed(42)

dates = [f'Day {i}' for i in range(1, 15)]
visitors = [random.randint(80, 150) for _ in range(14)]
sales = [v * random.uniform(0.5, 0.8) for v in visitors]
conversion = [s / v * 100 for s, v in zip(sales, visitors)]

# xè»¸ã‚’å…±æœ‰ã™ã‚‹3æ®µã‚°ãƒ©ãƒ•
fig, (ax1, ax2, ax3) = plt.subplots(3, 1, figsize=(14, 10), sharex=True)

# ä¸Šæ®µ: æ¥å®¢æ•°
ax1.bar(dates, visitors, color='#3498db', alpha=0.8)
ax1.set_ylabel('Visitors', fontsize=11)
ax1.set_title('Daily Performance Metrics', fontsize=14, fontweight='bold')
ax1.grid(True, axis='y', alpha=0.3)

# ä¸­æ®µ: å£²ä¸Š
ax2.plot(dates, sales, 'o-', color='#27ae60', linewidth=2, markersize=6)
ax2.set_ylabel('Sales', fontsize=11)
ax2.grid(True, axis='y', alpha=0.3)
ax2.fill_between(dates, sales, alpha=0.2, color='#27ae60')

# ä¸‹æ®µ: è»¢æ›ç‡
ax3.plot(dates, conversion, 's-', color='#e74c3c', linewidth=2, markersize=6)
ax3.set_ylabel('Conversion Rate (%)', fontsize=11)
ax3.set_xlabel('Date', fontsize=11)
ax3.grid(True, axis='y', alpha=0.3)

# xè»¸ãƒ©ãƒ™ãƒ«ã‚’å›è»¢
plt.xticks(rotation=45, ha='right')

plt.tight_layout()
plt.savefig('time_series.png', dpi=300, bbox_inches='tight', facecolor='white')
plt.show()
```

**è§£èª¬:**
- `sharex=True` ã§3ã¤ã®ã‚°ãƒ©ãƒ•ãŒxè»¸ã‚’å…±æœ‰
- `fill_between()` ã§æŠ˜ã‚Œç·šã®ä¸‹ã‚’å¡—ã‚Šã¤ã¶ã—

</details>

---

### å¿œç”¨å•é¡Œ3: ä¸å‡ç­‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

**GridSpec** ã‚’ä½¿ã£ã¦ä»¥ä¸‹ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒ¼ãƒˆ       â”‚  â† ä¸Šæ®µ: é«˜ã•2
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å°1    â”‚   å°2   â”‚  å°3  â”‚  â† ä¸‹æ®µ: é«˜ã•1
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ãƒ‡ãƒ¼ã‚¿:**
```python
months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun']
sales = [100, 120, 110, 140, 155, 170]
products = ['A', 'B', 'C']
q1 = [30, 25, 20]
q2 = [35, 28, 22]
```

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

```python
import matplotlib.pyplot as plt
import matplotlib.gridspec as gridspec

months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun']
sales = [100, 120, 110, 140, 155, 170]
products = ['A', 'B', 'C']
q1 = [30, 25, 20]
q2 = [35, 28, 22]

fig = plt.figure(figsize=(14, 10))

# GridSpec: 2è¡Œ3åˆ—ã€é«˜ã•æ¯” 2:1
gs = gridspec.GridSpec(2, 3, height_ratios=[2, 1])

# === ä¸Šæ®µ: ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒ¼ãƒˆï¼ˆå…¨å¹…ï¼‰===
ax_main = fig.add_subplot(gs[0, :])
ax_main.plot(months, sales, 'o-', color='#3498db', linewidth=3, markersize=12)
ax_main.set_title('Monthly Sales Trend (Main)', fontsize=14, fontweight='bold')
ax_main.set_ylabel('Sales (ä¸‡å††)', fontsize=12)
ax_main.grid(True, alpha=0.3)
ax_main.set_ylim(80, 180)

# æ³¨é‡ˆ
ax_main.annotate('Peak', xy=(5, 170), xytext=(4, 175),
                 fontsize=11, arrowprops=dict(arrowstyle='->', color='red'))

# === ä¸‹æ®µå·¦: æ£’ã‚°ãƒ©ãƒ• ===
ax1 = fig.add_subplot(gs[1, 0])
ax1.bar(products, q1, color='#e74c3c')
ax1.set_title('Q1 Sales', fontsize=12)
ax1.set_ylabel('Sales')

# === ä¸‹æ®µä¸­å¤®: æ£’ã‚°ãƒ©ãƒ• ===
ax2 = fig.add_subplot(gs[1, 1])
ax2.bar(products, q2, color='#27ae60')
ax2.set_title('Q2 Sales', fontsize=12)

# === ä¸‹æ®µå³: å††ã‚°ãƒ©ãƒ• ===
ax3 = fig.add_subplot(gs[1, 2])
total = [sum(x) for x in zip(q1, q2)]
ax3.pie(total, labels=products, autopct='%1.0f%%',
        colors=['#3498db', '#e74c3c', '#f39c12'])
ax3.set_title('Total Share', fontsize=12)

# å…¨ä½“ã‚¿ã‚¤ãƒˆãƒ«
fig.suptitle('Sales Analysis Dashboard', fontsize=16, fontweight='bold', y=0.98)

plt.tight_layout()
plt.subplots_adjust(top=0.92)
plt.savefig('gridspec_layout.png', dpi=300, bbox_inches='tight', facecolor='white')
plt.show()
```

**è§£èª¬:**
- `gs[0, :]`: 0è¡Œç›®ã®å…¨åˆ—
- `height_ratios=[2, 1]`: ä¸Šæ®µãŒä¸‹æ®µã®2å€ã®é«˜ã•

</details>

---

### å¿œç”¨å•é¡Œ4: è¤‡æ•°å½¢å¼ã§ã®ãƒãƒƒãƒã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

åŒã˜ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰è¤‡æ•°ã®ã‚°ãƒ©ãƒ•ã‚’ä½œæˆã—ã€ãã‚Œãã‚Œã‚’ **é©åˆ‡ãªå½¢å¼** ã§ä¿å­˜ã—ã¦ãã ã•ã„ã€‚

**è¦ä»¶:**
1. ãƒ¡ã‚¤ãƒ³ã‚°ãƒ©ãƒ•: PNG (300dpi)
2. å°åˆ·ç”¨ã‚°ãƒ©ãƒ•: PDF
3. Webç”¨ãƒ™ã‚¯ã‚¿ãƒ¼: SVG
4. é–¢æ•°ã‚’ä½œæˆã—ã¦å†åˆ©ç”¨å¯èƒ½ã«

```python
import matplotlib.pyplot as plt

def create_sales_chart(months, sales, title, filename_base):
    """å£²ä¸Šã‚°ãƒ©ãƒ•ã‚’ä½œæˆã—ã¦è¤‡æ•°å½¢å¼ã§ä¿å­˜ã™ã‚‹é–¢æ•°"""
    # ã“ã“ã«ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã
    pass

# ãƒ‡ãƒ¼ã‚¿
months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun']
sales = [100, 120, 110, 140, 155, 170]

# é–¢æ•°ã‚’å‘¼ã³å‡ºã—
# ã“ã“ã«ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã
```

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

```python
import matplotlib.pyplot as plt

def create_sales_chart(months, sales, title, filename_base):
    """å£²ä¸Šã‚°ãƒ©ãƒ•ã‚’ä½œæˆã—ã¦è¤‡æ•°å½¢å¼ã§ä¿å­˜ã™ã‚‹é–¢æ•°"""
    
    fig, ax = plt.subplots(figsize=(10, 6))
    
    # ã‚°ãƒ©ãƒ•ã‚’æç”»
    ax.plot(months, sales, 'o-', color='#3498db', linewidth=2.5, 
            markersize=10, markeredgecolor='white', markeredgewidth=2)
    
    # è£…é£¾
    ax.set_title(title, fontsize=14, fontweight='bold')
    ax.set_xlabel('Month', fontsize=12)
    ax.set_ylabel('Sales (ä¸‡å††)', fontsize=12)
    ax.grid(True, axis='y', linestyle='--', alpha=0.5)
    ax.spines['top'].set_visible(False)
    ax.spines['right'].set_visible(False)
    
    plt.tight_layout()
    
    # PNG (Web/ãƒ—ãƒ¬ã‚¼ãƒ³ç”¨ã€é«˜è§£åƒåº¦)
    fig.savefig(f'{filename_base}.png', 
                dpi=300, 
                bbox_inches='tight', 
                facecolor='white')
    print(f'Saved: {filename_base}.png')
    
    # PDF (å°åˆ·ç”¨ã€ãƒ™ã‚¯ã‚¿ãƒ¼)
    fig.savefig(f'{filename_base}.pdf', 
                bbox_inches='tight')
    print(f'Saved: {filename_base}.pdf')
    
    # SVG (Webç”¨ã€ãƒ™ã‚¯ã‚¿ãƒ¼)
    fig.savefig(f'{filename_base}.svg', 
                bbox_inches='tight')
    print(f'Saved: {filename_base}.svg')
    
    plt.show()
    
    return fig, ax

# ãƒ‡ãƒ¼ã‚¿
months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun']
sales = [100, 120, 110, 140, 155, 170]

# é–¢æ•°ã‚’å‘¼ã³å‡ºã—
fig, ax = create_sales_chart(
    months, sales, 
    'Monthly Sales Report - H1 2024', 
    'sales_report'
)

# è¿½åŠ ã®ãƒ‡ãƒ¼ã‚¿ã§å†åˆ©ç”¨
months_h2 = ['Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
sales_h2 = [160, 145, 155, 170, 180, 200]

fig2, ax2 = create_sales_chart(
    months_h2, sales_h2, 
    'Monthly Sales Report - H2 2024', 
    'sales_report_h2'
)
```

**è§£èª¬:**
- é–¢æ•°åŒ–ã™ã‚‹ã“ã¨ã§å†åˆ©ç”¨å¯èƒ½ã«
- ç”¨é€”ã«å¿œã˜ãŸå½¢å¼ã§è‡ªå‹•ä¿å­˜

</details>

---

### å¿œç”¨å•é¡Œ5: ç·åˆãƒ¬ãƒãƒ¼ãƒˆ

ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ã€**ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªåˆ†æãƒ¬ãƒãƒ¼ãƒˆ** ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

**ãƒ‡ãƒ¼ã‚¿:**
```python
import random
random.seed(42)

# æœˆåˆ¥ãƒ‡ãƒ¼ã‚¿
months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun']
revenue = [1000, 1200, 1100, 1400, 1550, 1700]
cost = [600, 700, 680, 800, 850, 900]
profit = [r - c for r, c in zip(revenue, cost)]
profit_margin = [p / r * 100 for p, r in zip(profit, revenue)]

# è£½å“åˆ¥ãƒ‡ãƒ¼ã‚¿
products = ['Product A', 'Product B', 'Product C', 'Product D']
product_revenue = [500, 350, 250, 100]

# åœ°åŸŸåˆ¥ãƒ‡ãƒ¼ã‚¿
regions = ['Tokyo', 'Osaka', 'Nagoya', 'Fukuoka']
region_data = [[random.gauss(m, 10) for _ in range(12)] 
               for m in [100, 80, 70, 60]]
```

**è¦ä»¶:**
1. GridSpec ã§ä¸å‡ç­‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆä¸Šæ®µ1ã¤ + ä¸‹æ®µ2ã¤ + æœ€ä¸‹æ®µ2ã¤ï¼‰
2. ä¸Šæ®µ: åç›Šãƒ»ã‚³ã‚¹ãƒˆãƒ»åˆ©ç›Šã®æ¨ç§»ï¼ˆåŒè»¸ï¼šæ£’+æŠ˜ã‚Œç·šï¼‰
3. å·¦ä¸‹: è£½å“åˆ¥åç›Šï¼ˆæ¨ªæ£’ã‚°ãƒ©ãƒ•ï¼‰
4. å³ä¸‹: è£½å“åˆ¥ã‚·ã‚§ã‚¢ï¼ˆå††ã‚°ãƒ©ãƒ•ï¼‰
5. å·¦æœ€ä¸‹: åˆ©ç›Šç‡æ¨ç§»ï¼ˆé¢ã‚°ãƒ©ãƒ•ï¼‰
6. å³æœ€ä¸‹: åœ°åŸŸåˆ¥åˆ†å¸ƒï¼ˆç®±ã²ã’å›³ï¼‰
7. å…¨ä½“ã‚¿ã‚¤ãƒˆãƒ«ã€å‡¡ä¾‹ã€ã‚°ãƒªãƒƒãƒ‰å®Œå‚™
8. PNG ã¨ PDF ã§ä¿å­˜

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

```python
import matplotlib.pyplot as plt
import matplotlib.gridspec as gridspec
import random

random.seed(42)

# ãƒ‡ãƒ¼ã‚¿æº–å‚™
months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun']
revenue = [1000, 1200, 1100, 1400, 1550, 1700]
cost = [600, 700, 680, 800, 850, 900]
profit = [r - c for r, c in zip(revenue, cost)]
profit_margin = [p / r * 100 for p, r in zip(profit, revenue)]

products = ['Product A', 'Product B', 'Product C', 'Product D']
product_revenue = [500, 350, 250, 100]

regions = ['Tokyo', 'Osaka', 'Nagoya', 'Fukuoka']
region_data = [[random.gauss(m, 10) for _ in range(12)] 
               for m in [100, 80, 70, 60]]

# ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ
colors = ['#3498db', '#e74c3c', '#2ecc71', '#f39c12']

# ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä½œæˆ
fig = plt.figure(figsize=(16, 14))
gs = gridspec.GridSpec(3, 2, height_ratios=[1.5, 1, 1])

# === ä¸Šæ®µ: åç›Šãƒ»ã‚³ã‚¹ãƒˆãƒ»åˆ©ç›Šï¼ˆåŒè»¸ï¼‰===
ax1 = fig.add_subplot(gs[0, :])

# æ£’ã‚°ãƒ©ãƒ•ï¼ˆåç›Šã¨ã‚³ã‚¹ãƒˆï¼‰
x = range(len(months))
width = 0.35
bars1 = ax1.bar([i - width/2 for i in x], revenue, width, 
                label='Revenue', color=colors[0], alpha=0.8)
bars2 = ax1.bar([i + width/2 for i in x], cost, width, 
                label='Cost', color=colors[1], alpha=0.8)
ax1.set_ylabel('Amount (ä¸‡å††)', fontsize=11)
ax1.set_xticks(x)
ax1.set_xticklabels(months)
ax1.legend(loc='upper left')
ax1.grid(True, axis='y', alpha=0.3)

# å³è»¸: åˆ©ç›Šï¼ˆæŠ˜ã‚Œç·šï¼‰
ax1_twin = ax1.twinx()
ax1_twin.plot(x, profit, 'o-', color=colors[2], linewidth=2.5, 
              markersize=10, label='Profit')
ax1_twin.set_ylabel('Profit (ä¸‡å††)', color=colors[2], fontsize=11)
ax1_twin.tick_params(axis='y', labelcolor=colors[2])
ax1_twin.legend(loc='upper right')

ax1.set_title('Revenue, Cost and Profit Trend', fontsize=14, fontweight='bold')

# === å·¦ä¸­æ®µ: è£½å“åˆ¥åç›Šï¼ˆæ¨ªæ£’ï¼‰===
ax2 = fig.add_subplot(gs[1, 0])
bars = ax2.barh(products, product_revenue, color=colors, edgecolor='white')
ax2.set_xlabel('Revenue (ä¸‡å††)', fontsize=11)
ax2.set_title('Revenue by Product', fontsize=12, fontweight='bold')
ax2.grid(True, axis='x', alpha=0.3)

# å€¤ã‚’è¡¨ç¤º
for bar, val in zip(bars, product_revenue):
    ax2.text(val + 10, bar.get_y() + bar.get_height()/2, 
             f'{val}', va='center', fontsize=10)

# === å³ä¸­æ®µ: è£½å“åˆ¥ã‚·ã‚§ã‚¢ï¼ˆå††ã‚°ãƒ©ãƒ•ï¼‰===
ax3 = fig.add_subplot(gs[1, 1])
wedges, texts, autotexts = ax3.pie(
    product_revenue, labels=products, autopct='%1.1f%%',
    colors=colors, startangle=90,
    wedgeprops={'edgecolor': 'white', 'linewidth': 2}
)
ax3.set_title('Product Share', fontsize=12, fontweight='bold')

# === å·¦ä¸‹æ®µ: åˆ©ç›Šç‡æ¨ç§»ï¼ˆé¢ã‚°ãƒ©ãƒ•ï¼‰===
ax4 = fig.add_subplot(gs[2, 0])
ax4.fill_between(months, profit_margin, alpha=0.5, color=colors[2])
ax4.plot(months, profit_margin, 'o-', color=colors[2], linewidth=2)
ax4.set_xlabel('Month', fontsize=11)
ax4.set_ylabel('Profit Margin (%)', fontsize=11)
ax4.set_title('Profit Margin Trend', fontsize=12, fontweight='bold')
ax4.set_ylim(30, 50)
ax4.grid(True, alpha=0.3)

# === å³ä¸‹æ®µ: åœ°åŸŸåˆ¥åˆ†å¸ƒï¼ˆç®±ã²ã’å›³ï¼‰===
ax5 = fig.add_subplot(gs[2, 1])
bp = ax5.boxplot(region_data, labels=regions, patch_artist=True)
for patch, color in zip(bp['boxes'], colors):
    patch.set_facecolor(color)
    patch.set_alpha(0.7)
ax5.set_xlabel('Region', fontsize=11)
ax5.set_ylabel('Sales', fontsize=11)
ax5.set_title('Sales Distribution by Region', fontsize=12, fontweight='bold')
ax5.grid(True, axis='y', alpha=0.3)

# å…¨ä½“ã‚¿ã‚¤ãƒˆãƒ«
fig.suptitle('Business Analysis Report - H1 2024', 
             fontsize=18, fontweight='bold', y=0.99)

# ä½™ç™½èª¿æ•´
plt.tight_layout()
plt.subplots_adjust(top=0.94, hspace=0.3, wspace=0.25)

# ä¿å­˜
fig.savefig('analysis_report_full.png', dpi=300, 
            bbox_inches='tight', facecolor='white')
fig.savefig('analysis_report_full.pdf', bbox_inches='tight')

print('Saved: analysis_report_full.png')
print('Saved: analysis_report_full.pdf')

plt.show()
```

**è§£èª¬:**
- 6ã¤ã®ã‚°ãƒ©ãƒ•ã‚’åŠ¹æœçš„ã«é…ç½®
- åŒè»¸ã€æ¨ªæ£’ã€å††ã€é¢ã‚°ãƒ©ãƒ•ã€ç®±ã²ã’ã‚’çµ„ã¿åˆã‚ã›
- çµ±ä¸€æ„Ÿã®ã‚ã‚‹ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ

</details>

---

## âœ… å¿œç”¨å•é¡Œã®ã¾ã¨ã‚

| å•é¡Œ | ãƒ†ãƒ¼ãƒ | ãƒã‚¤ãƒ³ãƒˆ |
|------|--------|----------|
| 1 | ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | 2x2ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ + åŒè»¸ |
| 2 | æ™‚ç³»åˆ—æ¯”è¼ƒ | å…±æœ‰xè»¸ã®æ´»ç”¨ |
| 3 | ä¸å‡ç­‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ | GridSpec |
| 4 | ãƒãƒƒãƒã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ | é–¢æ•°åŒ–ã¨è¤‡æ•°å½¢å¼ |
| 5 | ç·åˆãƒ¬ãƒãƒ¼ãƒˆ | å…¨æŠ€è¡“ã®çµ±åˆ |

---

## ğŸ‰ CH7å®Œäº†ï¼

ã“ã‚Œã§ã€ŒCH7: Matplotlibå…¥é–€ã€ã®å…¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒå®Œäº†ã—ã¾ã—ãŸï¼

**å­¦ã‚“ã ã“ã¨:**
- Matplotlibã®åŸºæœ¬æ¦‚å¿µï¼ˆFigure, Axesï¼‰
- æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ã€æ•£å¸ƒå›³ã€æ£’ã‚°ãƒ©ãƒ•ã€ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã€å††ã‚°ãƒ©ãƒ•ã€ç®±ã²ã’å›³
- ã‚°ãƒ©ãƒ•ã®è£…é£¾ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ã€å‡¡ä¾‹ã€ã‚°ãƒªãƒƒãƒ‰ã€æ³¨é‡ˆï¼‰
- è¤‡æ•°ã‚°ãƒ©ãƒ•ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆsubplots, GridSpecï¼‰
- æ§˜ã€…ãªå½¢å¼ã§ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

æ¬¡ã¯ã€ŒCH8: ç·åˆæ¼”ç¿’ã€ã§ã€ã“ã‚Œã¾ã§å­¦ã‚“ã å…¨ã¦ã®çŸ¥è­˜ã‚’ä½¿ã£ãŸå®Ÿè·µèª²é¡Œã«æŒ‘æˆ¦ã—ã¾ã™ï¼
