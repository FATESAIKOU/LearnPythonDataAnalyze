# Section5: è¤‡æ•°ã‚°ãƒ©ãƒ•ã¨ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ - æŠ€è¡“èª¬æ˜

## ğŸ¯ ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã¶ã“ã¨

è¤‡æ•°ã®ã‚°ãƒ©ãƒ•ã‚’åŠ¹ç‡çš„ã«é…ç½®ã™ã‚‹æ–¹æ³•ã¨ã€æ§˜ã€…ãªå½¢å¼ã§ã‚°ãƒ©ãƒ•ã‚’ä¿å­˜ã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚
ãƒ¬ãƒãƒ¼ãƒˆã‚„ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ä½¿ãˆã‚‹ã€è¦‹ã‚„ã™ã„ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’ä½œæˆã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

---

## 1. subplots ã®åŸºæœ¬

### è¤‡æ•°ã‚°ãƒ©ãƒ•ã®é…ç½®

```
ã€subplots ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€‘

  plt.subplots(2, 2) ã§ 2è¡ŒÃ—2åˆ—

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   ax[0,0]   â”‚   ax[0,1]   â”‚
  â”‚  (å·¦ä¸Š)     â”‚  (å³ä¸Š)     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚   ax[1,0]   â”‚   ax[1,1]   â”‚
  â”‚  (å·¦ä¸‹)     â”‚  (å³ä¸‹)     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```python
import matplotlib.pyplot as plt

# 2è¡Œ2åˆ—ã®ã‚°ãƒªãƒƒãƒ‰ã‚’ä½œæˆ
fig, axes = plt.subplots(2, 2, figsize=(12, 10))

x = [1, 2, 3, 4, 5]
y = [10, 20, 15, 25, 20]

# å„ã‚µãƒ–ãƒ—ãƒ­ãƒƒãƒˆã«ã‚°ãƒ©ãƒ•ã‚’æç”»
axes[0, 0].plot(x, y, 'b-o')
axes[0, 0].set_title('Line Chart')

axes[0, 1].bar(x, y, color='orange')
axes[0, 1].set_title('Bar Chart')

axes[1, 0].scatter(x, y, s=100, c='green')
axes[1, 0].set_title('Scatter Plot')

axes[1, 1].hist(y, bins=5, color='purple')
axes[1, 1].set_title('Histogram')

plt.tight_layout()
plt.show()
```

### 1è¡Œã¾ãŸã¯1åˆ—ã®å ´åˆ

```python
import matplotlib.pyplot as plt

# 1è¡Œ3åˆ—ã®å ´åˆ
fig, axes = plt.subplots(1, 3, figsize=(15, 5))

x = [1, 2, 3, 4, 5]
y = [10, 20, 15, 25, 20]

# 1æ¬¡å…ƒé…åˆ—ã¨ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹
axes[0].plot(x, y, 'r-o')
axes[0].set_title('Chart 1')

axes[1].bar(x, y)
axes[1].set_title('Chart 2')

axes[2].scatter(x, y)
axes[2].set_title('Chart 3')

plt.tight_layout()
plt.show()
```

---

## 2. æŸ”è»Ÿãªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

### gridspec ã‚’ä½¿ã£ãŸä¸å‡ç­‰ãªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

```
ã€ä¸å‡ç­‰ãªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä¾‹ã€‘

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                           â”‚
  â”‚        å¤§ãã„ã‚°ãƒ©ãƒ•        â”‚  â† 2åˆ—åˆ†ã®å¹…
  â”‚                           â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  å°ã•ã„1    â”‚  å°ã•ã„2    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```python
import matplotlib.pyplot as plt
import matplotlib.gridspec as gridspec

fig = plt.figure(figsize=(12, 8))

# GridSpec ã§ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’å®šç¾©
gs = gridspec.GridSpec(2, 2, height_ratios=[2, 1])

# ä¸Šæ®µ: 2åˆ—åˆ†ã‚’ä½¿ç”¨
ax1 = fig.add_subplot(gs[0, :])  # 0è¡Œç›®ã€å…¨åˆ—
ax1.plot([1, 2, 3, 4, 5], [10, 25, 20, 35, 30], 'b-o', linewidth=2)
ax1.set_title('Main Chart (Full Width)', fontsize=14)

# ä¸‹æ®µå·¦
ax2 = fig.add_subplot(gs[1, 0])  # 1è¡Œç›®ã€0åˆ—ç›®
ax2.bar(['A', 'B', 'C'], [20, 30, 25], color='orange')
ax2.set_title('Chart 2')

# ä¸‹æ®µå³
ax3 = fig.add_subplot(gs[1, 1])  # 1è¡Œç›®ã€1åˆ—ç›®
ax3.scatter([1, 2, 3], [10, 20, 15], s=100, c='green')
ax3.set_title('Chart 3')

plt.tight_layout()
plt.show()
```

### ã‚µã‚¤ã‚ºæ¯”ã®èª¿æ•´

```python
import matplotlib.pyplot as plt
import matplotlib.gridspec as gridspec

fig = plt.figure(figsize=(12, 8))

# å¹…ã¨é«˜ã•ã®æ¯”ç‡ã‚’æŒ‡å®š
gs = gridspec.GridSpec(2, 3, 
                       width_ratios=[2, 1, 1],    # å¹…ã®æ¯”ç‡
                       height_ratios=[1, 2])      # é«˜ã•ã®æ¯”ç‡

ax1 = fig.add_subplot(gs[0, 0])  # å·¦ä¸Šï¼ˆå¹…2ï¼‰
ax2 = fig.add_subplot(gs[0, 1])  # ä¸­ä¸Šï¼ˆå¹…1ï¼‰
ax3 = fig.add_subplot(gs[0, 2])  # å³ä¸Šï¼ˆå¹…1ï¼‰
ax4 = fig.add_subplot(gs[1, :])  # ä¸‹æ®µå…¨ä½“

# ãã‚Œãã‚Œã«ã‚°ãƒ©ãƒ•ã‚’æç”»
ax1.plot([1, 2, 3], [1, 2, 3])
ax1.set_title('Wide')

ax2.bar([1, 2], [1, 2])
ax2.set_title('Narrow 1')

ax3.scatter([1, 2], [1, 2])
ax3.set_title('Narrow 2')

ax4.bar(['A', 'B', 'C', 'D', 'E'], [5, 4, 3, 2, 1])
ax4.set_title('Full Width (Tall)')

plt.tight_layout()
plt.show()
```

---

## 3. ã‚µãƒ–ãƒ—ãƒ­ãƒƒãƒˆã®å…±æœ‰è»¸

### xè»¸ã‚’å…±æœ‰

```
ã€xè»¸ã‚’å…±æœ‰ã€‘

  åŒã˜æ™‚é–“è»¸ã§è¤‡æ•°ã®æŒ‡æ¨™ã‚’æ¯”è¼ƒ

     ^  å£²ä¸Š
     |  â—â”€â”€â”€â”€â—
     |       â•²
     |        â—
     +â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ (å…±é€šã®xè»¸)
     ^  åˆ©ç›Š
     |    â—
     |   / â•²
     |  â—   â—
     +â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ æœˆ
```

```python
import matplotlib.pyplot as plt

months = ['Jan', 'Feb', 'Mar', 'Apr', 'May']
sales = [100, 120, 110, 130, 150]
profit = [20, 25, 22, 28, 35]

# xè»¸ã‚’å…±æœ‰ï¼ˆsharex=Trueï¼‰
fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(10, 8), sharex=True)

ax1.plot(months, sales, 'b-o', linewidth=2)
ax1.set_ylabel('Sales', fontsize=12)
ax1.set_title('Sales and Profit Trend', fontsize=14)
ax1.grid(True, alpha=0.3)

ax2.plot(months, profit, 'g-s', linewidth=2)
ax2.set_ylabel('Profit', fontsize=12)
ax2.set_xlabel('Month', fontsize=12)
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()
```

### yè»¸ã‚’å…±æœ‰

```python
import matplotlib.pyplot as plt

categories = ['A', 'B', 'C', 'D']
values_2023 = [100, 80, 120, 90]
values_2024 = [120, 95, 130, 110]

# yè»¸ã‚’å…±æœ‰ï¼ˆsharey=Trueï¼‰
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5), sharey=True)

ax1.bar(categories, values_2023, color='steelblue')
ax1.set_title('2023', fontsize=14)
ax1.set_ylabel('Value', fontsize=12)

ax2.bar(categories, values_2024, color='coral')
ax2.set_title('2024', fontsize=14)

plt.tight_layout()
plt.show()
```

---

## 4. å›³ã®ä¸­ã«å›³ã‚’æŒ¿å…¥

### inset_axes ã‚’ä½¿ã£ãŸæŒ¿å…¥

```
ã€å›³ã®ä¸­ã«å›³ã‚’æŒ¿å…¥ã€‘

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                 â”‚
  â”‚    â—â”€â”€â”€â”€â—                       â”‚
  â”‚         â•²    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
  â”‚          â—   â”‚  æ‹¡å¤§å›³   â”‚     â”‚
  â”‚              â”‚   â—â—â—     â”‚     â”‚
  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
  â”‚                                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```python
import matplotlib.pyplot as plt
from mpl_toolkits.axes_grid1.inset_locator import inset_axes

x = list(range(1, 13))
y = [10, 12, 15, 18, 22, 25, 28, 30, 27, 23, 18, 14]

fig, ax = plt.subplots(figsize=(10, 6))

# ãƒ¡ã‚¤ãƒ³ã®ã‚°ãƒ©ãƒ•
ax.plot(x, y, 'b-o', linewidth=2, markersize=8)
ax.set_title('Annual Temperature Trend', fontsize=14)
ax.set_xlabel('Month', fontsize=12)
ax.set_ylabel('Temperature (Â°C)', fontsize=12)
ax.grid(True, alpha=0.3)

# æŒ¿å…¥ã‚°ãƒ©ãƒ•ã‚’ä½œæˆ
axins = inset_axes(ax, 
                   width="40%",    # å¹…ï¼ˆãƒ¡ã‚¤ãƒ³ã®40%ï¼‰
                   height="40%",   # é«˜ã•ï¼ˆãƒ¡ã‚¤ãƒ³ã®40%ï¼‰
                   loc='upper right')  # ä½ç½®

# æŒ¿å…¥ã‚°ãƒ©ãƒ•ã«ãƒ‡ãƒ¼ã‚¿ã‚’æç”»ï¼ˆå¤ã®æœŸé–“ã‚’æ‹¡å¤§ï¼‰
axins.plot(x[4:9], y[4:9], 'r-o', linewidth=2, markersize=8)
axins.set_title('Summer Detail', fontsize=10)
axins.set_xlim(5, 9)
axins.set_ylim(20, 32)

plt.tight_layout()
plt.show()
```

---

## 5. åŒè»¸ã‚°ãƒ©ãƒ•

### 2ã¤ã®yè»¸

```
ã€åŒè»¸ã‚°ãƒ©ãƒ•ã€‘

  å£²ä¸Š                            åˆ©ç›Šç‡
    ^                                ^
140 |          â—â”€â”€â”€â”€â—               | 30%
120 |     â—â”€â”€â”€â—                     | 25%
100 | â—                        â—‹â”€â—‹â”€â—‹ | 20%
 80 |                      â—‹â”€â”€â—‹    | 15%
    +â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’
       Jan Feb Mar Apr May
  
  å·¦è»¸: å£²ä¸Šï¼ˆæ£’ã‚°ãƒ©ãƒ•ï¼‰
  å³è»¸: åˆ©ç›Šç‡ï¼ˆæŠ˜ã‚Œç·šï¼‰
```

```python
import matplotlib.pyplot as plt

months = ['Jan', 'Feb', 'Mar', 'Apr', 'May']
sales = [100, 120, 115, 135, 150]
profit_rate = [15, 18, 17, 22, 25]

fig, ax1 = plt.subplots(figsize=(10, 6))

# å·¦è»¸: å£²ä¸Šï¼ˆæ£’ã‚°ãƒ©ãƒ•ï¼‰
color1 = 'steelblue'
ax1.bar(months, sales, color=color1, alpha=0.7, label='Sales')
ax1.set_xlabel('Month', fontsize=12)
ax1.set_ylabel('Sales (ä¸‡å††)', color=color1, fontsize=12)
ax1.tick_params(axis='y', labelcolor=color1)

# å³è»¸ã‚’ä½œæˆ
ax2 = ax1.twinx()

# å³è»¸: åˆ©ç›Šç‡ï¼ˆæŠ˜ã‚Œç·šï¼‰
color2 = 'coral'
ax2.plot(months, profit_rate, 'o-', color=color2, linewidth=2, markersize=8, label='Profit Rate')
ax2.set_ylabel('Profit Rate (%)', color=color2, fontsize=12)
ax2.tick_params(axis='y', labelcolor=color2)

# ã‚¿ã‚¤ãƒˆãƒ«
plt.title('Sales and Profit Rate', fontsize=14, fontweight='bold')

# å‡¡ä¾‹ã‚’ã¾ã¨ã‚ã‚‹
lines1, labels1 = ax1.get_legend_handles_labels()
lines2, labels2 = ax2.get_legend_handles_labels()
ax1.legend(lines1 + lines2, labels1 + labels2, loc='upper left')

plt.tight_layout()
plt.show()
```

---

## 6. æ§˜ã€…ãªå½¢å¼ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

### å¯¾å¿œãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

```
ã€ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹å½¢å¼ã€‘

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å½¢å¼      â”‚ æ‹¡å¼µå­     â”‚ ç”¨é€”                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PNG       â”‚ .png       â”‚ Webã€ãƒ—ãƒ¬ã‚¼ãƒ³ï¼ˆæ¨™æº–ï¼‰         â”‚
â”‚ JPEG      â”‚ .jpg       â”‚ å†™çœŸå‘ãã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºå°    â”‚
â”‚ PDF       â”‚ .pdf       â”‚ å°åˆ·ã€è«–æ–‡                    â”‚
â”‚ SVG       â”‚ .svg       â”‚ ãƒ™ã‚¯ã‚¿ãƒ¼ç”»åƒï¼ˆæ‹¡å¤§ã—ã¦ã‚‚ç¶ºéº—ï¼‰â”‚
â”‚ EPS       â”‚ .eps       â”‚ å­¦è¡“è«–æ–‡                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```python
import matplotlib.pyplot as plt

x = [1, 2, 3, 4, 5]
y = [10, 20, 15, 25, 20]

plt.figure(figsize=(10, 6))
plt.plot(x, y, 'b-o', linewidth=2)
plt.title('Sample Chart')
plt.xlabel('X')
plt.ylabel('Y')

# PNGï¼ˆWebå‘ã‘ã€é€éå¯èƒ½ï¼‰
plt.savefig('chart.png', dpi=150, bbox_inches='tight')

# PDFï¼ˆå°åˆ·å‘ã‘ã€ãƒ™ã‚¯ã‚¿ãƒ¼ï¼‰
plt.savefig('chart.pdf', bbox_inches='tight')

# SVGï¼ˆWebå‘ã‘ã€ãƒ™ã‚¯ã‚¿ãƒ¼ï¼‰
plt.savefig('chart.svg', bbox_inches='tight')

# JPEGï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºå„ªå…ˆï¼‰
plt.savefig('chart.jpg', dpi=150, bbox_inches='tight', 
            facecolor='white')  # JPEGã¯é€éä¸å¯

plt.show()
```

### ä¿å­˜ã‚ªãƒ—ã‚·ãƒ§ãƒ³

```python
import matplotlib.pyplot as plt

x = [1, 2, 3, 4, 5]
y = [10, 20, 15, 25, 20]

fig, ax = plt.subplots(figsize=(10, 6))
ax.plot(x, y, 'b-o')
ax.set_title('Chart with Options')

# è©³ç´°ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³
fig.savefig('detailed_chart.png',
            dpi=300,              # è§£åƒåº¦ï¼ˆå°åˆ·ã¯300ä»¥ä¸Šï¼‰
            bbox_inches='tight',  # ä½™ç™½ã‚’æœ€å°åŒ–
            pad_inches=0.1,       # ä½™ç™½ã®é‡
            facecolor='white',    # èƒŒæ™¯è‰²
            edgecolor='none',     # ç¸ã®è‰²
            transparent=False)    # èƒŒæ™¯ã‚’é€æ˜ã«ã™ã‚‹ã‹

plt.show()
```

---

## 7. å®Ÿè·µï¼šåˆ†æãƒ¬ãƒãƒ¼ãƒˆ

```python
import matplotlib.pyplot as plt
import matplotlib.gridspec as gridspec
import numpy as np
import random

random.seed(42)

# === ãƒ‡ãƒ¼ã‚¿æº–å‚™ ===
months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun']
sales = [100, 115, 108, 130, 145, 160]
target = [105, 110, 115, 120, 130, 145]
profit_rate = [12, 14, 13, 16, 18, 20]

products = ['Product A', 'Product B', 'Product C', 'Product D']
product_sales = [40, 28, 20, 12]

regions = ['Tokyo', 'Osaka', 'Nagoya', 'Fukuoka']
region_sales = [
    [random.gauss(100, 15) for _ in range(20)],
    [random.gauss(80, 12) for _ in range(20)],
    [random.gauss(70, 10) for _ in range(20)],
    [random.gauss(60, 8) for _ in range(20)]
]

# === ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä½œæˆ ===
fig = plt.figure(figsize=(16, 12))
gs = gridspec.GridSpec(3, 2, height_ratios=[1.5, 1, 1])

# === ä¸Šæ®µ: å£²ä¸Šæ¨ç§»ï¼ˆå…¨å¹…ï¼‰===
ax1 = fig.add_subplot(gs[0, :])
ax1.plot(months, sales, 'o-', color='#3498db', linewidth=2.5, 
         markersize=10, label='Actual Sales')
ax1.plot(months, target, 's--', color='#e74c3c', linewidth=2, 
         markersize=8, label='Target')

# åŒè»¸ã§åˆ©ç›Šç‡ã‚’è¿½åŠ 
ax1_twin = ax1.twinx()
ax1_twin.fill_between(months, profit_rate, alpha=0.3, color='#2ecc71')
ax1_twin.plot(months, profit_rate, '^-', color='#27ae60', 
              linewidth=2, markersize=8, label='Profit Rate')
ax1_twin.set_ylabel('Profit Rate (%)', color='#27ae60', fontsize=12)
ax1_twin.tick_params(axis='y', labelcolor='#27ae60')

ax1.set_title('Sales Performance Overview', fontsize=16, fontweight='bold')
ax1.set_xlabel('Month', fontsize=12)
ax1.set_ylabel('Sales (ä¸‡å††)', fontsize=12)
ax1.legend(loc='upper left', fontsize=10)
ax1_twin.legend(loc='upper right', fontsize=10)
ax1.grid(True, axis='y', alpha=0.3)
ax1.spines['top'].set_visible(False)

# === ä¸­æ®µå·¦: è£½å“åˆ¥å£²ä¸Šï¼ˆå††ã‚°ãƒ©ãƒ•ï¼‰===
ax2 = fig.add_subplot(gs[1, 0])
colors = ['#3498db', '#e74c3c', '#2ecc71', '#f39c12']
wedges, texts, autotexts = ax2.pie(
    product_sales, labels=products, autopct='%1.1f%%',
    startangle=90, colors=colors,
    wedgeprops={'edgecolor': 'white', 'linewidth': 2}
)
ax2.set_title('Sales by Product', fontsize=14, fontweight='bold')

# === ä¸­æ®µå³: åœ°åŸŸåˆ¥åˆ†å¸ƒï¼ˆç®±ã²ã’å›³ï¼‰===
ax3 = fig.add_subplot(gs[1, 1])
bp = ax3.boxplot(region_sales, labels=regions, patch_artist=True)
for patch, color in zip(bp['boxes'], colors):
    patch.set_facecolor(color)
    patch.set_alpha(0.7)
ax3.set_title('Sales Distribution by Region', fontsize=14, fontweight='bold')
ax3.set_ylabel('Sales', fontsize=12)
ax3.grid(True, axis='y', alpha=0.3)

# === ä¸‹æ®µå·¦: ç›®æ¨™é”æˆç‡ï¼ˆæ£’ã‚°ãƒ©ãƒ•ï¼‰===
ax4 = fig.add_subplot(gs[2, 0])
achievement = [s/t*100 for s, t in zip(sales, target)]
bars = ax4.bar(months, achievement, color=['#27ae60' if a >= 100 else '#e74c3c' for a in achievement])
ax4.axhline(y=100, color='gray', linestyle='--', linewidth=1)
ax4.set_title('Target Achievement Rate', fontsize=14, fontweight='bold')
ax4.set_ylabel('Achievement (%)', fontsize=12)
ax4.set_ylim(80, 120)

# å€¤ã‚’è¡¨ç¤º
for bar, val in zip(bars, achievement):
    ax4.text(bar.get_x() + bar.get_width()/2, bar.get_height() + 1,
             f'{val:.1f}%', ha='center', fontsize=9)

# === ä¸‹æ®µå³: åœ°åŸŸåˆ¥å£²ä¸Šï¼ˆæ¨ªæ£’ã‚°ãƒ©ãƒ•ï¼‰===
ax5 = fig.add_subplot(gs[2, 1])
region_totals = [sum(r) for r in region_sales]
bars = ax5.barh(regions, region_totals, color=colors, edgecolor='white')
ax5.set_title('Total Sales by Region', fontsize=14, fontweight='bold')
ax5.set_xlabel('Total Sales', fontsize=12)

# å€¤ã‚’è¡¨ç¤º
for bar, val in zip(bars, region_totals):
    ax5.text(val + 20, bar.get_y() + bar.get_height()/2,
             f'{val:.0f}', va='center', fontsize=10)

# === å…¨ä½“ã®èª¿æ•´ ===
fig.suptitle('Sales Analysis Report - Q2 2024', 
             fontsize=20, fontweight='bold', y=0.98)

plt.tight_layout()
plt.subplots_adjust(top=0.93)

# è¤‡æ•°å½¢å¼ã§ä¿å­˜
fig.savefig('analysis_report.png', dpi=300, bbox_inches='tight', facecolor='white')
fig.savefig('analysis_report.pdf', bbox_inches='tight')

plt.show()
```

---

## âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨

1. **subplots**: è¤‡æ•°ã‚°ãƒ©ãƒ•ã®åŸºæœ¬é…ç½®
2. **gridspec**: ä¸å‡ç­‰ãªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
3. **å…±æœ‰è»¸**: sharex, sharey
4. **æŒ¿å…¥ã‚°ãƒ©ãƒ•**: inset_axes
5. **åŒè»¸ã‚°ãƒ©ãƒ•**: twinx()
6. **ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**: PNG, PDF, SVG ãªã©

---

## ğŸ‰ CH7å®Œäº†ï¼

CH7ã€ŒMatplotlibå…¥é–€ã€ã®å…¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Œäº†ã—ã¾ã—ãŸï¼
æ¬¡ã¯ã€ŒCH8: ç·åˆæ¼”ç¿’ã€ã§ã€ã“ã‚Œã¾ã§å­¦ã‚“ã å…¨ã¦ã‚’ä½¿ã£ãŸå®Ÿè·µèª²é¡Œã«æŒ‘æˆ¦ã—ã¾ã™ã€‚
