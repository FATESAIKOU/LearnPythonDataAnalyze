# CH7: Matplotlib 入門 - なぜこの章を学ぶのか？

## 🎯 この章を学ぶ目的

データ分析をして「結果」が出ても、それを**人に伝えられなければ意味がありません**。

Excel でグラフを作成した経験はありますか？
グラフ作成は、毎回マウスでクリックして、色を調整して、タイトルを入力して...
データが更新されたら、また同じ作業を繰り返す必要がありますよね？

この章を学ぶと、**コードでグラフを作成**できるようになります。
一度コードを書けば、データが変わっても再実行するだけで同じグラフが作れます。
レポート用の美しいグラフを**何度でも再現可能**な形で作成できるようになります。

---

## ✅ この章を学ぶための前提条件

```
┌─────────────────────────────────────────────────────────────────┐
│                      学習の前提条件                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ✅ 条件 1: CH5 の内容を理解している                            │
│     ─────────────────────────────────────────────────           │
│     • DataFrame の作成と基本操作ができる                        │
│     • CSV/Excel ファイルを読み込める                            │
│     • データのフィルタリングができる                            │
│                                                                 │
│  ✅ 条件 2: Excel でグラフを作成した経験がある                  │
│     ─────────────────────────────────────────────────           │
│     • 棒グラフ、折れ線グラフ、円グラフなどを作ったことがある    │
│     • 「どんなグラフで何を表現するか」の感覚がある              │
│                                                                 │
│  ✅ 条件 3: 分析結果を誰かに見せたい場面がある                  │
│     ─────────────────────────────────────────────────           │
│     • レポートや報告書を作成する業務がある                      │
│     • 数値だけでなく視覚的に伝えたいと思ったことがある          │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🔄 この章を学ぶと何が変わるのか？（As-Is / To-Be 比較）

### 変化1: グラフ作成が再現可能になる

**シナリオ**: 月次レポート用のグラフを毎月作成している

```
┌─────────────────────────────────────────────────────────────────────────┐
│  📊 As-Is: Excel の場合                                                 │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   毎月の作業:                                                           │
│   ┌────────────────────────────────────────────────────────────────┐    │
│   │  ① 新しいデータをコピー＆貼り付け                             │    │
│   │  ② 範囲を選択して [挿入] → [グラフ]                           │    │
│   │  ③ グラフの種類を選択                                         │    │
│   │  ④ タイトルを入力                                             │    │
│   │  ⑤ 色を調整                                                   │    │
│   │  ⑥ 凡例の位置を調整                                           │    │
│   │  ⑦ 軸のラベルを設定                                           │    │
│   │  ⑧ 先月のグラフと見比べて同じスタイルに調整                   │    │
│   └────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│   😰 問題点:                                                            │
│   • 毎回同じ作業を繰り返す必要がある                                    │
│   • 前回と同じスタイルにするのが難しい（色や書式がずれる）              │
│   • 作業者によって仕上がりがバラバラになる                              │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│  🐍 To-Be: Matplotlib の場合                                            │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  import matplotlib.pyplot as plt                                │   │
│   │  import pandas as pd                                            │   │
│   │                                                                 │   │
│   │  # データを読み込む（ファイル名を変えるだけ）                   │   │
│   │  df = pd.read_csv("sales_202312.csv")                           │   │
│   │                                                                 │   │
│   │  # グラフを作成（毎回同じコード）                               │   │
│   │  plt.figure(figsize=(10, 6))                                    │   │
│   │  plt.bar(df["支店"], df["売上"], color="steelblue")             │   │
│   │  plt.title("月次売上レポート", fontsize=16)                     │   │
│   │  plt.xlabel("支店")                                             │   │
│   │  plt.ylabel("売上（万円）")                                     │   │
│   │  plt.savefig("monthly_report.png", dpi=150)                     │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   😊 利点:                                                              │
│   • データファイル名を変えて再実行するだけ                              │
│   • 毎月まったく同じスタイルのグラフが作成される                        │
│   • 誰が実行しても同じ結果になる                                        │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

### 変化2: 複数のグラフを一括作成できる

**シナリオ**: 10 支店分のグラフを別々に作成したい

```
┌─────────────────────────────────────────────────────────────────────────┐
│  📊 As-Is: Excel の場合                                                 │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   作業手順:                                                             │
│   ┌────────────────────────────────────────────────────────────────┐    │
│   │  ① 東京支店のデータを選択 → グラフ作成 → 保存                 │    │
│   │  ② 大阪支店のデータを選択 → グラフ作成 → 保存                 │    │
│   │  ③ 名古屋支店のデータを選択 → グラフ作成 → 保存               │    │
│   │  ...                                                           │    │
│   │  ⑩ 福岡支店のデータを選択 → グラフ作成 → 保存                 │    │
│   └────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│   😰 問題点:                                                            │
│   • 10 回同じ作業を繰り返す必要がある                                   │
│   • 1 つでもミスすると最初からやり直し                                  │
│   • 支店が増えるたびに作業が増える                                      │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│  🐍 To-Be: Matplotlib の場合                                            │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  # 支店ごとにグラフを自動生成                                   │   │
│   │  for branch in df["支店"].unique():                             │   │
│   │      branch_data = df[df["支店"] == branch]                     │   │
│   │                                                                 │   │
│   │      plt.figure()                                               │   │
│   │      plt.plot(branch_data["月"], branch_data["売上"])           │   │
│   │      plt.title(f"{branch}支店 売上推移")                        │   │
│   │      plt.savefig(f"{branch}_sales.png")                         │   │
│   │      plt.close()                                                │   │
│   │                                                                 │   │
│   │  # → 10 個のグラフが自動で保存される！                          │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   結果:                                                                 │
│   ┌────────────────────────────────────────────────────────────────┐    │
│   │  📁 output/                                                    │    │
│   │     ├── 東京_sales.png                                         │    │
│   │     ├── 大阪_sales.png                                         │    │
│   │     ├── 名古屋_sales.png                                       │    │
│   │     └── ... （全 10 ファイル自動生成）                         │    │
│   └────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│   😊 利点:                                                              │
│   • ループ処理で何個でも自動生成                                        │
│   • 支店が増えてもコードの変更不要                                      │
│   • 全グラフが同じスタイルで統一される                                  │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

### 変化3: データから直接グラフを作成できる

**シナリオ**: DataFrame の内容をすぐにグラフで確認したい

```
┌─────────────────────────────────────────────────────────────────────────┐
│  📊 As-Is: Excel の場合                                                 │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   Python で集計                        Excel でグラフ化                 │
│   ┌─────────────────┐                  ┌─────────────────┐              │
│   │ df.groupby()    │ ──→ CSV ──→      │ ファイルを開く  │              │
│   │ で集計          │     出力         │ グラフ作成      │              │
│   └─────────────────┘                  └─────────────────┘              │
│                                                                         │
│   😰 問題点:                                                            │
│   • Python と Excel を行き来する必要がある                              │
│   • CSV に出力する手間がかかる                                          │
│   • 分析のフローが中断される                                            │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│  🐍 To-Be: Matplotlib の場合                                            │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │  # 集計からグラフ表示まで一気に                                 │   │
│   │  monthly_sales = df.groupby("月")["売上"].sum()                 │   │
│   │                                                                 │   │
│   │  # Pandas から直接グラフ作成                                    │   │
│   │  monthly_sales.plot(kind="bar", title="月別売上")               │   │
│   │  plt.show()                                                     │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   表示結果:                                                             │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │                                                                 │   │
│   │   売上 ▲                        月別売上                        │   │
│   │    500│       ████                                              │   │
│   │    400│ ████  ████  ████                                        │   │
│   │    300│ ████  ████  ████  ████                                  │   │
│   │    200│ ████  ████  ████  ████                                  │   │
│   │    100│ ████  ████  ████  ████                                  │   │
│   │      0└──────────────────────────▶ 月                           │   │
│   │         1月   2月   3月   4月                                   │   │
│   │                                                                 │   │
│   └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│   😊 利点:                                                              │
│   • 分析からグラフ表示まで Python 内で完結                              │
│   • df.plot() で DataFrame から直接グラフ作成                           │
│   • 探索的な分析がスムーズに行える                                      │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 📚 この章で学ぶ内容

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          Chapter 7 の構成                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  Section 1: Matplotlib の基本                                           │
│  ────────────────────────────                                           │
│  → import、基本的なプロット、日本語表示設定                             │
│                                                                         │
│  Section 2: 折れ線グラフと散布図                                        │
│  ────────────────────────────────                                       │
│  → 時系列データの可視化、相関関係の表示                                 │
│                                                                         │
│  Section 3: 棒グラフとヒストグラム                                      │
│  ──────────────────────────────────                                     │
│  → カテゴリ比較、データ分布の可視化                                     │
│                                                                         │
│  Section 4: グラフの装飾                                                │
│  ──────────────────────────                                             │
│  → タイトル、ラベル、凡例、色、スタイル設定                             │
│                                                                         │
│  Section 5: 複数グラフとエクスポート                                    │
│  ────────────────────────────────────                                   │
│  → サブプロット配置、画像保存（PNG/PDF）                                │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 🚀 学習を始めましょう

この章を学ぶと、分析結果を「見せる」力が身につきます。

数値を表で見せるより、グラフで見せた方が：
- **傾向がひと目でわかる**
- **異常値に気づきやすい**
- **説得力が増す**

さらに、コードでグラフを作成することで：
- **再現性が確保**される
- **自動化**ができる
- **バージョン管理**もできる

Excel のグラフ作成を「コード化」して、より効率的なレポート作成を目指しましょう！
