# Section1: ãƒ‡ãƒ¼ã‚¿ã®ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚° - å¿œç”¨å•é¡Œ

## ğŸ¯ ã“ã®å¿œç”¨å•é¡Œã®ç›®çš„

å®Ÿéš›ã®ãƒ“ã‚¸ãƒã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’æƒ³å®šã—ã€
è¤‡åˆçš„ãªãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ä½œæ¥­ã‚’é€šã˜ã¦å®Ÿè·µåŠ›ã‚’é¤Šã„ã¾ã™ã€‚

---

## ğŸš€ å¿œç”¨å•é¡Œ1: é¡§å®¢ãƒ‡ãƒ¼ã‚¿ã®ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°

### å•é¡Œ

ä»¥ä¸‹ã®é¡§å®¢ãƒ‡ãƒ¼ã‚¿ã«ã¯æ§˜ã€…ãªå•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚
ã™ã¹ã¦ã®å•é¡Œã‚’è§£æ±ºã—ã¦ã€ãã‚Œã„ãªãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({
    "é¡§å®¢ID": ["C001", "C002", "C003", "C001", "C004", "C005"],
    "åå‰": ["  ç”°ä¸­å¤ªéƒ  ", "ä½è—¤èŠ±å­", None, "  ç”°ä¸­å¤ªéƒ  ", "éˆ´æœ¨ä¸€éƒ", "é«˜æ©‹"],
    "å¹´é½¢": ["35", np.nan, "28", "35", "42", "30"],
    "éƒ½é“åºœçœŒ": ["tokyo", "OSAKA", "æ±äº¬", "tokyo", "  æ„›çŸ¥  ", "fukuoka"],
    "ãƒ¡ãƒ¼ãƒ«": ["tanaka@example.com", None, "suzuki@test.com", 
               "tanaka@example.com", "one@mail.jp", "takahashi@abc.co.jp"]
})
```

å•é¡Œç‚¹ï¼š
1. åå‰ã«ç©ºç™½ãŒå«ã¾ã‚Œã¦ã„ã‚‹
2. åå‰ã«æ¬ æå€¤ãŒã‚ã‚‹
3. å¹´é½¢ãŒæ–‡å­—åˆ—ã«ãªã£ã¦ã„ã‚‹
4. å¹´é½¢ã«æ¬ æå€¤ãŒã‚ã‚‹
5. éƒ½é“åºœçœŒã®è¡¨è¨˜ãŒãƒãƒ©ãƒãƒ©
6. é‡è¤‡ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹

ã™ã¹ã¦ã®å•é¡Œã‚’è§£æ±ºã—ã¦ãã ã•ã„ã€‚

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

### åŸºæœ¬è§£æ³•ï¼ˆã‚¹ãƒ†ãƒƒãƒ—ã”ã¨ã«å‡¦ç†ï¼‰

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({
    "é¡§å®¢ID": ["C001", "C002", "C003", "C001", "C004", "C005"],
    "åå‰": ["  ç”°ä¸­å¤ªéƒ  ", "ä½è—¤èŠ±å­", None, "  ç”°ä¸­å¤ªéƒ  ", "éˆ´æœ¨ä¸€éƒ", "é«˜æ©‹"],
    "å¹´é½¢": ["35", np.nan, "28", "35", "42", "30"],
    "éƒ½é“åºœçœŒ": ["tokyo", "OSAKA", "æ±äº¬", "tokyo", "  æ„›çŸ¥  ", "fukuoka"],
    "ãƒ¡ãƒ¼ãƒ«": ["tanaka@example.com", None, "suzuki@test.com", 
               "tanaka@example.com", "one@mail.jp", "takahashi@abc.co.jp"]
})

print("=== ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å‰ ===")
print(df)
print(f"\nè¡Œæ•°: {len(df)}")
print(f"æ¬ æå€¤æ•°: {df.isnull().sum().sum()}")
print(f"é‡è¤‡æ•°: {df.duplicated().sum()}")
print()

# ===== Step 1: åå‰ã®ç©ºç™½ã‚’å‰Šé™¤ =====

# åŸºæœ¬è§£æ³•ï¼šãƒ«ãƒ¼ãƒ—ã§å‡¦ç†
cleaned_names = []
for i in range(len(df)):
    name = df.iloc[i]["åå‰"]
    if name is not None and isinstance(name, str):
        cleaned_names.append(name.strip())
    else:
        cleaned_names.append(name)

df["åå‰"] = cleaned_names

print("=== Step 1: åå‰ã®ç©ºç™½ã‚’å‰Šé™¤ ===")
print(df["åå‰"])
print()

# ===== Step 2: åå‰ã®æ¬ æå€¤ã‚’å‰Šé™¤ =====

# åå‰ãŒæ¬ æã—ã¦ã„ã‚‹è¡Œã‚’å‰Šé™¤
df_list = []
for i in range(len(df)):
    if df.iloc[i]["åå‰"] is not None and not pd.isna(df.iloc[i]["åå‰"]):
        df_list.append(df.iloc[i])

df = pd.DataFrame(df_list)

print("=== Step 2: åå‰ã®æ¬ æã‚’å‰Šé™¤ ===")
print(f"è¡Œæ•°: {len(df)}")
print()

# ===== Step 3: å¹´é½¢ã®æ¬ æå€¤ã‚’è£œå®Œã—ã¦æ•´æ•°ã«å¤‰æ› =====

# æ¬ æå€¤ã‚’å¹³å‡å€¤ã§è£œå®Œ
ages = []
total = 0
count = 0
for i in range(len(df)):
    age = df.iloc[i]["å¹´é½¢"]
    if age is not None and not pd.isna(age):
        total = total + float(age)
        count = count + 1

mean_age = total / count if count > 0 else 0

# æ¬ æå€¤ã‚’è£œå®Œ
filled_ages = []
for i in range(len(df)):
    age = df.iloc[i]["å¹´é½¢"]
    if age is None or pd.isna(age):
        filled_ages.append(int(mean_age))
    else:
        filled_ages.append(int(float(age)))

df["å¹´é½¢"] = filled_ages

print("=== Step 3: å¹´é½¢ã‚’æ•´æ•°ã«å¤‰æ›ï¼ˆæ¬ æã¯å¹³å‡å€¤ã§è£œå®Œï¼‰===")
print(df["å¹´é½¢"])
print()

# ===== Step 4: éƒ½é“åºœçœŒã‚’å¤§æ–‡å­—ã«çµ±ä¸€ã—ã¦ç©ºç™½ã‚’å‰Šé™¤ =====

cleaned_pref = []
for i in range(len(df)):
    pref = df.iloc[i]["éƒ½é“åºœçœŒ"]
    if isinstance(pref, str):
        cleaned_pref.append(pref.strip().upper())
    else:
        cleaned_pref.append(pref)

df["éƒ½é“åºœçœŒ"] = cleaned_pref

print("=== Step 4: éƒ½é“åºœçœŒã‚’å¤§æ–‡å­—ã«çµ±ä¸€ ===")
print(df["éƒ½é“åºœçœŒ"])
print()

# ===== Step 5: é‡è¤‡ã‚’å‰Šé™¤ =====

# é‡è¤‡ã‚’ç¢ºèª
dup_count = 0
seen = []
for i in range(len(df)):
    row = (df.iloc[i]["é¡§å®¢ID"], df.iloc[i]["åå‰"])
    if row in seen:
        dup_count = dup_count + 1
    else:
        seen.append(row)

print(f"é‡è¤‡æ•°: {dup_count}")

# Pandasã®æ©Ÿèƒ½ã§é‡è¤‡ã‚’å‰Šé™¤
df = df.drop_duplicates(subset=["é¡§å®¢ID"])

print("=== Step 5: é‡è¤‡ã‚’å‰Šé™¤ ===")
print(df)
print()

# ===== æœ€çµ‚çµæœ =====

print("=== ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å¾Œ ===")
print(df)
print(f"\nè¡Œæ•°: {len(df)}")
print(f"æ¬ æå€¤æ•°: {df.isnull().sum().sum()}")
print(f"é‡è¤‡æ•°: {df.duplicated().sum()}")
print(f"ãƒ‡ãƒ¼ã‚¿å‹:\n{df.dtypes}")
```

**å®Ÿè¡Œçµæœ:**
```
=== ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å‰ ===
  é¡§å®¢ID         åå‰  å¹´é½¢    éƒ½é“åºœçœŒ                ãƒ¡ãƒ¼ãƒ«
0   C001    ç”°ä¸­å¤ªéƒ    35     tokyo    tanaka@example.com
1   C002      ä½è—¤èŠ±å­   NaN     OSAKA                  None
2   C003         None    28       æ±äº¬       suzuki@test.com
3   C001    ç”°ä¸­å¤ªéƒ    35     tokyo    tanaka@example.com
4   C004      éˆ´æœ¨ä¸€éƒ    42     æ„›çŸ¥           one@mail.jp
5   C005         é«˜æ©‹    30   fukuoka   takahashi@abc.co.jp

è¡Œæ•°: 6
æ¬ æå€¤æ•°: 3
é‡è¤‡æ•°: 1

=== ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å¾Œ ===
  é¡§å®¢ID      åå‰  å¹´é½¢   éƒ½é“åºœçœŒ                ãƒ¡ãƒ¼ãƒ«
0   C001  ç”°ä¸­å¤ªéƒ    35     TOKYO    tanaka@example.com
1   C002  ä½è—¤èŠ±å­    35     OSAKA                  None
4   C004  éˆ´æœ¨ä¸€éƒ    42      æ„›çŸ¥           one@mail.jp
5   C005      é«˜æ©‹    30   FUKUOKA   takahashi@abc.co.jp

è¡Œæ•°: 4
æ¬ æå€¤æ•°: 1
é‡è¤‡æ•°: 0
```

---

### ç™ºå±•è§£æ³•ï¼ˆPandas ã®æ©Ÿèƒ½ã‚’æ´»ç”¨ï¼‰

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({
    "é¡§å®¢ID": ["C001", "C002", "C003", "C001", "C004", "C005"],
    "åå‰": ["  ç”°ä¸­å¤ªéƒ  ", "ä½è—¤èŠ±å­", None, "  ç”°ä¸­å¤ªéƒ  ", "éˆ´æœ¨ä¸€éƒ", "é«˜æ©‹"],
    "å¹´é½¢": ["35", np.nan, "28", "35", "42", "30"],
    "éƒ½é“åºœçœŒ": ["tokyo", "OSAKA", "æ±äº¬", "tokyo", "  æ„›çŸ¥  ", "fukuoka"],
    "ãƒ¡ãƒ¼ãƒ«": ["tanaka@example.com", None, "suzuki@test.com", 
               "tanaka@example.com", "one@mail.jp", "takahashi@abc.co.jp"]
})

# ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ã§ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°
df_cleaned = (df
    .assign(åå‰=df["åå‰"].str.strip())              # åå‰ã®ç©ºç™½å‰Šé™¤
    .dropna(subset=["åå‰"])                          # åå‰ã®æ¬ æã‚’å‰Šé™¤
    .assign(å¹´é½¢=lambda x: x["å¹´é½¢"].fillna(x["å¹´é½¢"].astype(float).mean()))  # å¹´é½¢ã®æ¬ æã‚’å¹³å‡ã§è£œå®Œ
    .assign(å¹´é½¢=lambda x: x["å¹´é½¢"].astype(int))     # å¹´é½¢ã‚’æ•´æ•°ã«
    .assign(éƒ½é“åºœçœŒ=df["éƒ½é“åºœçœŒ"].str.strip().str.upper())  # éƒ½é“åºœçœŒã‚’æ•´å½¢
    .drop_duplicates(subset=["é¡§å®¢ID"])               # é‡è¤‡å‰Šé™¤
)

print(df_cleaned)
```

</details>

---

## ğŸš€ å¿œç”¨å•é¡Œ2: å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã®ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°

### å•é¡Œ

ä»¥ä¸‹ã®å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã—ã€æœˆåˆ¥å£²ä¸Šã‚’é›†è¨ˆã—ã¦ãã ã•ã„ã€‚

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({
    "æ—¥ä»˜": ["2024-01-15", "2024-01-20", "2024-02-10", "2024-02-10", 
             "2024-02-25", "2024-03-05", "2024-03-15", "2024-03-15"],
    "åº—èˆ—": ["  æ±äº¬  ", "OSAKA", "æ±äº¬", "OSAKA", "tokyo", "å¤§é˜ª", "  æ±äº¬", "OSAKA"],
    "å•†å“": ["A", "B", "A", "B", "A", None, "B", "B"],
    "æ•°é‡": ["10", "5", np.nan, "8", "12", "6", "15", "8"],
    "å˜ä¾¡": [100, 200, 100, 200, 100, 200, 200, 200]
})
```

1. åº—èˆ—åã®ç©ºç™½ã‚’å‰Šé™¤ã—ã€è¡¨è¨˜ã‚’çµ±ä¸€ï¼ˆã™ã¹ã¦æ—¥æœ¬èªã«ï¼‰
2. å•†å“ãŒæ¬ æã—ã¦ã„ã‚‹è¡Œã‚’å‰Šé™¤
3. æ•°é‡ã®æ¬ æã‚’ 0 ã§è£œå®Œã—ã€æ•´æ•°ã«å¤‰æ›
4. å£²ä¸Šåˆ—ï¼ˆæ•°é‡ Ã— å˜ä¾¡ï¼‰ã‚’è¿½åŠ 
5. é‡è¤‡ã‚’å‰Šé™¤
6. ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å¾Œã®ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

### åŸºæœ¬è§£æ³•ï¼ˆã‚¹ãƒ†ãƒƒãƒ—ã”ã¨ã«å‡¦ç†ï¼‰

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({
    "æ—¥ä»˜": ["2024-01-15", "2024-01-20", "2024-02-10", "2024-02-10", 
             "2024-02-25", "2024-03-05", "2024-03-15", "2024-03-15"],
    "åº—èˆ—": ["  æ±äº¬  ", "OSAKA", "æ±äº¬", "OSAKA", "tokyo", "å¤§é˜ª", "  æ±äº¬", "OSAKA"],
    "å•†å“": ["A", "B", "A", "B", "A", None, "B", "B"],
    "æ•°é‡": ["10", "5", np.nan, "8", "12", "6", "15", "8"],
    "å˜ä¾¡": [100, 200, 100, 200, 100, 200, 200, 200]
})

print("=== ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å‰ ===")
print(df)
print()

# ===== Step 1: åº—èˆ—åã®ç©ºç™½ã‚’å‰Šé™¤ã—ã€è¡¨è¨˜ã‚’çµ±ä¸€ =====

# åº—èˆ—åã®å¤‰æ›ãƒãƒƒãƒ—
store_map = {
    "OSAKA": "å¤§é˜ª",
    "osaka": "å¤§é˜ª",
    "tokyo": "æ±äº¬",
    "TOKYO": "æ±äº¬"
}

cleaned_stores = []
for i in range(len(df)):
    store = df.iloc[i]["åº—èˆ—"]
    if isinstance(store, str):
        store = store.strip()  # ç©ºç™½å‰Šé™¤
        # ãƒãƒƒãƒ—ã«å­˜åœ¨ã™ã‚Œã°å¤‰æ›
        if store in store_map:
            store = store_map[store]
    cleaned_stores.append(store)

df["åº—èˆ—"] = cleaned_stores

print("=== Step 1: åº—èˆ—åã‚’çµ±ä¸€ ===")
print(df["åº—èˆ—"].value_counts())
print()

# ===== Step 2: å•†å“ãŒæ¬ æã—ã¦ã„ã‚‹è¡Œã‚’å‰Šé™¤ =====

df_list = []
for i in range(len(df)):
    if df.iloc[i]["å•†å“"] is not None and not pd.isna(df.iloc[i]["å•†å“"]):
        df_list.append(df.iloc[i])

df = pd.DataFrame(df_list)

print("=== Step 2: å•†å“ã®æ¬ æã‚’å‰Šé™¤ ===")
print(f"è¡Œæ•°: {len(df)}")
print()

# ===== Step 3: æ•°é‡ã®æ¬ æã‚’ 0 ã§è£œå®Œã—ã€æ•´æ•°ã«å¤‰æ› =====

filled_qty = []
for i in range(len(df)):
    qty = df.iloc[i]["æ•°é‡"]
    if qty is None or pd.isna(qty):
        filled_qty.append(0)
    else:
        filled_qty.append(int(float(qty)))

df["æ•°é‡"] = filled_qty

print("=== Step 3: æ•°é‡ã‚’æ•´æ•°ã«å¤‰æ› ===")
print(df["æ•°é‡"])
print()

# ===== Step 4: å£²ä¸Šåˆ—ã‚’è¿½åŠ  =====

sales = []
for i in range(len(df)):
    qty = df.iloc[i]["æ•°é‡"]
    price = df.iloc[i]["å˜ä¾¡"]
    sales.append(qty * price)

df["å£²ä¸Š"] = sales

print("=== Step 4: å£²ä¸Šåˆ—ã‚’è¿½åŠ  ===")
print(df[["æ•°é‡", "å˜ä¾¡", "å£²ä¸Š"]])
print()

# ===== Step 5: é‡è¤‡ã‚’å‰Šé™¤ =====

df = df.drop_duplicates()

print("=== Step 5: é‡è¤‡ã‚’å‰Šé™¤ ===")
print(f"è¡Œæ•°: {len(df)}")
print()

# ===== Step 6: ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å¾Œã®ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª =====

print("=== ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å¾Œã®ãƒ‡ãƒ¼ã‚¿ ===")
print(df)
print()

# åº—èˆ—åˆ¥å£²ä¸Šé›†è¨ˆ
print("=== åº—èˆ—åˆ¥å£²ä¸Š ===")
store_sales = {}
for i in range(len(df)):
    store = df.iloc[i]["åº—èˆ—"]
    sale = df.iloc[i]["å£²ä¸Š"]
    if store in store_sales:
        store_sales[store] = store_sales[store] + sale
    else:
        store_sales[store] = sale

for store, total in store_sales.items():
    print(f"{store}: {total:,}å††")
```

**å®Ÿè¡Œçµæœ:**
```
=== ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å‰ ===
          æ—¥ä»˜      åº—èˆ— å•†å“  æ•°é‡  å˜ä¾¡
0   2024-01-15    æ±äº¬     A    10   100
1   2024-01-20     OSAKA    B     5   200
2   2024-02-10      æ±äº¬    A   NaN   100
3   2024-02-10     OSAKA    B     8   200
4   2024-02-25     tokyo    A    12   100
5   2024-03-05      å¤§é˜ª  None     6   200
6   2024-03-15    æ±äº¬     B    15   200
7   2024-03-15     OSAKA    B     8   200

=== ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å¾Œã®ãƒ‡ãƒ¼ã‚¿ ===
          æ—¥ä»˜  åº—èˆ— å•†å“  æ•°é‡  å˜ä¾¡    å£²ä¸Š
0   2024-01-15  æ±äº¬    A    10   100   1000
1   2024-01-20  å¤§é˜ª    B     5   200   1000
2   2024-02-10  æ±äº¬    A     0   100      0
3   2024-02-10  å¤§é˜ª    B     8   200   1600
4   2024-02-25  æ±äº¬    A    12   100   1200
6   2024-03-15  æ±äº¬    B    15   200   3000
7   2024-03-15  å¤§é˜ª    B     8   200   1600

=== åº—èˆ—åˆ¥å£²ä¸Š ===
æ±äº¬: 5,200å††
å¤§é˜ª: 4,200å††
```

---

### ç™ºå±•è§£æ³•ï¼ˆPandas ã®æ©Ÿèƒ½ã‚’æ´»ç”¨ï¼‰

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({
    "æ—¥ä»˜": ["2024-01-15", "2024-01-20", "2024-02-10", "2024-02-10", 
             "2024-02-25", "2024-03-05", "2024-03-15", "2024-03-15"],
    "åº—èˆ—": ["  æ±äº¬  ", "OSAKA", "æ±äº¬", "OSAKA", "tokyo", "å¤§é˜ª", "  æ±äº¬", "OSAKA"],
    "å•†å“": ["A", "B", "A", "B", "A", None, "B", "B"],
    "æ•°é‡": ["10", "5", np.nan, "8", "12", "6", "15", "8"],
    "å˜ä¾¡": [100, 200, 100, 200, 100, 200, 200, 200]
})

# åº—èˆ—åã®å¤‰æ›ãƒãƒƒãƒ—
store_map = {"OSAKA": "å¤§é˜ª", "osaka": "å¤§é˜ª", "tokyo": "æ±äº¬", "TOKYO": "æ±äº¬"}

df_cleaned = (df
    .assign(åº—èˆ—=df["åº—èˆ—"].str.strip().replace(store_map))
    .dropna(subset=["å•†å“"])
    .assign(æ•°é‡=lambda x: x["æ•°é‡"].fillna(0).astype(int))
    .assign(å£²ä¸Š=lambda x: x["æ•°é‡"] * x["å˜ä¾¡"])
    .drop_duplicates()
)

print(df_cleaned)
print("\nåº—èˆ—åˆ¥å£²ä¸Š:")
print(df_cleaned.groupby("åº—èˆ—")["å£²ä¸Š"].sum())
```

</details>

---

## ğŸš€ å¿œç”¨å•é¡Œ3: ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã®ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°

### å•é¡Œ

ä»¥ä¸‹ã®ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã—ã¦ãã ã•ã„ã€‚

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({
    "å›ç­”ID": ["R001", "R002", "R003", "R004", "R005", "R001", "R006"],
    "å¹´ä»£": ["20ä»£", "30ä»£", np.nan, "20", "30ä»£", "20ä»£", "40"],
    "æ€§åˆ¥": ["ç”·æ€§", "å¥³æ€§", "ç”·", np.nan, "F", "ç”·æ€§", "ç”·æ€§"],
    "æº€è¶³åº¦": ["5", "4", "3", np.nan, "4", "5", "very good"],
    "ã‚³ãƒ¡ãƒ³ãƒˆ": ["  è‰¯ã‹ã£ãŸ  ", None, "æ”¹å–„å¸Œæœ›", "æ™®é€š", "GOOD", "  è‰¯ã‹ã£ãŸ  ", "æº€è¶³"]
})
```

å•é¡Œç‚¹ï¼š
1. å¹´ä»£ã®è¡¨è¨˜ãŒãƒãƒ©ãƒãƒ©ï¼ˆã€Œ20ä»£ã€ã€Œ20ã€ãªã©ï¼‰
2. æ€§åˆ¥ã®è¡¨è¨˜ãŒãƒãƒ©ãƒãƒ©ï¼ˆã€Œç”·æ€§ã€ã€Œç”·ã€ã€ŒFã€ãªã©ï¼‰
3. æº€è¶³åº¦ã«ä¸æ­£ãªå€¤ãŒã‚ã‚‹ï¼ˆã€Œvery goodã€ãªã©ï¼‰
4. ã‚³ãƒ¡ãƒ³ãƒˆã«ç©ºç™½ãŒã‚ã‚‹
5. é‡è¤‡ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹

ã™ã¹ã¦ã®å•é¡Œã‚’è§£æ±ºã—ã¦ãã ã•ã„ã€‚

<details>
<summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>

### åŸºæœ¬è§£æ³•ï¼ˆã‚¹ãƒ†ãƒƒãƒ—ã”ã¨ã«å‡¦ç†ï¼‰

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({
    "å›ç­”ID": ["R001", "R002", "R003", "R004", "R005", "R001", "R006"],
    "å¹´ä»£": ["20ä»£", "30ä»£", np.nan, "20", "30ä»£", "20ä»£", "40"],
    "æ€§åˆ¥": ["ç”·æ€§", "å¥³æ€§", "ç”·", np.nan, "F", "ç”·æ€§", "ç”·æ€§"],
    "æº€è¶³åº¦": ["5", "4", "3", np.nan, "4", "5", "very good"],
    "ã‚³ãƒ¡ãƒ³ãƒˆ": ["  è‰¯ã‹ã£ãŸ  ", None, "æ”¹å–„å¸Œæœ›", "æ™®é€š", "GOOD", "  è‰¯ã‹ã£ãŸ  ", "æº€è¶³"]
})

print("=== ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å‰ ===")
print(df)
print()

# ===== Step 1: å¹´ä»£ã®è¡¨è¨˜ã‚’çµ±ä¸€ =====

# å¹´ä»£ã®å¤‰æ›ãƒãƒƒãƒ—
age_map = {
    "20": "20ä»£",
    "30": "30ä»£",
    "40": "40ä»£"
}

cleaned_ages = []
for i in range(len(df)):
    age = df.iloc[i]["å¹´ä»£"]
    if pd.isna(age):
        cleaned_ages.append(np.nan)
    elif age in age_map:
        cleaned_ages.append(age_map[age])
    else:
        cleaned_ages.append(age)

df["å¹´ä»£"] = cleaned_ages

print("=== Step 1: å¹´ä»£ã‚’çµ±ä¸€ ===")
print(df["å¹´ä»£"].value_counts(dropna=False))
print()

# ===== Step 2: æ€§åˆ¥ã®è¡¨è¨˜ã‚’çµ±ä¸€ =====

# æ€§åˆ¥ã®å¤‰æ›ãƒãƒƒãƒ—
gender_map = {
    "ç”·": "ç”·æ€§",
    "M": "ç”·æ€§",
    "å¥³": "å¥³æ€§",
    "F": "å¥³æ€§"
}

cleaned_genders = []
for i in range(len(df)):
    gender = df.iloc[i]["æ€§åˆ¥"]
    if pd.isna(gender):
        cleaned_genders.append(np.nan)
    elif gender in gender_map:
        cleaned_genders.append(gender_map[gender])
    else:
        cleaned_genders.append(gender)

df["æ€§åˆ¥"] = cleaned_genders

print("=== Step 2: æ€§åˆ¥ã‚’çµ±ä¸€ ===")
print(df["æ€§åˆ¥"].value_counts(dropna=False))
print()

# ===== Step 3: æº€è¶³åº¦ã‚’æ•°å€¤ã«å¤‰æ›ï¼ˆä¸æ­£ãªå€¤ã¯æ¬ æã«ï¼‰=====

cleaned_scores = []
for i in range(len(df)):
    score = df.iloc[i]["æº€è¶³åº¦"]
    if pd.isna(score):
        cleaned_scores.append(np.nan)
    else:
        # æ•°å€¤ã«å¤‰æ›ã‚’è©¦ã¿ã‚‹
        try:
            cleaned_scores.append(int(score))
        except ValueError:
            # å¤‰æ›ã§ããªã„å ´åˆã¯æ¬ æå€¤
            cleaned_scores.append(np.nan)

df["æº€è¶³åº¦"] = cleaned_scores

print("=== Step 3: æº€è¶³åº¦ã‚’æ•°å€¤åŒ– ===")
print(df["æº€è¶³åº¦"])
print()

# ===== Step 4: ã‚³ãƒ¡ãƒ³ãƒˆã®ç©ºç™½ã‚’å‰Šé™¤ =====

cleaned_comments = []
for i in range(len(df)):
    comment = df.iloc[i]["ã‚³ãƒ¡ãƒ³ãƒˆ"]
    if comment is not None and isinstance(comment, str):
        cleaned_comments.append(comment.strip())
    else:
        cleaned_comments.append(comment)

df["ã‚³ãƒ¡ãƒ³ãƒˆ"] = cleaned_comments

print("=== Step 4: ã‚³ãƒ¡ãƒ³ãƒˆã®ç©ºç™½ã‚’å‰Šé™¤ ===")
print(df["ã‚³ãƒ¡ãƒ³ãƒˆ"])
print()

# ===== Step 5: é‡è¤‡ã‚’å‰Šé™¤ï¼ˆå›ç­”IDã§åˆ¤å®šï¼‰=====

df = df.drop_duplicates(subset=["å›ç­”ID"])

print("=== Step 5: é‡è¤‡ã‚’å‰Šé™¤ ===")
print(f"è¡Œæ•°: {len(df)}")
print()

# ===== Step 6: æ¬ æå€¤ã®å‡¦ç† =====

# å¹´ä»£ã®æ¬ æï¼šæœ€é »å€¤ã§è£œå®Œ
age_counts = {}
for i in range(len(df)):
    age = df.iloc[i]["å¹´ä»£"]
    if not pd.isna(age):
        if age in age_counts:
            age_counts[age] = age_counts[age] + 1
        else:
            age_counts[age] = 1

# æœ€é »å€¤ã‚’å–å¾—
most_common_age = max(age_counts, key=age_counts.get) if age_counts else "ä¸æ˜"

df["å¹´ä»£"] = df["å¹´ä»£"].fillna(most_common_age)

# æ€§åˆ¥ã®æ¬ æï¼šã€Œæœªå›ç­”ã€ã§è£œå®Œ
df["æ€§åˆ¥"] = df["æ€§åˆ¥"].fillna("æœªå›ç­”")

# æº€è¶³åº¦ã®æ¬ æï¼šå¹³å‡å€¤ã§è£œå®Œ
scores = [s for s in df["æº€è¶³åº¦"] if not pd.isna(s)]
avg_score = sum(scores) / len(scores) if scores else 0
df["æº€è¶³åº¦"] = df["æº€è¶³åº¦"].fillna(round(avg_score))

# ã‚³ãƒ¡ãƒ³ãƒˆã®æ¬ æï¼šã€Œãªã—ã€ã§è£œå®Œ
df["ã‚³ãƒ¡ãƒ³ãƒˆ"] = df["ã‚³ãƒ¡ãƒ³ãƒˆ"].fillna("ãªã—")

print("=== ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å¾Œ ===")
print(df)
print()

print("=== ãƒ‡ãƒ¼ã‚¿ã®è¦ç´„ ===")
print(f"å›ç­”æ•°: {len(df)}")
print(f"æ¬ æå€¤æ•°: {df.isnull().sum().sum()}")
print(f"\nå¹´ä»£åˆ¥é›†è¨ˆ:")
print(df["å¹´ä»£"].value_counts())
print(f"\næ€§åˆ¥é›†è¨ˆ:")
print(df["æ€§åˆ¥"].value_counts())
print(f"\næº€è¶³åº¦å¹³å‡: {df['æº€è¶³åº¦'].mean():.1f}")
```

**å®Ÿè¡Œçµæœ:**
```
=== ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å‰ ===
  å›ç­”ID  å¹´ä»£    æ€§åˆ¥      æº€è¶³åº¦       ã‚³ãƒ¡ãƒ³ãƒˆ
0   R001  20ä»£    ç”·æ€§          5      è‰¯ã‹ã£ãŸ  
1   R002  30ä»£    å¥³æ€§          4          None
2   R003   NaN      ç”·          3       æ”¹å–„å¸Œæœ›
3   R004    20    NaN        NaN         æ™®é€š
4   R005  30ä»£      F          4         GOOD
5   R001  20ä»£    ç”·æ€§          5      è‰¯ã‹ã£ãŸ  
6   R006    40    ç”·æ€§  very good         æº€è¶³

=== ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å¾Œ ===
  å›ç­”ID  å¹´ä»£    æ€§åˆ¥  æº€è¶³åº¦   ã‚³ãƒ¡ãƒ³ãƒˆ
0   R001  20ä»£    ç”·æ€§    5.0     è‰¯ã‹ã£ãŸ
1   R002  30ä»£    å¥³æ€§    4.0       ãªã—
2   R003  30ä»£    ç”·æ€§    3.0     æ”¹å–„å¸Œæœ›
3   R004  20ä»£  æœªå›ç­”    4.0       æ™®é€š
4   R005  30ä»£    å¥³æ€§    4.0       GOOD
6   R006  40ä»£    ç”·æ€§    4.0       æº€è¶³

=== ãƒ‡ãƒ¼ã‚¿ã®è¦ç´„ ===
å›ç­”æ•°: 6
æ¬ æå€¤æ•°: 0

å¹´ä»£åˆ¥é›†è¨ˆ:
å¹´ä»£
30ä»£    3
20ä»£    2
40ä»£    1
Name: count, dtype: int64

æ€§åˆ¥é›†è¨ˆ:
æ€§åˆ¥
ç”·æ€§      3
å¥³æ€§      2
æœªå›ç­”    1
Name: count, dtype: int64

æº€è¶³åº¦å¹³å‡: 4.0
```

---

### ç™ºå±•è§£æ³•ï¼ˆPandas ã®æ©Ÿèƒ½ã‚’æ´»ç”¨ï¼‰

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({
    "å›ç­”ID": ["R001", "R002", "R003", "R004", "R005", "R001", "R006"],
    "å¹´ä»£": ["20ä»£", "30ä»£", np.nan, "20", "30ä»£", "20ä»£", "40"],
    "æ€§åˆ¥": ["ç”·æ€§", "å¥³æ€§", "ç”·", np.nan, "F", "ç”·æ€§", "ç”·æ€§"],
    "æº€è¶³åº¦": ["5", "4", "3", np.nan, "4", "5", "very good"],
    "ã‚³ãƒ¡ãƒ³ãƒˆ": ["  è‰¯ã‹ã£ãŸ  ", None, "æ”¹å–„å¸Œæœ›", "æ™®é€š", "GOOD", "  è‰¯ã‹ã£ãŸ  ", "æº€è¶³"]
})

# å¤‰æ›ãƒãƒƒãƒ—
age_map = {"20": "20ä»£", "30": "30ä»£", "40": "40ä»£"}
gender_map = {"ç”·": "ç”·æ€§", "M": "ç”·æ€§", "å¥³": "å¥³æ€§", "F": "å¥³æ€§"}

# æº€è¶³åº¦ã‚’æ•°å€¤ã«å¤‰æ›ã™ã‚‹é–¢æ•°
def to_numeric_score(val):
    try:
        return int(val)
    except (ValueError, TypeError):
        return np.nan

df_cleaned = (df
    .assign(å¹´ä»£=df["å¹´ä»£"].replace(age_map))
    .assign(æ€§åˆ¥=df["æ€§åˆ¥"].replace(gender_map))
    .assign(æº€è¶³åº¦=df["æº€è¶³åº¦"].apply(to_numeric_score))
    .assign(ã‚³ãƒ¡ãƒ³ãƒˆ=df["ã‚³ãƒ¡ãƒ³ãƒˆ"].str.strip())
    .drop_duplicates(subset=["å›ç­”ID"])
    .assign(å¹´ä»£=lambda x: x["å¹´ä»£"].fillna(x["å¹´ä»£"].mode()[0]))
    .assign(æ€§åˆ¥=lambda x: x["æ€§åˆ¥"].fillna("æœªå›ç­”"))
    .assign(æº€è¶³åº¦=lambda x: x["æº€è¶³åº¦"].fillna(x["æº€è¶³åº¦"].mean()))
    .assign(ã‚³ãƒ¡ãƒ³ãƒˆ=lambda x: x["ã‚³ãƒ¡ãƒ³ãƒˆ"].fillna("ãªã—"))
)

print(df_cleaned)
```

</details>

---

## ğŸ¯ å¿œç”¨å•é¡Œãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

ä»¥ä¸‹ãŒã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã‹ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š

- [ ] è¤‡æ•°ã®å•é¡Œã‚’æŒã¤ãƒ‡ãƒ¼ã‚¿ã‚’é †åºç«‹ã¦ã¦ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã§ãã‚‹
- [ ] è¡¨è¨˜ã‚†ã‚Œã‚’çµ±ä¸€ã™ã‚‹ãƒãƒƒãƒ—ã‚’ä½œæˆã§ãã‚‹
- [ ] ä¸æ­£ãªå€¤ã‚’æ¤œå‡ºã—ã¦é©åˆ‡ã«å‡¦ç†ã§ãã‚‹
- [ ] æ¬ æå€¤ã‚’é©åˆ‡ãªå€¤ï¼ˆå¹³å‡ã€æœ€é »å€¤ãªã©ï¼‰ã§è£œå®Œã§ãã‚‹
- [ ] ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å‰å¾Œã®ãƒ‡ãƒ¼ã‚¿ã‚’æ¯”è¼ƒã—ã¦æ¤œè¨¼ã§ãã‚‹
- [ ] ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å¾Œã®ãƒ‡ãƒ¼ã‚¿ã§é›†è¨ˆãƒ»åˆ†æãŒã§ãã‚‹
